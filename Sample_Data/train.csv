,file,abstract,body
0,0704.0002,"  We describe a new algorithm, the $(k,\ell)$-pebble game with colors, and use
it obtain a characterization of the family of $(k,\ell)$-sparse graphs and
algorithmic solutions to a family of problems concerning tree decompositions of
graphs. Special instances of sparse graphs appear in rigidity theory and have
received increased attention in recent years. In particular, our colored
pebbles generalize and strengthen the previous results of Lee and Streinu and
give a new proof of the Tutte-Nash-Williams characterization of arboricity. We
also present a new decomposition that certifies sparsity based on the
$(k,\ell)$-pebble game with colors. Our work also exposes connections between
pebble game algorithms and previous sparse graph algorithms by Gabow, Gabow and
Westermann and Hendrickson.
", and preliminaries The focus of this paper is decompositions of k sparse graphs into edge disjoint subgraphs that certify sparsity. We use graph to mean a multi graph possibly with loops. We say that a graph is k sparse if no sub set of nvertices spans more than knedges in the graph a k sparse graph with knedges is k tight . We call the range kk the upper range of sparse graphs and kthe lower range. In this paper we present ecient algorithms for nding decompositions that certify sparsity in the upper range of . Our algorithms also apply in the lower range which was already addressed by . A decomposition certies the sparsity of a graph if the sparse graphs and graphs admitting the decomposition coincide. Computer Science Department Smith College Northampton MA. streinucs.smith.edu yDepartment of Computer Science University of Massachusetts Amherst. therancs.umass.edu arXiv.v math.CO Mar Our algorithms are based on a new characterization of sparse graphs which we call the pebble game with colors . The pebble game with colors is a simple graph construction rule that produces a sparse graph along with a sparsitycertifying decomposition. We dene and study a canonical class of pebble game constructions which correspond to previously studied decompostion of sparse graphs into edge disjoint trees. Our results provide a unifying framework for all the previously known special cases including NashWilliamsTutte and . Indeed in the lower range canonical pebble game constructions capture the properties of the augmenting paths used in matroid union and intersection algorithms . Since the sparse graphs in the upper range are not known to be unions or intersections of the matroids for which there are ecient augmenting path algorithms these do not easily apply in the upper range. Pebble game with colors constructions may thus be considered a strength ening of augmenting paths to the upper range of matroidal sparse graphs. . Sparse graphs A graph is k sparse if for any nonempty subgraph with medges and nvertices mknWe observe that this condition implies that k and from now on in this paper we will make this assumption. A sparse graph that has nvertices and exactly knedges is called tight . For a graph G V E and VV we use the notation span Vfor the number of edges in the subgraph induced by V. In a directed graph outVis the number of edges with the tail in Vand the head in VV for a subgraph induced by V we call such an edge an outedge There are two important types of subgraphs of sparse graphs. A block is a tight subgraph of a sparse graph. A component is a maximal block. Table summarizes the sparse graph terminology used in this paper. . Sparsitycertifying decompositions. Akarborescence is a graph that admits a decomposition into kedgedisjoint spanning trees. Figure a shows an example of a arborescence. The k arborescent graphs are described by the wellknown theorems of Tutte and NashWilliams as exactly the k ktight graphs. Amap is a graph that admits an orientation such that the out degree of each vertex is exactly one. A kmap is a graph that admits a decomposition intokedgedisjoint maps. Figure b shows an example of a map the edges are oriented in one possible conguration certifying that each color Term Meaning Sparse graph G Every nonempty subgraph on nvertices hasknedges Tight graph G G V E is sparse andjVjnjEjkn Block HinG Gis sparse and His a tight subgraph Component HofG Gis sparse and His a maximal block Map Graph that admits an outdegree exactly one orientation k mapsandtrees trees and kmaps Tk trees each vertex is in exactly kof them Set of subtrees in VVConnected components of the trees in a TkinEV Proper Tk The set of subtrees in every subgraph has size Table Sparse graph and decomposition terminology used in this paper. forms a map. Maps may be equivalently dened see e.g. as having exactly one cycle per connected component. Another characterization of maps which we will use extensively in this paper is as the tight graphs . The kmaps are evidently k tight and show that the converse holds as well. AnTkis a decomposition into edgedisjoint trees such that each vertex is in exactly kof them. Figure a shows an example of a T. Given a subgraph Hof aTkgraph G theset of subtrees inHis the collection of the connected components of the trees in GinH. We observe that these subtrees may come from the same tree or be singlevertex empty trees. It is also helpful to note that the denition of a subtree is relative to a specic subgraph . Figure a shows a graph with a T decomposition we note that one of the trees is an isolated vertex in the bottomright corner. The subgraph in Figure b has three black subtrees and one gray subtree an isolated vertex at the topright corner and two single edges. These count as three subtrees even though they come from the same back tree when the whole graph in considered. Figure c shows another subgraph in this case there are three gray subtrees and one black one. Table contains the decomposition terminology used in this paper. The decomposition problem. We dene the decomposition problem for sparse graphs as taking a graph as its input and producing as output a decomposition that can be used to certify sparsity. In this paper we will Our terminology follows Lov asz in . In the matroid literature maps are sometimes known as bases of the bicycle matroid or spanning pseudoforests. acbeda b c Figure Examples of sparsitycertifying decompositions a a arborescence b a map c a mapsandtrees. Edges with the same line style belong to the same subgraph. The map is shown with a certifying orientation. a b c Figure a A graph with a T decomposition one of the three trees is a single vertex in the bottom right corner. b The highlighted subgraph in color has three black subtrees and one gray subtree. c The highlighted subgraph in color has three gray subtrees and one black subtree. study three kinds of outputs mapsandtrees proper Tkdecompositions and the pebble game with colors decomposition which is dened in the next section. Historical background The wellknown theorems of Tutte and NashWilliams relate the k ktight graphs to the existence of decompositions into edgedisjoint span ning trees. Taking a matroid viewpoint Edmonds gave another proof of this result using matroid unions. The equivalence of mapsandtrees graphs and tight graphs in the lower range is shown using matroid unions in and matroid augmenting paths are the basis of the algorithms for the lower range of . In rigidity theory a foundational theorem of Laman shows that tight Laman graphs correspond to generically minimally rigid barand joint frameworks in the plane. Tay proved an analogous touchstone result for bodybar frameworks in any dimension using k ktight graphs. Rigidity by counts motivated interest in the upper range and Crapo proved the equivalence of Laman graphs and proper T graphs. Tay used this condition to give a direct proof of Lamans theorem and gener alized the T condition to all Tkforkk. Haas studied Tkdecompositions in detail and proved the equivalence of tight graphs and proper Tkgraphs for the general upper range. We observe the aside from our new pebble game with colors decomposition all the combinatorial char acterizations of the upper range of sparse graphs including the counts have a geometric interpretation . A pebble game algorithm was rst proposed in as an elegant alter native to Hendricksons Laman graph algorithms . Berg and Jordan provided the formal analysis of the pebble game of and introduced the idea of playing the game on a directed graph. Lee and Streinu gen eralized the pebble game to the entire range of parameters k and left as an open problem using the pebble game to nd sparsity certifying decompositions. The pebble game with colors Ourpebble game with colors is a set of rules for constructing graphs indexed by nonnegative integers kand. We will use the pebble game with colors as the basis of an ecient algorithm for the decomposition problem later in this paper. Since the phrase with colors is necessary only for comparison to we will omit it in the rest of the paper when the context is clear. We now present the pebble game with colors. The game is played by a single player on a xed nite set of vertices. The player makes a nite sequence of moves a move consists in the addition andor orientation of an edge. At any moment of time the state of the game is captured by a directed graph H we call H taken as an undirected graph a pebble game with colors graph . We describe the pebble game with colors in terms of its initial congu ration and the allowed moves. a b Figure Examples of pebble game with colors moves. a Add edge. b Pebble slide. Pebbles on vertices are shown as black or gray dots. Edges are colored with the color of the pebble on them. Initialization in the beginning of the pebble game Hhasnvertices and no edges. We start by placing kpebbles on each vertex of H one of each color ci fori k . Add edge with colors Letvandwbe vertices with at least pebbles on them. Let tfv wghave a pebble on it and let sbe other vertex. Pick up a pebble from t add the edge tstoEH and put the pebble picked up from ton the new edge. While playing the pebble game all edges are directed and we use the notation vwto indicate a directed edge from vtow. Figure a shows examples of the add edge move. Pebble slide Letwbe a vertex with a pebble pon it and let vwbe an edge in H. Replace vwwith wvinEH put the pebble that was on on vwonv and put ponwv. Note that the color of an edge can change with a pebble slide move. Figure b shows examples. The convention in these gures and through out this paper is that pebbles on vertices are represented as colored dots and that edges are shown in the color of the pebble on them. From the denition of the pebble slide move it is easy to see that a particular pebble is always either on the vertex where it started or on an edge that has this vertex as the tail. However when making a sequence ofpebble slide moves that reverse the orientation of a path in H it is sometimes convenient to think of this path reversal sequence as bringing a pebble from the end of the path to the beginning. The output of playing the pebble game is its complete conguration. Output At the end of the game we obtain the directed graph H along with the location and colors of the pebbles. Observe that since each edge has exactly one pebble on it the pebble game conguration colors the edges. We say that H taken as an undirected graph G isconstructed by the k pebble game or that His apebble game graph . Since each edge of Hhas exactly one pebble on it the pebble games conguration partitions the edges into kdierent colors. We call this de composition of Hapebble game decomposition . Figure a shows an example of a tight graph with a pebble game decomposition. a b c Figure A tight graph with one possible pebble game decomposition. The edges are oriented to show sparsity for each color. a The graph Kwith a pebble game decomposition. There is an empty black tree at the center vertex and a gray spanning tree. b The highlighted subgraph has two black trees and a gray tree the black edges are part of a larger cycle but contribute a tree to the subgraph. c The highlighted subgraph with a light gray background has three empty gray trees the black edges contain a cycle and do not contribute a subtree to the subgraph. Generalizing the denition of the set of subtrees in an Tk the set of subtrees in a subgraph Gof a pebble game graph Gis the set of monochro matic acyclic connected components of the sparse graphs in a pebble game graph. As before these are taken relative to a specic subgraph and may be empty trees or subtrees of a larger tree. They may also be part of a monochromatic cycle in G. Notation Meaning spanVNumber of edges spanned in HbyVV i.e.jEHVj pebVNumber of pebbles on VV outVNumber of edges vwinHwith vVandwVV pebiv Number of pebbles of color cionvV outiv Number of edges vwcolored ciforvV Table Pebble game notation used in this paper. The properties of pebble game decompositions are studied in Section and Theorem shows that each color must be sparse. The orientation of the edges in Figure a shows this. For example Figure a shows a tight graph with one possible pebble game decomposition. The whole graph contains a gray subtree and a black subtree that is an isolated vertex. The subgraph in Figure b has a black tree and a gray tree with the edges of the black tree coming from a cycle in the larger graph. In Figure c however the black cycle does not contribute a subtree. All three subtrees in this subgraph are singlevertex gray trees. In the following discussion we use the notation peb v for the number of pebbles on vand pebiv to indicate the number of pebbles of colors ion v. Table lists the pebble game notation used in this paper. Our Results We describe our results in this section. The rest of the paper provides the proofs. Our rst result is a strengthening of the pebble games of to include colors. It says that sparse graphs are exactly pebble game graphs. Recall that from now on all pebble games discussed in this paper are our pebble game with colors unless noted explicitly. Theorem Sparse graphs and pebble game graphs coincide. A graph Gisk sparse with kif and only if Gis a pebble game graph. Next we consider pebble game decompositions showing that they are a generalization of proper Tkdecompositions that extend to the entire ma troidal range of sparse graphs. Theorem The pebble game with colors decomposition. A graph Gis a pebble game graph if and only if it admits a decomposition into k edgedisjoint subgraphs such that each is sparse and every subgraph of Gcontains at least subtrees of the sparse graphs in the decomposition. The sparse subgraphs in the statement of Theorem are the col ors. We observe that the subtrees condition in the pebble game with colors decomposition is similar to that of a proper Tk and that this is one of the main facts used by Tay in . We do not however know how to realize a tight graph as a rigid barandjoint framework in the plane directly from an arbitrary pebble game decomposition of a graph. Our next results show that for anypebble game graph we can spe cialize its pebble game construction to generate a decomposition that is a mapsandtrees or proper Tk. We call these specialized pebble game con structions canonical and using canonical pebble game constructions we obtain new direct proofs of existing arboricity results. It is easy to see from Theorem mapsandtrees are special cases of the pebble game decomposition each of the spanning trees contributes at least one piece of tree to every subgraph. The case of proper Tkgraphs is more subtle if each color in a pebble game decomposition is a forest then we have found a proper Tk but this class is a subset of all possible proper Tkdecompositions of a tight graph. We show that this class of proper Tkdecompositions is sucient to certify sparsity. We now state the main theorem for the upper and lower range. Theorem Main Theorem Lower Range Mapsandtrees coin cide with pebble game graphs. Letk. A graph Gis a tight pebble game graph if and only if Gis ak mapsandtrees. Theorem Main Theorem Upper Range Proper Tkgraphs coincide with pebble game graphs. Letkk. A graph Gis a tight pebble game graph if and only if it is a proper Tkwithknedges. As corollaries we obtain the existing decomposition results for sparse graphs. Corollary Crapo Haas .Letkk. A graph Gis tight if and only if it is a proper Tk. Corollary Tutte NashWilliams White and Whiteley .Let k. A graph Gis tight if and only if has a k mapsandtrees decomposition. Eciently nding canonical pebble game constructions. The proofs of Theorem and Theorem lead to an obvious algorithm with On run ning time for the decomposition problem. Our last result improves on this showing that a canonical pebble game construction and thus a maps andtrees or proper Tkdecomposition can be found using a pebble game algorithm in On time and space. These time and space bounds mean that our algorithm can be combined with those of without any change in complexity. Pebble game graphs In this section we prove Theorem a strengthening of results from to the pebble game with colors. Since many of the relevant properties of the pebble game with colors carry over directly from the pebble games of we refer the reader there for the proofs. We begin by establishing some invariants that hold during the execution of the pebble game. Lemma Pebble game invariants. During the execution of the pebble game the following invariants are maintained in H I There are at least pebbles on V. I For each vertex vspanv out v peb vk. I For each VVspanV out V peb Vkn. I For every vertex vVoutiv pebiv . I Every maximal path consisting only of edges with color ciends in either the rst vertex with a pebble of color cior a cycle. Proof. I I I I This invariant clearly holds at the initialization phase of the pebble game with colors. That add edge andpebble slide moves preserve I is clear from inspection. I ByI a monochromatic path of edges is forced to end only at a vertex with a pebble of the same color on it. If there is no pebble of that color reachable then the path must eventually visit some vertex twice. From these invariants we can show that the pebble game constructible graphs are sparse. Lemma Pebble game graphs are sparse . LetHbe a graph constructed with the pebble game. Then His sparse. If there are exactly pebbles on VH then His tight. The main step in proving that every sparse graph is a pebble game graph is the following. Recall that by bringing a pebble to vwe mean reorienting Hwithpebble slide moves to reduce the out degree of vby one. Lemma The pebble condition .Letvwbe an edge such thatHvwis sparse. If pebfv wg then a pebble not on vwcan be brought to either vorw. It follows that any sparse graph has a pebble game construction. Theorem Sparse graphs and pebble game graphs coincide. A graph Gisk sparse with kif and only if Gis a pebble game graph. The pebble game with colors decomposition In this section we prove Theorem which characterizes all pebble game decompositions. We start with the following lemmas about the structure of monochromatic connected components in H the directed graph maintained during the pebble game. Lemma Monochromatic pebble game subgraphs are sparse. LetHibe the subgraph of Hinduced by edges with pebbles of color cion them. Then Hiissparse for i k . Proof. ByI Hiis a set of edges with out degree at most one for every vertex. Lemma Subtrees in a pebble game graph. Every subgraph of the directed graph Hin a pebble game construction contains at least monochro matic subtrees and each of these is rooted at either a vertex with a pebble on it or a vertex that is the tail of an outedge. Recall that an outedge from a subgraph H V E is an edge vw with vVandvw E. Proof. LetH V E be a nonempty subgraph of H and assume with out loss of generality that His induced by V. ByI outVpeb V. We will show that each pebble and outedge tail is the root of a subtree. Consider a vertex vVand a color ci. By I there is a unique monochromatic directed path of color cistarting at v. By I if this path ends at a pebble it does not have a cycle. Similarly if this path reaches a vertex that is the tail of an outedge also in color cii.e. if the monochromatic path from vleaves V then the path cannot have a cycle inH. Since this argument works for any vertex in any color for each color there is a partitioning of the vertices into those that can reach each pebble outedge tail or cycle. It follows that each pebble and outedge tail is the root of a monochromatic tree as desired. Applied to the whole graph Lemma gives us the following. Lemma Pebbles are the roots of trees. In any pebble game congu ration each pebble of color ciis the root of a possibly empty monochromatic subtree of color ci. Remark Haas showed in that in an Tk a subgraph induced by n vertices with medges has exactly knmsubtrees in it. Lemma strengthens Haas result by extending it to the lower range and giving a construction that nds the subtrees showing the connection between the pebble condition and the hereditary condition on proper Tk. We conclude our investigation of arbitrary pebble game constructions with a description of the decomposition induced by the pebble game with colors. Theorem The pebble game with colors decomposition. A graph Gis a pebble game graph if and only if it admits a decomposition into k edgedisjoint subgraphs such that each is sparse and every subgraph of Gcontains at least subtrees of the sparse graphs in the decomposition. Proof. LetGbe a pebble game graph. The existence of the kedgedisjoint sparse subgraphs was shown in Lemma and Lemma proves the condition on subgraphs. For the other direction we observe that a color ciwithtitrees in a given subgraph can span at most ntiedges summing over all the colors shows that a graph with a pebble game decomposition must be sparse. Apply Theorem to complete the proof. Remark We observe that a pebble game decomposition for a Laman graph may be read out of the bipartite matching used in Hendricksons Laman graph extraction algorithm. Indeed pebble game orientations have a natural correspondence with the bipartite matchings used in . Mapsandtrees are a special case of pebble game decompositions for tight graphs if there are no cycles in of the colors then the trees rooted at the corresponding pebbles must be spanning since they have n edges. Also if each color forms a forest in an upper range pebble game decomposition then the subtrees condition ensures that the pebble game decomposition is a proper Tk. In the next section we show that the pebble game can be specialized to correspond to mapsandtrees and proper Tkdecompositions. Canonical Pebble Game Constructions In this section we prove the main theorem Theorem and Theorem continuing the investigation of decompositions induced by pebble game con structions by investigating the case where a minimum number of monochro matic cycles are created. The proof of the main theorem shows that for these constructions the pebble game decomposition is either a mapsandtrees or proper Tk. Every decomposition characterization of tight graphs discussed above follows immediately from the main theorem giving new proofs of the previous results in a unied framework. The proof of the main theorem relies on two specializations of the pebble game which we describe. The rst is a modication of the add edge move. Canonical add edge When performing an add edge move cover the new edge with a color that is on both vertices if possible. If not then take the highest numbered color present. The second is a restriction on which pebble slide moves we allow. Canonical pebble slide Apebble slide moves is allowed only when it does not create a monochromatic cycle. We call a pebble game construction that uses only these moves canoni cal. In this section we will show that ever pebble game graph has a canonical pebble game construction Lemma and Lemma and that canonical pebble game constructions correspond to proper Tkand mapsandtrees decompositions Theorem and Theorem . We begin with a technical lemma that motivates the denition of canon ical pebble game constructions. It shows that the situations disallowed by the canonical moves are allthe ways for cycles to form in the lowest colors. Lemma Monochromatic cycle creation. LetvVhave a pebble pof color cion it. A monochromatic cycle colored ciis created in exactly one of the following ways M The is a vertex win a tree of edges colored cirooted at vand the edge vwis added with an add edge move and pis used to cover vw. M There is a vertex win a tree of edges colored cithat contains v the edgewvis present and a pebble slide move over wvusespto cover the reversed edge vw. Proof. Observe that the preconditions in the statement of the lemma are implied by Lemma . By Lemma monochromatic cycles form when the last pebble of color ciis removed from a connected monochromatic subgraph. M andM are the only ways to do this in a pebble game construction since the color of an edge only changes when it is inserted the rst time or a new pebble is put on it by a pebble slide move. Figure a and Figure b show examples of M andM map creation moves respectively in a pebble game construction. vwvw a vwvw b Figure Creating monochromatic cycles in a pebble game. a A typeM move creates a cycle by adding a black edge. b A type M move creates a cycle with a pebble slide move. The vertices are labeled according to their role in the denition of the moves. We next show that if a graph has a pebble game construction then it has a canonical pebble game construction. This is done in two steps considering the cases M andM separately. The proof gives two constructions that implement the canonical add edge andcanonical pebble slide moves. Lemma The canonical add edge move. LetGbe a graph with a pebble game construction. Cycle creation steps of type M can be elimi nated in colors cifori. Here minfk g. Proof. Foradd edge moves cover the edge with a color present on both v andwif possible. If this is not possible then there are distinct colors present. Use the highest numbered color to cover the new edge. Remark We note that in the upper range there is always a repeated color so nocanonical add edge moves create cycles in the upper range. Thecanonical pebble slide move is dened by a global condition. To prove that we obtain the same class of graphs using only canonical pebble slide moves we need to extend Lemma to only canonical moves. The main step is to show that if there is any sequence of moves that reorients a path from vtow there is a sequence of canonical moves that does the same thing. Lemma The canonical pebble slide move. Any sequence of peb ble slide moves leading to an add edge move can be replaced with one that has no M steps and allows the same add edge move. Figure and Figure illustrate the construction used in the proof of Lemma . We call this the shortcut construction by analogy to matroid union and intersection augmenting paths used in previous work on the lower range. Figure shows the structure of the proof. The shortcut construction removes an M step at the beginning of a sequence of pebble slides that reorient a path from vtow. Since one application of the shortcut construc tion reorients a simple path from a vertex wtow and a path from vto wis preserved the shortcut construction can be applied inductively to nd the sequence of moves we want. Proof. Without loss of generality we can assume that our sequence of moves reorients a simple path in H and that the rst move the end of the path isM . The M step moves a pebble of color cifrom a vertex wonto the edge vw which is reversed. Because the move is M vandware contained in a maximal monochromatic tree of color ci. Call this tree H i and observe that it is rooted at w. Now consider the edges reversed in our sequence of moves. As noted above before we make any of the moves these sketch out a simple path in Hending at w. Let zbe the rst vertex on this path in H i. We modify our sequence of moves as follows delete from the beginning every move before the one that reverses some edge yz prepend onto what is left a sequence of moves that moves the pebble on wtozinH i. wva vw b wvw c Figure Outline of the shortcut construction a An arbitrary simple path from vtowwith curved lines indicating simple paths. b An M step with the gray tree spanning the black edge that will ip shown in dashed lines the solid gray edges were part of the original path from a. c The shortened path to the gray pebble the new path follows the gray tree all the way from the rst time the original path touched the gray tree. The doubled path from vtowis simple and the shortcut construction can be applied inductively to it. a b Figure Eliminating M moves a an M move b avoiding the M by moving along another path. The path where the pebbles move is indicated by doubled lines. a b Figure Eliminating M moves a the rst step to move the black peb ble along the doubled path is M b avoiding the M and simplifying the path. Since no edges change color in beginning of the new sequence we have eliminated the M move at the beginning. Because our construction does not change any of the edges involved in the remaining tail of the original sequence the part of the original path that is left in the new sequence will still be a simple path in H meeting our initial hypothesis. The rest of the lemma follows by induction. Together Lemma and Lemma prove the following. Lemma . IfGis a pebble game graph then Ghas a canonical pebble game construction. Using canonical pebble game constructions we can identify the tight pebble game graphs with mapsandtrees and Tk. Theorem Main Theorem Lower Range Mapsandtrees coin cide with pebble game graphs. Letk. A graph Gis a tight pebble game graph if and only if Gis ak mapsandtrees. Proof. As observed above a mapsandtrees decomposition is a special case of the pebble game decomposition. Applying Theorem we see that any mapsandtrees must be a pebble game graph. For the reverse direction consider a canonical pebble game construction of a tight graph. From Lemma we see that there are pebbles left on Gat the end of the construction. The denition of the canonical add edge move implies that there must be at least one pebble of each cifor i . It follows that there is exactly one of each of these colors. By Lemma each of these pebbles is the root of a monochromatic subtree with n edges yielding the required edgedisjoint spanning trees. Corollary Tutte NashWilliams White and Whiteley .Let k. A graph Gis tight if and only if has a k mapsandtrees decomposition. We next consider the decompositions induced by canonical pebble game constructions when k . Theorem Main Theorem Upper Range Proper Tkgraphs coincide with pebble game graphs. Letkk. A graph Gis a tight pebble game graph if and only if it is a proper Tkwithknedges. Proof. As observed above a proper Tkdecomposition must be sparse. What we need to show is that a canonical pebble game construction of a tight graph produces a proper Tk. By Theorem and Lemma we already have the condition on subtrees and the decomposition into edgedisjoint trees. Finally an application of I shows that every vertex must in in exactly kof the trees as required. Corollary Crapo Haas .Letkk. A graph Gis tight if and only if it is a proper Tk. Pebble game algorithms for decompositions A nave implementation of the constructions in the previous section leads to an algorithm requiring n time to collect each pebble in a canonical construction in the worst case n applications of the construction in Lemma requiring n time each. In this section we describe algorithms for the decomposition problem that run in time On. We begin with the overall structure of the algorithm. Algorithm The canonical pebble game with colors . Input A graph G. Output A pebble game graph H and the components of H. Method SetVH VGand place one pebble of each color on the vertices of H. For each edge vwEGtry to collect pebbles on vandwusing pebble slide moves as described by Lemma . If pebbles can be collected add vwtoHusing an add edge move as in Lemma otherwise discard vw. Finally return H the locations of the pebbles and a list of components. Correctness. Theorem and the observation from that the sparse graphs are the independent sets of a matroid show that His a maximum sized sparse subgraph of G. Since the construction found is canonical the main theorem shows that the coloring of the edges in Hgives a mapsand trees or proper Tkdecomposition. Complexity. We start by observing that the running time of Algorithm is the time taken to process On edges added to HandOm edges not added to H. We rst consider the cost of an edge of Gthat is added to H. Each of the pebble game moves can be implemented in constant time. What remains is to describe an ecient way to nd and move the pebbles. We use the following algorithm as a subroutine of Algorithm to do this. Algorithm Finding a canonical path to a pebble. . Input Vertices v andw and a pebble game conguration on a directed graph H. Output If a pebble was found yes and no otherwise. The congu ration of His updated. Method Start by doing a depthrst search from from vinH. If no pebble not on wis found stop and return no. Otherwise a pebble was found. We now have a path vv e e p vp u where the viare vertices and eiis the edge vivi. Let ceibe the color of the pebble on ei. We will use the array cto keep track of the colors of pebbles on vertices and edges after we move them and the array sto sketch out a canonical path from vtouby nding a successor for each edge. Setsu endand set cuto the color of an arbitrary pebble on u. For each edge ep ep e check to see if cviis set if so go on to the next edge. Otherwise check to see if cvi cei. If it is set svi ei and set cvi cei and go on to the next edge. Otherwise try to nd a monochromatic path in color cvifrom vi tovi. If a vertex xwith cxset is encountered we have a path vi x f f q xqxthat is monochromatic in cvi set cxi cfi andsxi fifori q. Ifcx cfq stop. Otherwise recursively check that there is not a monochromatic cxpath from xqto xusing this same procedure. Finally slide pebbles along the path from vtouspecied by svssv etc. The correctness of Algorithm comes from the fact that it is implement ing the shortcut construction. Eciency comes from the fact that instead of potentially moving the pebble back and forth Algorithm precomputes a canonical path crossing each edge of Hat most three times once in the initial depthrst search and twice while converting the initial path to a canonical one. It follows that each accepted edges takes On time for a total of On time spent processing edges in H. From we know that after each accepted edge the components of H can be updated in time On. Finally using the results of we see that the rejected edges take an amortized O time each. Summarizing we have shown that the canonical pebble game with colors solves the decomposition problem in time On. Conclusions and open problems We presented a new characterization of sparse graphs the pebble game with colors and used it to give an ecient algorithm for nding decompositions of sparse graphs into edgedisjoint trees. Our algorithm which is the rst that nds such sparsitycertifying decompositions runs in time On which is as fast as the algorithms for recognizing sparse graphs in the upper range from . We also use the pebble game with colors to describe a new sparsity certifying decomposition that applies to the entire matroidal range of sparse graphs. We dened and studied a class of canonical pebble game constructions that correspond to either a mapsandtrees or proper Tkdecomposition. This gives a new proof of the TutteNashWilliams arboricity theorem and a unied proof of the previously studied decomposition certicates of sparsity. Canonical pebble game constructions also show the relationship between the pebble condition which applies to the upper range of to matroid union augmenting paths which do not apply in the upper range. Algorithmic consequences and open problems. In Gabow and Westermann give an On algorithm for recognizing sparse graphs in the lower range and extracting sparse subgraphs from dense ones. Their tech nique is based on eciently nding matroid union augmenting paths which extend a mapsandtrees decomposition. The On algorithm uses two subroutines to nd augmenting paths cyclic scanning which nds aug menting paths one at a time and batch scanning which nds groups of disjoint augmenting paths. We observe that Algorithm can be used to replace cyclic scanning in Gabow and Westermanns algorithm without changing the running time. The data structures used in the implementation of the pebble game detailed in are simpler and easier to implement than those used to support cyclic scanning. The two major open algorithmic problems related to the pebble game are then Open problem . Develop a pebble game algorithm with the properties ofbatch scanning and obtain an implementable Onalgorithm for the lower range. Open problem . Extend batch scanning to the pebble condition and derive an Onpebble game algorithm for the upper range. 
1,0704.0003,"  The evolution of Earth-Moon system is described by the dark matter field
fluid model proposed in the Meeting of Division of Particle and Field 2004,
American Physical Society. The current behavior of the Earth-Moon system agrees
with this model very well and the general pattern of the evolution of the
Moon-Earth system described by this model agrees with geological and fossil
evidence. The closest distance of the Moon to Earth was about 259000 km at 4.5
billion years ago, which is far beyond the Roche's limit. The result suggests
that the tidal friction may not be the primary cause for the evolution of the
Earth-Moon system. The average dark matter field fluid constant derived from
Earth-Moon system data is 4.39 x 10^(-22) s^(-1)m^(-1). This model predicts
that the Mars's rotation is also slowing with the angular acceleration rate
about -4.38 x 10^(-22) rad s^(-2).
", The popularly accepted theory for the forma tion of the EarthMoon system is that the Moon was formed from debris of a strong impact by a giant planetesimal with the Earth at the close of the planetforming period Hartmann and Davis . Since the formation of the EarthMoon system it has been evolving at all tim e scale. It is well known that the Moon is receding from us and both the Earths rotation and Moons rotation are slowing. The popular th eory is that the tidal fric tion causes all those changes. However based on tidal friction model and the current MoonEarth system data the tidal friction should be stronger and the recessiona l rate of the Moon should be greater in the past because the Moon was closer the distance of the Moon would quickly fall inside the Roches limit for earth km in which the Moon would be torn apart by gravity in to billion years ago. This however never happened. Furthermore geological evidence indicates that the reces sion of the Moon in the past was slower than the present rate i. e. the recession has been accelerating with time. Based on tidal friction models it must be concluded that tidal friction was ve ry much less in the remote past than we would deduce on the basis of presentday observations S tacey . This was called geological time scale difficulty or Lunar cr isis and is one of main arguments by creationists against the tidal friction theory Brush . Various models were proposed in the past to describe the evolution of the EarthMoon system based on tidal friction mechanism to avoid this difficulty and put th e Moon at quite a comfortable distance from Earth at . billion years ago Hansen Kagan and Maslova Ray et al. Slichter . The tidal friction theories explain that the present rate of tidal dissipation is anomalously high because the tidal force is close to a resona nce in the response function of ocean Brush . Kagan gave a detailed review about those tidal friction models Kagan . However all those m odels are based on many assumptions about geological continental position and drifting and physical conditions in the past and many parameters such as phase lag angle multimode approximation with timedependent frequencies of the resonance modes etc. have to be introduced and carefully adjusted to make their predictions close to the geological evidence. Therefore they are not so convincing and are still challenged by cr eationists. In the Meeting of Division of Particle and Field American Physical Society University of California at Riverside the author proposed a dark matte r field fluid model Pan the current Moon and Earth data agree with this model very well. This paper will demonstrate that the past evolution of MoonEarth system can be described by the da rk matter field fluid model without any assumptions about past geological and physical conditions. Although the subject of the evolution of the EarthMoon system has been extensively studied analytically or numerically to the authors knowledge there are no theories similar or equivalent to this model. It should be noted that the proposed dark matter field fluid is more like the cosmic fluid in distinguishing to the galactic halo or clump type of the dark matter in current cosmological theories. . The dark matter field fluid model In this proposed model it is assumed that . A celestial body rotates and moves in the space which for simplicity is uniformly filled with the dark matter which is in qui escent state relative to the motion of the celestial body. The dark matter possesses a fi eld property and a fluid property it can interact with the celestial body w ith its fluid and fiel d properties theref ore it can have energy exchange with the celestial body and affect the motion of the celestial body. . The fluid property follows the general prin ciple of fluid mechanics. The dark matter field fluid particles may be so small that they can easily permeate into ordinary baryonic matter i. e. ordina ry matter objects could be satu rated with such dark matter field fluid. Thus the whole celestial body intera cts with the dark matter field fluid in the manner of a sponge moving thru water. The natu re of the field propert y of the dark matter field fluid is unknown. It is here assumed that the interaction of the field associated with the dark matter field fluid with the celes tial body is proportional to the mass of the celestial body. The dark matter fiel d fluid is assumed to have a repulsive force against the gravitational force towards baryonic matter. Th e nature and mechanism of such repulsive force is unknown. With the assumptions above one can study how the dark matter field fluid may influence the motion of a cel estial body and compare the results with observations. The common shape of celestial bodies is spherical. According to Stokess law a rigid non permeable sphere moving through a quiescent fluid with a sufficiently low Reynolds number experiences a resistance force F rv F where v is the moving velocity r is the radius of the sphere and is the fluid viscosity constant. The direction of the resistance forc e in equation is opposite to the direction of the velocity. For a rigid sphere moving through the dark matter field fluid due to the dual properties of the dark matter field fluid and its permeation into the sphere the force F may not be proportional to th e radius of the sphere. Also F may be proportional to the mass of the sphere due to the field interacti on. Therefore with the combined effects of both fluid and field the force exerted on the sphere by the dark matter field fluid is assumed to be of the scaled form mv r Fn where n is a parameter arising from saturation by dark matter field fluid the rn can be viewed as the effective radius with the same unit as r m is the mass of the sphere and is the dark matter field fluid c onstant which is equivalent to . The direction of the force in equation is opposite to th e velocity. The force described by equation is velocity dependent and causes negativ e acceleration. According to Newtons second law of motion the equation of mo tion for the sphere is mv rdtdvmn Then exp t r v vn where v is the initial velocity t of the sphere. If th e sphere revolves around a massive gravitational center ther e are three forces in the lin e between the sphere and the gravitational center the gravitational for ce the centripetal acceleration force and the repulsive force of the dark matter fi eld fluid. The drag force in equation reduces the orbital velocity and causes the sphere to move inward to the gravitational center. However if the sum of the centripetal acceleration force and the repulsive force is stronger than the gravitational force then the sphere will move outward and recede from the gravitational center. This is the case of interest here. If the velocity change in equation is sufficiently slow and the re pulsive force is small compared to the gravitational force and centripetal accelerati on force then the rate of receding will be accordingly relatively slow. Therefore th e gravitational force and the centripetal acceleration force can be approximately treate d in equilibrium at any time. The pseudo equilibrium equation is Rmv RGMm where G is the gravitational constant M is the mass of the gravitational center and R is the radius of the orbit. Inserting v of equation into equation yields exp t r vGMRn or exp t r R Rn where vGMR R is the initial distance to the gravitational center. Note that R exponentially increases with time. The increase of orbital energy with the receding comes from the repulsive force of dark matter field fluid. Th e recessional rate of the sphere is R rdtdRn The acceleration of the recession is R r dtR dn . The recessional acceleration is positive and proportional to its distance to the gravitational center so the r ecession is faster and faster. According to the mechanics of fluids for a rigid nonpermeable sphere rotating about its central axis in the quiescent fluid the torque T exerted by the fluid on the sphere is r T where is the angular velocity of the sphere. Th e direction of the torq ue in equation is opposite to the direction of the rotation. In the case of a sphere ro tating in the quiescent dark matter field fluid with angular velocity similar to equation the proposed T exerted on the sphere is m r Tn The direction of the torque in equation is opposite to the direction of the rotation. The torque causes the negative angular acceleration dtdI T where I is the moment of inertia of the sphere in the dark matter field fluid nr m I Therefore the equation of rotation for the sphere in the dark matter field fluid is nrdtd Solving this equation yields exp t rn where is the initial angul ar velocity. One can see that the angular velocity of the sphere exponentially decreases with time and the angular de celeration is proportional to its angular velocity. For the same celestial sphere combining equation and eq uation yields . dtdR Rdtd The significance of equation is that it contains only observed data without assumptions and undetermined parameters therefor e it is a critical test for this model. For two different celestial spheres in the same system combining equation and equation yields . n rr dtdR Rdtd This is another critical test for this model. . The current behavior of the EarthMoon system agrees with the model The EarthMoon system is the simplest gravitational system. The solar system is complex the Earth and the Moon experience no t only the interaction of the Sun but also interactions of other planets. Let us consider the local EarthMoon gravitational system as an isolated local gravitational system i.e. the influence from the Sun and other planets on the rotation and orbital motion of the Moon and on the rotation of the Earth is assumed negligible compared to the forces exerted by the Moon and Earth on each other. In addition the eccentricity of the Moons or bit is small enough to be ignored. The data about the Moon and the Earth from references Dickey et .al. and Lang are listed below for the readers convenience to verify the calculation because the data may vary slightly with di fferent data sources. Moon Mean radius r . km Mass m . gram Rotation period . days Angular velocity of Moon . rad s Mean distance to Earth Rm km Mean orbital velocity v . km s Orbit eccentricity e . Angular rotation acceleration rate . . arcsec century . . rad century . . rad s Receding rate from Earth . . cm year . . m s Earth Mean radius r . km Mass m . gram Rotation period h m . s . s Angular velocity of rotation . rad s Mean distance to the Sun R m . km Mean orbital velocity v . km s Angular acceleration of Earth . . rad s The Moons angular rotation accele ration rate and increase in mean distance to the Earth receding rate were obtained from the lunar laser ranging of the Apollo Program Dickey et .al. . By inserting the data of th e Moons rotation and rece ssion into equation the result is . . . . . . The distance R in equation is from th e Moons center to the Earths center and the number km is assumed to be the distance fr om the Moons surface to the Earths surface. Equation is in good agreement with the th eoretical value of .. The result is in accord with the model used here. The difference about . between the values of . and . may come from several sources . Moons orbital is not a perfect circle . Moon is not a perfect rigid sphere. . The effect from Sun and other planets. . Errors in data. . Possible other unknown reasons. The two parameters n and in equation and equation can be determined with two data sets. The third data set can be us ed to further test the model. If this model correctly describes the situation at hand it sh ould give consistent results for different motions. The values of n and calculated from three different data sets are listed below Note the mean distance of the Moon to th e Earth and mean radii of the Moon and the Earth are used in the calculation. The value of n n . From the Moons rotation . s m From the Earths rotation . s m From the Moons recession . s m One can see that the three values of are consistent within the range of error in the data. The average value of . . s m By inserting the data of the Earths rota tion the Moons recession and the value of n into equation the result is . . . . . . . This is also in accord with the model used here. The dragging force exerted on the Moons orbital motion by the dark matter field fluid is . N this is negligibly small compared to the gravitational force between the Moon and the Earth . N and the torque exerted by the dark matter field fluid on the Earths and the Moon s rotations is T . Nm and . Nm respectively. . The evolution of EarthMoon system Sonett et al. found that the length of the terrestrial day million years ago was about . hours based on the laminated tidal sediments on the Earth Sonett et al . . According to the model presented here back in that time the length of the day was about . hours this ag rees very well with Sonett et al. s result. Based on the dark matter field fluid model and the above result the closest distance cen ter to center of the Moon to the Earth was about km or about twothirds of current distance at . billion years ago this is fa r beyond the Roches lim it. This number agrees closely with some of earlier MoonEarth models. The clos est distance of the Moon to the Earth by Hansens models was about Earth radii or km Hansen . According to this model the length of day of the Earth wa s about hours at . b illion years ago. Fig. shows the evolution of the distance of Moon to the Earth and the length of day of the Earth with the age of the Ea rthMoon system described by this model along with data from Kvale et al. Sonett et al. and Scrutton . One can see that those data fit this model very well in their time range. Fig. shows the geological data of solar days year from Wells and from Sonett et al. and the desc ription solid line by this dark matter field fluid model for past million years. One can see that the model agrees with the geological and fossil data beautifully. The important difference of this model w ith early models in describing the early evolution of the EarthMoon system is that this model is based only on current data of the EarthMoon system and there are no assumptions about the conditions of earlier Earth rotation and continental drifting. Based on this model the EarthM oon system has been smoothly evolving to the current position since it was established and the recessional rate of the Moon has been gradually increasing however this description do es not take it into account that there might be speci al events happened in the past to cause the suddenly significant changes in the motions of the Eart h and the Moon such as strong impacts by giant asteroids and comets etc because those impacts are very co mmon in the universe. The general pattern of the evolution of the EarthMoon system described by this model agrees with geological evidence. Based on equa tion the recessional rate exponentially increases with time. One may then imagine th at the recessional rate will quickly become very large. The increase is in fact extremely slow. The Moons recessional rate will be . m s after billion years and . m s after billion years. However whether the Moons r ecession will continue or at some time later another mechanism will take over is not known. It should be understood that the tidal friction does affect the evolution of the Earth itself such as the surface crust structure continental drifting and evolution of biosy stem etc it may also play a role in slowing the Earths rotation however such role is not a dominant mechanism. Unfortunately there is no data available for the changes of the Earths orbital motion and all other members of solar system. According to this model and above results the recessional rate of the Earth should be . m s . m year . km century the length of a year increases about . ms and the change of the temperature is . K year with constant radiation level of th e Sun and the stable environment on the Earth. The length of a year at billion years ago would be of the current length of the year. However much evidence growthbands of corals and shellfish as well as some other evidences suggest th at there has been no apparent change in the length of the year over the billion years and the Earths orbita l motion is more stable than its rotation in which it experiences the dragging torque by the da rk matter field fluid. This suggests that dark matter field fluid is circulating around Sun with the same direction and similar speed of Earth at least in the Earths orbital ra nge. Therefore the Earths orbital motion experiences very little or no dragging force from the dark matter field fluid. However this is a conjecture extensive research has to be conducted to verify if this is the case. . Skeptical description of the evolution of the Mars The Mars is our nearest ne ighbor which has attracted gr eat attention since ancient time. The exploration of the Mars has been heating up in recent decades. NASA Russian and Europe Space Agency sent many space crafts to the Mars to collect data and study this mysterious planet. So far there is still not enough data about the history of this planet to describe its evolution. Same as the Earth the Mars rotates about its central axis and revolves around the Sun howev er the Mars does not have a massive moon circulating it and there is no liquid fluid on its surface ther efore there is no apparent oceanlike tidal friction force to slow its rota tion by tidal friction theories. Based on the above result and current the Marss data this model predicts that the Marss rotati on also experiences the dragging torque by the dark matter field fluid and the angular rotati on acceleration of the Mars should be about . rad s. Figure describes the possible evolution of the length of day and the solar daysMars year the vertical dash line marks the current age of the Mars with assumption that the Mars was formed in a similar time period of the Earths formation. Such description is complete ly skeptical due to lack of reliable data. The research and exploration of the Mars has been expanded dram atically in recent decades. We shall feel confident that the reliable data about the angular rotation acceleration of the Mars will be available in th e near future which will provide a vital test for the predication of this model. However there are also other factors which may affect the Mars rotation rate such as mass redist ribution due to season change winds possible volcano eruptions and Mars quake s. Therefore the data has to be carefully analyzed. . Discussion about the model From the above results one can see that the current EarthMoon data and the geological and fossil data agree with the mode l very well and the pa st evolution of the EarthMoon system can be described by th e model without intr oducing any additional parameters this model reveals the interesting relationship between the rotation and receding Eq. and Eq. of the same celestial body or different celestial bodies in the same gravitational system such relationshi p is not known before. Such success can not be explained by coincidence or luck because of so many data involved current Earths and Moons data and geological and fossil data if one thinks that this is a wrong model although the chance for the natural ha ppening of such coincidence or luck could be greater than wining a jackpot lotter y otherwise a new theory from different approach can be developed to give the same or better description as this model does. It is certain that this model is not perfect and ma y have defects further development may be conducted. James Clark Maxwell said in The vast interplanetary and interstellar regions will no longer be regarde d as waste places in the universe which the Creator has not seen fit to fill with the symbols of th e manifold order of His kingdom. We shall find them to be already full of this wonderf ul medium so full that no human power can remove it from the smallest portion of space or produce the slightest flaw in its infinite continuity. It extends unbr oken from star to star . The medium that Maxwell talked about is the aether which was proposed as the carrier of light wave propagation. The MichelsonMorley experiment only proved th at the light wave propagation does not depend on such medium and did not reject the existence of the medium in the interstellar space. In fact the concept of the interstellar medium has been developed dramatically recently such as the dark matter dark energy cosmic fluid etc. The d ark matter field fluid is just a part of such wonderful me dium and precisely de scribed by Maxwell. . Conclusion The evolution of the EarthMoon system can be described by the dark matter field fluid model and the current data of the Eart h and the Moon fit this model very well. At . billion years ago the closest distance of the Moon to the Earth could be about km which is far beyond the Roches limit and the length of day was about hours. The general pattern of the evoluti on of the EarthMoon system described by this model agrees with geological and fossil evidence. The tidal friction may not be the primary cause for the evolution of the EarthMoon system. This model predicts that the Marss rotation is also slowing with the angular a cceleration rate about . rad s. 
2,0704.0008,"  A general formulation was developed to represent material models for
applications in dynamic loading. Numerical methods were devised to calculate
response to shock and ramp compression, and ramp decompression, generalizing
previous solutions for scalar equations of state. The numerical methods were
found to be flexible and robust, and matched analytic results to a high
accuracy. The basic ramp and shock solution methods were coupled to solve for
composite deformation paths, such as shock-induced impacts, and shock
interactions with a planar interface between different materials. These
calculations capture much of the physics of typical material dynamics
experiments, without requiring spatially-resolving simulations. Example
calculations were made of loading histories in metals, illustrating the effects
of plastic work on the temperatures induced in quasi-isentropic and
shock-release experiments, and the effect of a phase transition.
", The continuum representation of matter is widely used for ma terial dynamics in science and engineering. Spatiallyresolved continuum dynamics simulations are the most widespread and familiar solving the initial va lue problem by dis cretizing the spatial domain and integrating the dynamical equations forward in time to predict the motion and deformation of components o f the system. Email address dswiftlanl.gov Damian C. Swift. Preprint submitted to Elsevier March LAUR This type of simulation is used for instance to study hyper velocity impact problems such as the vulnerability of armor to projectiles the perfor mance of satellite debris shields and the impact of mete orites with plan ets notably the formation of the moon . The problem can be divided into the dynamical equations of the continuum the state eld of t he components svector r and the inherent properties of the materials. Given the lo cal material states the material properties allow the stress to be determined. Given the stress eld vector r and mass density eld vector r the dynamical equations describe the elds of acceleration compression and thermodynamic work done on the materials. The equations of continuum dynamics describe the behavior o f a dynami cally deforming system of arbitrary complexity. Particula r simpler deforma tion paths can be described more compactly by dierent sets o f equations and solved by dierent techniques than those used for contin uum dynamics in general. Simpler deformation paths occur often in experi ments designed to develop and calibrate models of material properties. The se paths can be regarded as dierent ways of interrogating the material pro perties. The princi pal examples in material dynamics are shock and ramp compres sion. Typical experiments are designed to induce such loading histories a nd measure or in fer the properties of the material in these states before the y are destroyed by reected waves. The development of the eld of material dynamics was driven b y applications in the physics of hypervelocity impact and high explosive sy stems including nuclear weapons . In the regimes of interest typically c omponents with dimensions ranging from millimeters to meters and pressure s from GPa to TPa material behavior is dominated by the scalar equation of state EOS the relationship between pressure compression or mass de nsity and inter nal energy. Other components of stress specically shear s tresses are much smaller and chemical explosives react promptly so can be tr eated by simple models of complete detonation. EOS were developed as ts to e xperimen tal data particularly to series of shock states and to isoth ermal compression measurements . It is relatively straightforward to cons truct shock and ramp compression states from an EOS algebraically or numericall y depending on the EOS and to t an EOS to these measurements. More recently applica tions and scientic interest have grown to include a wider ra nge of pressures and time scales such as laserdriven inertial connement f usion and ex periments are designed to measure other aspects than the EOS such as the kinetics of phase changes constitutive behavior describi ng shear stresses in complete chemical reactions and the eects of microstruct ure such as grain orientation and porosity. Theoretical techniques have als o evolved to predict the EOS with accuracy and elastic contributions to shear stress wi th slightly poorer accuracy . In this paper a general convention for representing materi al states is described and numerical methods are reported for calculating shock an d ramp compres sion states from general representations of material prope rties. Conceptual structure for material properties The desired structure for the description of the material st ate and properties under dynamic loading was developed to be as general as possi ble with respect to the types of material or models to be represented in the sam e framework and designed from the greatest amount of commonality betwee n spatially resolved simulations and calculations of shock and ramp com pressions. In condensed matter on submicrosecond time scales heat co nduction is often too slow to have a signicant eect on the response of the mate rial and is ignored here. The equations of nonrelativistic continu um dynamics are in Lagrangian form i.e. along characteristics moving with t he local material velocity vector uvector r Dvector r t Dtvector r tdivvector uvector r t Dvector uvector r t Dt vector r tdivvector r t Devector r t Dtvector r tgradvector uvector r t where is the mass density and ethe specic internal energy. Changes in e can be related to changes in the temperature Tthrough the heat capacity. The inherent properties of each material in the problem are d escribed by its constitutive relation or equation of state s. As well as experiencing compression and work from mechanical deformation the loca l material state svector r t can evolve through internal processes such as plastic ow. In general Dsvector r t Dtssvector r t Uvector r t Ugradvector uvector r t which can also include the equations for t andet. Thus the mate rial properties must describe at a minimum s and ssvector r t Uvector r t for each material. If they also describe Ts the conductivity and se then heat conduction can be treated. Other functions may be needed for particular nu merical methods in continuum dynamics such as the need for w ave speeds e.g. the longitudinal sound speed which are needed for ti me step control in explicit time integration. Internally within the materia l properties models it is desirable to reuse software as much as possible and othe r functions of the state are therefore desirable to allow models to be construc ted in a modular and hierarchical way. Inevitably arithmetic manipulatio ns must be performed on the state which can be encoded neatly using operator over loading. For instance if sis calculated in a forwardtime numerical method then chang es of state are calculated using numerical evolution equation s such as stt st ts. Thus for a general state s it is necessary to multiply it by a real number and to add two states together. For a specic software implem entation other operations may be needed for example to create copy or des troy a new instance of a state. A very wide range of types of material behavior can be represe nted with this formalism. At the highest level dierent types of behavior are characterized by dierent structures for the state sTable . For each type of state dierent specic models can be dened such as perfect gas and Gr unei sen EOS. For each specic model dierent materials are represented by c hoosing dierent values for the parameters in the model and dierent local ma terial states are represented through dierent values for the components of s. In the jargon objectoriented programming this is polymorphism. State s or models may be dened by extending or combining other states or models t his can be implemented using the objectoriented programming concep t of inheritance. Trial implementations have been made as libraries in the C and Java pro gramming languages. The external interface to the material properties was general at the level of representing a generic material type and state. The type of state and model were then selected when programs usin g the material properties library were run. In C objects which were poly morphic at run time had to be represented as pointers requiring additiona l software construc tions to allocate and free up physical memory associated wit h each object. It was possible to include general reusable functions as poly morphic objects when dening models real functions of one real parameter co uld be polyno mials transcendentals tabular with dierent interpolat ion schemes piecewise denitions over dierent regions of the one dimensional lin e sums products etc again dened specically at run time. Objectoriented polymorphism and inheritance were thus very powerful techniques for increas ing software reuse making the software more compact and more reliable through t he possibility of using functions which had already been tested. Given conceptual and software structures designed to repre sent general ma terial properties suitable for use in spatiallyresolved c ontinuum dynamics simulations we now consider the use of these generic materi al models for calculating ramp and shock compression. Table Examples of types of material model distinguished by dier ent structures in the state vector. model state vector eect of mechanical strain s smsgradu equation of state e divvector updivvector u complete equation of state T divvector updivvector uc v heterogeneous mixture ef vi divvector updivvector ui homogeneous mixture Tfmi divvector updivvector uc vi traditional deviatoric strength e p divvector updivvector ufpp GeradicalBig fp The symbols are mass density e specic internal energy T temperature fv volume fraction fm mass fraction stress deviator fp fraction of plastic work converted to heat grad up plastic part of velocity gradient G shear modulus ep elastic and plastic parts of strain rate deviator p scalar equivalent plastic strain f factor in eective strain magnitude. Reacting solid explos ives can be represented as heterogeneous mixtures one component being the reacted pr oducts reaction a pro cess of internal evolution transfers material from unreac ted to reacted components. Gasphase reaction can be represented as a homogeneous mixt ure reactions trans ferring mass between components representing dierent typ es of molecule. Symmet ric tensors such as the stress deviator are represented more compactly by their unique upper triangular components e.g. using Voigt notat ion. Ramp compression Ramp compression is taken here to mean compression or decomp ression. If the material is represented by a scalar EOS i.e. ignoring an y eects of plastic ow ramp compression follows an isentrope. This is no longe r true when dissipative processes such as plastic heating occur. The te rm quasiisentropic is sometimes used in this context particularly for shockle ss compression here we prefer to refer to the thermodynamic trajectories as adia bats since this is a more appropriate term no heat is exchanged with the surrou ndings on the time scales of interest. For adiabatic compression the state evolves according to t he second law of thermodynamics dep dv i.e. epvpdivvector u of for a more general material whose stress tensor is more com plicated than a scalar pressure endvendivvector u where nis the component of stress normal to the direction of deforma tion. The velocity gradient was expressed through a compression f actorrho and a strain rate . In all ramp experiments used in the development and cal ibration of accurate material models the strain has been ap plied uniaxially. More general strain paths for instance isotropic or includ ing a shear compo nent can be treated by the same formalism and that the heati ng rate would then be a full inner product of the stress and strain tensors. The acceleration or deceleration of the material normal to t he wave as it is compressed or expanded adiabatically is Du DvradicalBigg n v from which it can be deduced that Du Dcl where clis the longitudinal wave speed. As with continuum dynamics internal evolution of the mater ial state can be calculated simultaneously with the continuum equations or operator split and calculated periodically at constant compression. The r esults are the same to second order in the compression increment. Operatorspl itting is desirable when internal evolution can produce highly nonlinear chang es such as reaction from solid to gas rapid changes in state and properties can m ake numerical schemes unstable. Operatorsplitting is also desirable wh en the integration time step for internal evolution is much shorter than the con tinuum dynamics time step. Neither of these considerations is very importan t for ramp compres sion without spatial resolution but operatorsplitting w as used as an option in the ramp compression calculations for consistency with con tinuum dynamics simulations. The ramp compression equations were integrated using forwa rdtime Runge Kutta numerical schemes of second order. The fourth order sc heme is a trivial extension. The sequence of operations to calculate an incre ment of ramp com pression is as follows Time increment tln Predictor stt st t smst Corrector stt st tsmstt Internal evolution sttstt ttintegraldisplay tsistdt where smis the modeldependent state evolution from applied strain and si is internal evolution at constant compression. The independent variable for integration is specic volume vor mass density for numerical integration nite steps are taken in andv. The step size can be controlled so that the numerical error during integra tion remains within chosen limits. A tabular adiabat can be calculated by integrating over a range of vor but when simulating experimental scenarios the upper limi t for integration is usually that one of the other thermodynamic q uantities reaches a certain value for example that the normal component of str ess reaches zero which is the case on release from a high pressure state a t a free surface. Specic stop conditions were found by monitoring the quanti ty of interest until bracketed by a nite integration step then bisecting until the stop condition was satised to a chosen accuracy. During bisection each tr ial calculation was performed as an integration from the rst side of the bracket by the trial compression. Shock compression Shock compression is the solution of a Riemann problem for th e dynamics of a jump in compression moving with constant speed and with a constant thickness. The RankineHugoniot RH equations descr ibing the shock compression of matter are derived in the continuum approxim ation where the shock is a formal discontinuity in the continuum elds. I n reality matter is composed of atoms and shocks have a nite width governed b y the kinetics of dissipative processes at a fundamental level matter do es not distinguish between shock compression and ramp compression with a high s train rate but the RH equations apply as long as the width of the region of matter where unresolved processes occur is constant. Compared with the i sentropic states induced by ramp compression in a material represented by an E OS a shock always increases the entropy and hence the temperature. Wit h dissipative processes included the distinction between a ramp and a sho ck may become blurred. The RH equations express the conservation of mass momentum and energy across a moving discontinuity in state. They are usually exp ressed in terms of the pressure but are readily generalized for materials sup porting shear stresses by using the component of stress normal to the shock i.e. pa rallel with the direction of propagation of the shock n u sv nn vv upradicalBig nnvv ee nnvv where usis the speed of the shock wave with respect to the material upis the change in material speed normal to the shock wave i.e. p arallel to its direction of propagation and subscript refers to the ini tial state. The RH relations can be applied to general material models if a time scale or strain rate is imposed and an orientation chosen for the m aterial with respect to the shock. Shock compression in continuum dynami cs is almost always uniaxial. The RH equations involve only the initial and nal states in t he material. If a material has properties that depend on the deformation path such as plas tic ow or viscosity then physically the detailed shock str ucture may make a dierence . This is a limitation of discontinuous shoc ks in continuum dynamics it may be addressed as discussed above by includin g dissipative processes and considering ramp compression if the dissipa tive processes can be represented adequately in the continuum approximation. Spatiallyresolved simulations with numerical dierentiation to obtain spati al derivatives and for ward time dierencing are usually not capable of representi ng shock disconti nuities directly and an articial viscosity is used to smea r shock compression over a few spatial cells . The trajectory followed by the material in ther modynamic space is a smooth adiabat with dissipative heatin g supplied by the articial viscosity. If plastic work is also included du ring this adiabatic compression the overall heating for a given compression is greater than from the RH equations. To be consistent plastic ow should be neg lected while the articial viscosity is nonzero. This localized disabl ing of physical pro cesses particularly timedependent ones during the pass age of the unphys ically smeared shock was previously found necessary for num erically stable simulations of detonation waves by reactive ow . Detonation waves are reactive shock waves. Steady planar de tonation the ChapmanJouguet state may be calculated using the RH r elations by imposing the condition that the material state behind the sh ock is fully re acted. Several numerical methods have been used to solve the RH equa tions for materials represented by an EOS only . The general RH equations may be solved numerically for a given shock compression by varying the specic internal energy euntil the normal stress from the material model equals that from the RH energy equation Eq. . The shock and particle sp eeds are then calculated from Eqs and . This numerical method is p articularly convenient for EOS of the form p e asemay be varied directly. Solutions may still be found for general material models using se by which the energy may be varied until the solution is found. Numerically the solution was found by bracketing and bisec tion For given compression take the lowenergy end for bracketing as a nearby state se.g. the previous state of lower compression on the Hugoniot compressed adiabatically to state s and cooled so the spe cic internal energy is es. Bracket the desired state apply successively larger he ating increments eto s evolving each trial state internally until ns from the material model exceeds nee from Eq. . Bisect in e evolving each trial state internally until ns equals ne e to the desired accuracy. As with ramp compression the independent variable for solu tion was mass density and nite steps were taken. Each shock state was calculated independently of the rest so numerical errors did not accum ulate along the shock Hugoniot. The accuracy of the solution was independen t of . A tab ular Hugoniot can be calculated by solving over a range of but again when simulating experimental scenarios it is usually more usefu l to calculate the shock state where one of the other thermodynamic quantities reaches a cer tain value often that upandnmatch the values from another simultaneous shock calculation for another material the situation in im pact and shock transmission problems discussed below. Specic stop cond itions were found by monitoring the quantity of interest until bracketed by a nite solution step then bisecting until the stop condition was satised to a cho sen accuracy. Dur ing bisection each trial calculation was performed as a sho ck from the initial conditions to the trial shock compression. Composite loading paths Given methods to calculate shock and adiabatic loading path s from arbitrary initial states a considerable variety of experimental sce narios can be treated from the interaction of loading or unloading waves with inte rfaces between dif ferent materials in planar geometry for uniaxial compress ion. The key physical constraint is that if two dissimilar materials are to remai n in contact after an interaction such as an impact or the passage of a shock the no rmal stress n and particle speed upin both materials must be equal on either side of the interface. The change in particle speed and stress normal to the waves were calculated above for compression waves running in the direc tion of increasing spatial ordinate left to right. Across an interface the s ense is reversed for the material at the left. Thus a projectile impacting a stati onary target to the right is decelerated from its initial speed by the shock indu ced by impact. The general problem at an interface can be analyzed by consid ering the states at the instant of rst contact on impact or when a sho ck travel ing through a sandwich of materials rst reaches the interfa ce. The initial states are ul slur sr. The nal states are uj s luj r rwhere ujis the joint particle speed ns l ns r and s iis connected to siby either a shock or an adiabat starting at the appropriate initial velocity and stress and with orientation given by the side of the system each material occ urs on. Each type of wave is considered in turn looking for an intersection in theupnplane. Examples of these wave interactions are the impact of a proje ctile with a sta tionary target Fig. release of a shock state at a free sur face or a material e.g. a window of lower shock impedance hence reecting a r elease wave into the shocked material Fig. reshocking at a surface w ith a material of higher shock impedance Fig. or tension induced as mater ials try to sepa rate in opposite directions when joined by a bonded interfac e Fig. . Each of these scenarios may occur in turn following the impact of a pr ojectile with a target if the target is layered then a shock is transmitted a cross each interface with a release or a reshock reected back depending on the ma terials release ultimately occurs at the rear of the projectile and the far en d of the target and the oppositelymoving release waves subject the projec tile and target to tensile stresses when they interact Fig. . An extension of this analysis can be used to calculate the int eraction of oblique shocks with an interface . initial state particle speednormal stress initial state of projectileprincipal Hugoniot of targetprincipal Hugoniot of projectile shock state intersection of target Fig. . Wave interactions for the impact of a at projectile m oving from left to right with a stationary target. Dashed arrows are a guide to the seq uence of states. For a projectile moving from right to left the construction is th e mirror image reected in the normal stress axis. states particle speednormal stress secondary Hugoniot of target initial shock state in targetprincipal Hugoniot high impedance window low impedance window target release isentrope target release at free surfacewindow release Fig. . Wave interactions for the release of a shocked state shock moving from left to right into a stationary window material to its right. T he release state depends whether the window has a higher or lower shock impedance than the shocked mate rial. Dashed arrows are a guide to the sequence of states. For a shock moving from right to left the construction is the mirror image reected in the normal stress axis. Preferred representation of isotropic strength There is an inconsistency in the standard continuum dynamic s treatment of scalar pressure and tensor stress response. The scalar EOS expresses the pressure p e as the dependent quantity which is the most convenient for m projectile releasein projectile and target final tensile state in projectile and targetparticle speednormal stress target release target releaseprojectile releaseinitial shock state Fig. . Wave interactions for the release of a shocked state b y tension induced as materials try to separate in opposite directions when joine d by a bonded interface. Material damage spall and separation are neglected the c onstruction shows the maximum tensile stress possible. For general material prop erties e.g. if plastic ow is included the state of maximum tensile stress is not just t he negative of the initial shock state. Dashed arrows are a guide to the sequence of stat es. The graph shows the initial state after an impact by a projectile moving from right to left for a shock moving from right to left the construction is the mirr or image reected in the normal stress axis. for use in the continuum equations. Standard practice is to u se subHookean elasticity hypoelastic form described above in whi ch the state parame ters include the stress deviator evolved by integration Gs where Gis the shear modulus and the strain rate deviator. Thus the isotropic and deviatoric contributions to stress are not treated in an equivalent way the pressure is calculated from a local state involving a str ainlike parameter mass density whereas the stress deviator evolves with th e timederivative of strain. This inconsistency causes problems along compli cated loading paths because Gvaries strongly with compression if a material is subjecte d to a tension time projectile windowtarget impact shocks transmitted shock reflected wave free surface release release interactions Fig. . Schematic of uniaxial wave interactions induced by t he impact of a at projectile with a composite target. shear strain then isotropic compression increases the shear modulus f rom GtoG leaves unchanged then shear unloading to isotropic stress the true unloading strain is whereas the hypoelastic calculation would require a strain of GG. The stress can be considered as a direct response of the mater ial to the instan taneous state of elastic strain T. This relation can be predicted directly with electronic structure calculations of the stress tenso r in a solid for a given compression and elastic strain state and is a direct gen eralization of the scalar equation of state. A more consistent representation of the state param eters is to use the strain deviator rather than and to calculate from scratch when required using Gs a hyperelastic formulation. The state parameters are then e p. The dierent formulations give dierent answers when devia toric strain is accumulated at dierent compressions in which case the hyp erelastic formu lation is correct. If the shear modulus varies with strain de viator i.e. for nonlinear elasticity then the denition of G must be adjusted to give the same stress for a given strain. Many isotropic strength models use scalar measures of the st rain and stress to parameterize work hardening and to apply a yield model of ow stress radicalBig fradicalBig f. Inconsistent conventions for equivalent scalar measures h ave been used by dierent workers. In the present work the common shock phys ics convention was used that the ow stress component of nis Ywhere Yis the ow stress. For consistency with published speeds and amplitudes for el astic waves f f in contrast to other values previously used for lowerrate deformation . In principle the values of fandfdo not matter as long as the strength parameters were calibrated using the same values then used i n any simulations. Examples In this section the numerical methods described above are a pplied to example materials demonstrating the eects of strength and chemic al reaction on the loading paths. The materials chosen were air represented by a perfect gas EOS the elemental metals Be and Mo. The perfect gas case tests the numerical schemes against analytic results. Be has been shown to exhib it relatively high ow stresses for deformation on the nanosecond time scales o f interest for its application as the fuel capsule and ablator in inertial c onnement fusion . Mo is interesting as experimental measurements sugge st that its shock temperature is signicantly greater than expected using th e EOS only . . Air Air was chosen as an example of matter represented by the scal ar EOS only taken here to be the perfect gas EOS p e with .. Air at standard temperature and pressure has approximate ly gcmande .MJkg. Isentropes for the perfect gas EOS have the form pconstant . . . . .pressure GPa mass density gcmisentropeHugoniot . . . . . .pressure difference mass density gcmisentropeHugoniot Fig. . Principal isentrope and shock Hugoniot for air perf ect gas numerical cal culations for general material models compared with analy tic results. and shock Hugoniots have the form p ep . The numerical methods above reproduced the principal isent rope and Hugo niot to and . respectively for a compression increment of al ong the isentrope and a solution tolerance of GPa for each shock state Fig. . Over most of the range the error in the Hugoniot was . or l ess only ap proaching . near the maximum shock compression. . Complete equation of state for metals Empirical EOS for Be and Mo have been published that were tted to shock data acquired from microsecond scale impact experi ments. This Gr uneisen EOS had the form p e so the temperature Twas not directly available. Temperatures were calculated by reference to a c ompression curve along which the temperature and specic internal energy wer e known Tr er and using a specic heat capacity dened as a function of dens itycv con stant in practice. The reference curve chosen was the zero k elvin isotherm cold curve Tr K. This was calculated from the principal isentrope esusing the estimated density variation of Gr uneisen parame ter er esTcpeaparenleftBigg parenrightBigga . In the calculations this augmented EOS was represented as a mechanical thermal form comprising any p e EOS plus the reference curves an ex ample of inheritance and polymorphism. Empirical EOS are calibrated using experimental data. Shoc k and adiabatic compression measurements on strong materials inevitably i nclude elasticplastic contributions as well as the scalar EOS itself. If the elasti cplastic contributions are not taken into account selfconsistently the EOS may im plicitly include contributions from the strength. A unique scalar EOS can be c onstructed to reproduce the normal stress as a function of compression for any unique load ing path shock or adiabat for a constant or smoothlyvaryi ng strain rate. Such as EOS would not generally predict the normal stress for other load ing histories. The Gr uneisen EOS and SteinbergGuinan str ength model for the materials discussed below were constructed selfconsi stently from shock data this does not mean the models are accurate for other loa ding paths as neither the EOS nor the strength model includes all the physi cal terms that real materials exhibit. This does not in any case matter for t he purposes of demonstrating the properties of the numerical schemes. . Beryllium The ow stress measured from laserdriven shock experiment s on Be crystals a few tens of micrometers thick is at around GPa much gre ater than the ..GPa measured on microsecond time scales. A timedep endent crystal plasticity model for Be is being developed and the behavior under dynamic loading depends on the detailed time dependence of plastici ty. Calculations were performed with the SteinbergGuinan strength model de veloped for mi . . . . . . normal stress GPa volume compressioneach pair of lines upper is Hugoniot lower is adiabat Fig. . Principal adiabat and shock Hugoniot for Be in normal stresscompression space neglecting strength dashed for SteinbergGuina n strength solid and for elasticperfectly plastic with Y GPa dotted. crosecond scale data and for the purposes of rough com parison with elasticperfectly plastic response with a ow stress of G Pa. The elastic perfectly plastic model neglected pressure and work harden ing. Calculations were made of the principal adiabat and shock Hu goniot and of a release adiabat from a state on the principal Hugoniot. Cal culations were made with and without strength. Considering the state traje ctories in stress volume space it is interesting to note that heating from pla stic ow may push the adiabat above the Hugoniot because of the greater heati ng obtained by integrating along the adiabat compared with jumping from th e initial to the nal state on the Hugoniot Fig. . Even with an elasticper fectly plastic strength model the withstrength curves do not lie exactly Yabove the strengthless curves because heating from plastic ow cont ributes an increasing amount of internal energy to the EOS as compression increase s. An important characteristic for the seeding of instabiliti es by microstructural variations in shock response is the shock stress at which an e lastic wave does not run ahead of the shock. In Be with the high ow stress of nan osecond response the relation between shock and particle speeds is signicantly dif ferent from the relation for low ow stress Fig. . For low ow stress the elastic wave travels at .kms. A plastic shock travels fa ster than this for pressures greater than GPa independent of the constitu tive model. The speed of a plastic shock following the initial elastic wave i s similar to the low strength case because the material is already at its ow str ess but the speed of a single plastic shock is appreciably higher. For compression to a given normal stress the temperature is signicantly shock speed kms normal stress GPaelastic wave plastic shock Fig. . Principal adiabat and shock Hugoniot for Be in shock s peednormal stress space neglecting strength dashed for SteinbergGuina n strength solid and for elasticperfectly plastic with Y GPa dotted. higher with plastic ow included. The additional heating is particularly strik ing on the principal adiabat the temperature departs signi cantly from the principal isentrope. Thus rampwave compression of strong materials may lead to signicant levels of heating contrary to common assumpt ions of small tem perature increases . Plastic ow is largely irreversib le so heating occurs on unloading as well as loading. Thus on adiabatic release f rom a shock compressed state additional heating occurs compared with the nostrength case. These levels of heating are important as shock or relea se melting may occur at a signicantly lower shock pressure than would be ex pected ignoring the eect of strength. Fig. . . Molybdenum Experiments have been reported in which samples of Mo were su bjected to shock loading on microsecond time scales by projectile impa ct and the tem perature in the shocked state was measured by neutron resona nce spectrome try . The temperature measured was around K greater t han predicted using EOS that are thought to be accurate to a few percent. The principal shock Hugoniot of Mo was calculated using mate rial properties previously published with parameters for the Steinbe rgGuinan strength model which includes workhardening pressurehard ening and thermal softening eects. The shock Hugoniot with strength lay at a s ignicantly higher temperature than the calculation ignoring strength which matched the previouslyreported shock Hugoniot Fig. . The tempe rature dierence normal stress GPa temperature Kprincipal adiabat principal Hugoniot release adiabat Fig. . Principal adiabat shock Hugoniot and release adia bat for Be in nor mal stresstemperature space neglecting strength dashe d for SteinbergGuinan strength solid and for elasticperfectly plastic with Y GPa dotted. normal stress GPa temperature Kprincipal adiabat principal Hugoniot release adiabat Fig. . Principal shock Hugoniot for Mo in normal stresstem perature space ne glecting strength dashed and for SteinbergGuinan stren gth solid. Also shown is the experimental measurement of shock temperature by neu tron resonance spec trometry. was around K for the shock pressures of around GPa of the e xperiments a signicant contribution to the discrepancy but not all. T he complete ex planation involves nonidealities in the projectile accel erating system and is discussed elsewhere . Conclusions A general formulation was developed to represent material m odels for appli cations in dynamic loading suitable for software implemen tation in object oriented programming languages. Numerical methods were de vised to calcu late the response of matter represented by the general mater ial models to shock and ramp compression and ramp decompression by dire ct evaluation of the thermodynamic pathways for these compressions rathe r than spatially resolved simulations. This approach is a generalization of earlier work on so lutions for materials represented by a scalar equation of st ate. The numerical methods were found to be exible and robust capable of appli cation to mate rials with very dierent properties. The numerical solutio ns matched analytic results to a high accuracy. Care was needed with the interpretation of some types of phys ical response such as plastic ow when applied to deformation at high stra in rates. The underlying timedependence of processes occurring during deformation should be taken into account. The actual history of loading and heat ing experienced by material during the passage of a shock may inuence the na l state this history is not captured in the continuum approximation to ma terial dynamics where shocks are treated as discontinuities. Thus care is al so needed in spa tially resolved simulations when shocks are modeled using a rticial viscosity to smear them unphysically over a nite thickness. The basic ramp and shock solution methods were coupled to sol ve for compos ite deformation paths such as shockinduced impacts and s hock interactions with a planar interface between dierent materials. Such ca lculations capture much of the physics of typical material dynamics experiment s without requir ing spatiallyresolving simulations. Example calculations were made of loading histories in Be an d Mo illustrating the eects of plastic work on the temperatures induced in qua siisentropic and shockrelease experiments. Acknowledgments Ian Gray introduced me to the concept of multimodel materia l properties software. Lee Markland developed a prototype Hugoniotcal culating computer program for equations of state while working for me as an unde rgraduate summer student. Evolutionary work on material properties libraries was sup ported by the U.K. Atomic Weapons Establishment Fluid Gravity Engineering L td and Wessex Scientic and Technical Services Ltd. Thanks are due to Steve Batha for funding through the Nationa l Nuclear Se curity Agencys Campaign Inertial Connement Fusion. The work was performed under the auspices of the U.S. Department of Energ y under con tracts WENG and DEACNA 
3,0704.0009,"  We discuss the results from the combined IRAC and MIPS c2d Spitzer Legacy
observations of the Serpens star-forming region. In particular we present a set
of criteria for isolating bona fide young stellar objects, YSO's, from the
extensive background contamination by extra-galactic objects. We then discuss
the properties of the resulting high confidence set of YSO's. We find 235 such
objects in the 0.85 deg^2 field that was covered with both IRAC and MIPS. An
additional set of 51 lower confidence YSO's outside this area is identified
from the MIPS data combined with 2MASS photometry. We describe two sets of
results, color-color diagrams to compare our observed source properties with
those of theoretical models for star/disk/envelope systems and our own modeling
of the subset of our objects that appear to be star+disks. These objects
exhibit a very wide range of disk properties, from many that can be fit with
actively accreting disks to some with both passive disks and even possibly
debris disks. We find that the luminosity function of YSO's in Serpens extends
down to at least a few x .001 Lsun or lower for an assumed distance of 260 pc.
The lower limit may be set by our inability to distinguish YSO's from
extra-galactic sources more than by the lack of YSO's at very low luminosities.
A spatial clustering analysis shows that the nominally less-evolved YSO's are
more highly clustered than the later stages and that the background
extra-galactic population can be fit by the same two-point correlation function
as seen in other extra-galactic studies. We also present a table of matches
between several previous infrared and X-ray studies of the Serpens YSO
population and our Spitzer data set.
", The Serpens starforming cloud is one of ve such large cloud s selected for observation as part of The Spitzer Legacy project From Molecular Cores t o Planetforming Disks cd Evans et al. . Previous papers in this series have desc ribed the observational results in the Serpens Cloud as seen with IRAC Harvey et. al. Pap er I and MIPS Harvey et al. as well as some of the other clouds Jorgensen et al. Rebull et al. . In this paper we examine how the combination of the IRAC and MIPS data together with other published results on this region can be used to nd and charac terize a highly reliable catalog of young stellar objects YSOs in the surveyed area. With t he combination of broad wavelength coverage and amazing depth of Spitzers sensiti vity we are able to probe to both extremely low luminosity limits for YSOs and to cover a very wide range in dust emission both in optical depth and in range of emitting temperatures. The Spitzer wavelength region is particularly well tuned for sensitivity to dust at temper atures appropriate for solarsystem size disks around young stars. The region of the Serpens Cloud mapped in our survey is an area rich in star for mation. Eiroa Djupvik Casali have extensively rev iewed studies at a variety of wavelengths of this area. There is evidence from previous ob servations of strong cluster ing Testi et al. Testi Sargent dense submm co res Casali Eiroa Duncan Enoch et al. and highvelocity outows Ziener Eisloel Davis et al. . PreSpitzer infrared surveys of the cloud have been m ade by IRAS Zhang et al. Zhang Laureijs Clark and ISO Kaas et al. Djup vik et al. as well as the pioneering groundbased surveys that rst identied it as a n important region of star forma tion Strom Vrba Strom . Using MIPS and all four bands of IRAC the cd program has mapped a . degportion of this cloud that includes a very wellstudied clus ter of in frared and submillimeter sources Eiroa Casali Hog erheijde van Dishoeck Salverda Hurt Barsony Harvey Wilking Joy Testi Sargent . At its distance of pc Straizys Cernis Bartasiute this correspond s to an area of about . pc. In paper I we identied at least two main centers of star f ormation as seen by Spitzer in this cloud that we referred to as Cluster A and B. Cluster A is the very wellstudied grouping also commonly referred to as the Serp ens Core. Cluster B was the subject of a recent multiwavelength study by Djupvik et al. who referred to it as the Serpens GG cluster. The YSOs with high signaltonoise that we have catalog ued constitute a suciently large number that we can examine statistically the numbers o f objects in various evolutionary states and the range of disk properties for dierent classes of YSOs. We characterize the circumstellar material with colorcolor diagrams that all ow comparison with other recent studies of starforming regions and we model the energy dis tributions of the large number of YSOs that appear to be starcircumstellar disk systems. We are able to construct the YSO luminosity function for Serpens since we have complete s pectral coverage for all the sources over the range of wavelengths where their luminosit y is emitted and we are able to characterize the selection eects inherent in the luminosi ty function from comparison with the publicly available and signicantly deeper SWIRE survey Surace et al. . We nd that the population of YSOs extends down to luminosities be low L and we discuss the signicance of this population. Our complete coverage in wa velength and luminosity space also permits us to discuss the spatial distribution of YSOs to an unprecedented completeness level. We note also that unlike the situation discussed by J orgensen et al. for Perseus in Serpens there do not appear to be any very deeply embedded Y SOs that are not found by our YSO selection criteria. In we briey review the observational details of this program and then in we describe in detail the process by which we identify YSOs and eliminate background contam inants. In we describe a search for variability in our dataset. We comp are our general results on YSOs with those of earlier studies of the Serpens starforming region in . We discuss in the YSO luminosity function in Serpens and in particular the low end of this function. We next analyze the spatial distribution of star f ormation in the surveyed area and compare it to the distribution of dust extinction as deri ved from our observations in . In we construct several colorcolor diagrams that character ize the global properties of the circumstellar material and show modeling results for a large fraction of our YSOs that appear to be stardisk systems. Finally discusses several specic groups of objects including the coldests YSOs and a previously identied di sappearing YSO. We also men tion several obvious highvelocity outows from YSOs that will certainly be the subject of further study. . Observations The parameters of our observations have already been descri bed in detail in Paper I for IRAC and in a companion study Harvey et al. for MIPS. We summarize here some of the issues most relevant to this study. We remind the reader that the angular resolution of the Spitz er imaging instruments varies widely with wavelength since Spitzer is diraction limited longward of m. In the shorter IRAC bands the spatial resolution is of order while from m it goes from roughly to . The area chosen for mapping was dened by the AV contour in the extinction map of Cambr esy and by practical ti me constraints Evans et al. . With the exception of a small area of . degon the northeast edge of the IRAC map all of the area mapped with IRAC was also covered with MIP S at both and m and most of it at m. As described by Harvey et al. some substantial add itional area was observed with MIPS without matching IRAC observati ons. In this current paper we restrict our attention to only the area that was observed f rom . to m . deg. This entire region was observed from . to m at two epochs with a time separation of several hours to several days but at only one epoch at m. We also specically do not include the m observations in our discussion because they did not cover t he entire area and because most of the YSOs in Serpens are too closely clust ered to be distinguishable in the large beam of the m data. Harvey et al. discuss briey the extended m emission in this region and the four pointlike sources foun d at m. Figure shows the entire area mapped with all four IRAC bands and MIPS at and m and also indicates the locations of several areas mentioned in the text. In addition to this area of the Serpens cloud dened by relati vely high A V we also observed small ocloud regions around the molecular cloud with relatively low A Vin order to determine the background star and galaxy counts. The area of combined IRACMIPS coverage of these ocloud regions however was relativel y small and so these observations are not discussed further in this paper. As detailed below w e have used the much larger and deeper SWIRE Surace et al. survey to understand th e characteristics of the most serious background contaminants in our maps the extragal actic objects. . YSO Selection Paper I described a process for classifying infrared object s into several categories those whose energy distributions could be welltted as reddened stellar photospheres those that had a high likelihood of being background galaxies and thos e that were viable YSO candi Fig. . Three color image of the area mapped in Serpens. The c olor mapping is blue. m green. m and red m. The locations of Cluster A Core Cluster Cluster B Serpens GG Cluster and VV Ser are indicated. dates. We have rened this process by combining MIPS and IRAC data together as well as by producing an improved comparison catalog from the SWIRE Surace et al. survey trimmed as accurately as possible to the cd sensitivity lim its. As shown by the number counts versus Wainscoat models of the Galactic background t oward Serpens in paper I nearly all the sources observed in our survey are likely to be background stars. Because of the high sensitivity of IRAC channels and relative to both MASS and to IRAC channels and most of the more than sources extracted from o ur Serpens dataset do not have enough spectral coverage for any reliable classicati on algorithm. In particular only sources had enough spectral information from a combi nation of MASS and IRAC data to permit a test for consistency with a stellar photosph ereplusextinction model and nearly of these objects were classied as reddened st ellar photospheres. These normal stellar objects are not considered further in our discussio n and are not plotted on the various color and magnitude diagrams. The details of this classica tion process and the criteria for tting are described in detail by Evans et al. . In order to pursue the classication process for YSOs beyon d that described in Paper I we added one more step to the data processing described the re. This nal step was bandlling the catalog to obtain upper limits or low SN d etections of objects that were not found in the original source extraction processing. Thi s step is described in detail in the delivery documentation for the nal cd data delivery Evans et al. . In short though it involved xing the position of the source during a n extraction at the position of an existing catalog source and tting the image data at that xe d position for two parameters a background level and source ux assuming it was a point sou rce. For this processing step the uxes of all the originally extracted sources were subtr acted from the image rst. In the case of the data discussed in this paper the most important c ontribution of this bandlling step is to give us ux estimates for the YSO candidates and ext ragalactic candidates at m. Because our knowledge of the true PSF is imperfect and beca use the m PSF is so much larger than the IRAC ones it was also necessary to exa mine these results carefully to be sure a bandlled m ux was not simply the poorly subtracted wings of a nearby bright source that in fact completely masked the source be ing bandlled. For the purposes of this paper all upper limits are given as values. Three of the sources eventually selected as YSOs by the proc ess described below had m uxes that were obviously saturated. These are the objects in Table numbered and . For these three objects we derived the m ux from a t to the wings of the source proles rather than a t to the whole prole as is done by the standard cd source extraction. .. Constructing a Control Catalog from Deep Extragalacti c SWIRE Observations We use the IRAC and MIPS images of the ELAIS N eld obtained by the SWIRE team as a control eld for understanding the extragalactic popul ation with colors that mimic those of YSOs present in our Serpens eld. This SWIRE eld expecte d to contain no extinction from a molecular cloud and no YSOs has coverage by both IRAC a nd MIPS of . deg and has a limiting ux roughly a factor of four below that of ou r observations of Serpens. The analysis described below is designed to produce a resamp led version of the SWIRE eld as it would have been observed with the typical cd sensitivi ty and as if it were located behind a molecular cloud with the range of extinctions obser ved in Serpens. The process of simulating these eects is discussed in detail in the nal c d data delivery documentation Evans et al. but the steps are summarized here. To avoid eects that may result from dierences in data proce ssing the BCD images for this SWIRE eld were processed by our pipeline in exactly the same way as our own obser vations. Once a bandmerged catalog of SWIRE sources was cons tructed we rst simulated the reddening of sources that would occur if Serpens had been in the foreground of this eld. This reddening was accomplished by randomly applying extin ction to each SWIRE source according to the extinction prole of Serpens shown in Figu re . For example of SWIRE sources were randomly selected and visual extinction s in the range . AV. were applied of sources were extincted by extinctions in the range . AV. and so forth. The extinctions were applied to each of the infr ared bands according to the extinction law appropriate for molecular clouds and cores Huard et al. in prep.. Second we degraded the sensitivity of the reddened SWIRE ph otometry to match that of our Serpens observations. This was accomplished by match ing the detection rates as a function of magnitude in each of the bands. The completen ess limits of the Serpens observations are approximately . . . . . . . and . mag at J H K . . . . and respectively. Thus for each band all reddened SWIRE sources brighter than the completeness limit in Serpens wou ld be detectable by cdlike observations and are identied as such in the resampled SWIR E catalog. Most but not all sources fainter than the completeness limit will not be dete cted by cdlike observations. We randomly select which sources to identify as detections in a given band in such as way as to reproduce the empirically determined shape of the complete ness function. This resampling process is performed for each band resulting in those sourc es fainter than the completeness limits in some bands being detected or not detected with the s ame probabilities as those for similar sources in Serpens. The photometric uncertainties of all sources in the resampled catalog of reddened SWIRE sources are reassigned uncertai nties similar to those of Serpens sources with similar magnitudes. Finally each source in the resampled SWIRE catalog is recl assied based on its de graded photometry e.g. star YSOc GALc .... The ma gnitudes colors and classi cations of sources in this resampled SWIRE catalog are then directly comparable to those in our Serpens catalog and may be used to estimate the populat ion of extragalactic sources satisfying various color and magnitude criteria. At this le vel of the classication the terms YSOc and GALc imply candidate classication status. .. Classication Based on Color and Magnitude In Paper I we described a simple set of criteria that basicall y categorized all objects that were faint and red in several combinations of IRAC and MIPS co lors as likely to be galaxies after removal of normal reddened stars. In our new classi cation we have extended this concept to include the color and magnitude spaces in Figure together with several additional criteria to compute a proxy for the probability that a source is a YSO or a background galaxy. Figure shows a collection of three colormagnitude diagra ms and one colorcolor diagram used to classify the sources found in our . to m survey of the Serpens Cloud that had SN in all the Spitzer bands between and m and that were not classied as reddened stellar photospheres. In addition to the Serpens s ources shown in the left panels the comparable set of sources from the fullsensitivity SWI RE catalog are shown in the center panels and the sources remaining in the extincteds ensitivityresampled version of the SWIRE catalog described above are shown in the right pane ls. The exact details of our classication scheme are described in Appendix A. Basic ally we form the product of individual probabilities from each of the three colormagn itude diagrams in Figure and then use additional factors to modify that total probabili ty based on source properties such as its K . color whether it was found to be extende d in either of the shorter IRAC bands and whether its ux density is above or below some empirically determined limits in several critical bands. Table summarizes the cri teria used for this class separation. The cutos in each of the colormagnitude diagrams and the n al probability threshold to separate YSOs from extragalactic objects were chosen to provide a nearly complete elimination of all SWIRE objects from the YSO class and t o maximize the number of YSOs selected in Serpens consistent with visual inspect ion of the images to eliminate obvious extragalactic objects such as a previously uncata logued obvious spiral galaxy at RA h m .s Dec J . The cutos in colormagnitude space were constructed as smo oth exponentially de caying probabilities around the dashed lines in each of the t hree diagrams. Sources far Fig. . The distribution of visual extinctions found towar d the roughly sources classied as stars in our Serpens observations. below the lines were assigned a high probability of being ext ragalactic contamination with a smoothly decreasing probability to low levels well above t he lines. In the case of the versus . relation the probability dropped o rad ially away from the center of the elliptical segment shown in the gure. After inclusion of th ese three colormagnitude criteria we added the additional criteria listed in Table . These inc luded a factor dependent on the K . color Prob K. to reect the higher probability of a source being an extragalactic GALc contaminant if it is bluer in that col or a higher GALc probability for sources that are extended at either . or . m where our survey had the best sensitivity and highest spatial resolution a decrease in GALc proba bility for sources with a m ux density above mJy empirically determined from exam ination of the SWIRE data and identication as extragalactic for anysource fainter than .. Again we emphasize that these criteria are based only on the empirica l approach of trying to charac terize the SWIRE population in colormagnitude space as pre cisely as possible not on any kind of modeling of the energy distributions. Figure graphically shows the division between YSOs and li kely extragalactic contam inants. The number counts versus our probability are show n for both the Serpens cloud and for the resampled SWIRE catalog normalized to the Serpe ns area. This illustrates how cleanly the objects in the SWIRE catalog are identied by this probability criterion. In the Serpens sample there are clearly two wellseparated g roups of objects plus a tail of intermediate probability objects that we have mostly class ied as YSOs since no such tail is apparent in the SWIRE sample. Our choice of the exact cut between YSO and XGal in Figure is somewhat ar bitrary because of the low level tail of objects in Serpens in the area of logprobability .. Since the area of sky included in our SWIRE sample is mor e than six times as large as the mapped area of Serpens we chose our nal probability cut logP . to allow two objects from the full not resampled SWIRE catalo g into the YSO classica tion bin. Thus aside from the vagaries of smallnumber stat istics we expect of order extragalactic interlopers in our list of Serpens YSOs. The right panels in Figure which use the resampled version of the SWIRE catalog show that the eects of sensitivity and especially the extinction in Serpens make our cuto limits particularly conservative in terms of likelihood of misclassication. We examined all the YSO c andidates chosen with these criteria both in terms of the quality of the photometry and th eir appearance in the images. A signicant number candidates were discarded because of the poor quality of t he bandlling process at m due to contamination by a nearby brighter source or because of their appearance in the images. It is possible that a small number of these discarded candidates are in fact true YSOs in the Serpens Cloud. We a lso manually classied one source as YSO in Table that may be the exciting sourc e for an HHlike outow in Cluster B see also discussion of this region by Harvey et al. but which was not so classied because of its extended structure in the IRAC band s. Table lists the YSOs that resulted from this selection process. Another test of the success of our separation of background c ontaminants is to simply plot the locations of the YSOs and likely galaxies on the sky . Figure shows such a plot in addition to a plot of visual extinction discussed later. T here is clearly a very uniform distribution of background contaminants and a quite cluste red distribution of YSOs see further discussion in . There is one additional kind of contaminant that is likely to appear in our data at a relatively low level AGB stars. The ISO observations by fo r example van Loon et al. and Trams et al. show that the range of brightnesses of AGB stars in the LMC covers a span equivalent roughly to . with colors generally equivalent to ... Very compact protoplanetary nebulae are generally redder but even brighter at m see e.g. Hora et al. . For typical galactic AGB stars betwe en and kpc from the sun this would imply .. The ocloud elds when normalized to the same area as the Serpens data provide the best handle on the degree of con tamination from AGB stars in Paper I we saw one object classied as a YSO candidate in the ocloud panel of Figure with . . Therefore based on the ratio of areas mapped in Serpens ve rsus the ocloud observations we expect the number of AGB stars contaminati ng the YSO candidate list in the Serpens cloud to be of order a half dozen. As a further chec k we have examined the entire set of ocloud elds for such objects. In this combin ed area of . deg there are only such YSO candidates. Finally Mer n et al. hav e classied four AGB stars by their SpitzerIRS spectra in the Serpens cloud these are id entied in the diagrams of Figure by black open diamonds and obviously are not included in our nal list of highprobability YSOs. Statistically then it is possible that a couple of ou r brightest YSOs are in fact AGB stars. In fact Mer n et al. have obtained modest SN optical spectra of a number of our YSOs. They nd ve objects whose estimated extinction s eems inconsistent with their location in the Serpens cloud and which suggests they might b e background objects at much larger distances with modest circumstellar shells like AGB stars. We have indicated these ve objects in Table with a footnote b. It is also interesting to ask the reverse question to what ex tent have our criteria suc cessfully selected objects that were known YSOs from previ ous observations. Alcal a et al. have used the same criteria to search for YSOs in the c d data for Chamaeleon II. They conclude that all but one of the known YSOs in that re gion are identied. In we discuss the comparison of our results with several previ ous studies of Serpens that searched for YSOs. Our survey found counterparts to all the previously known objects in Fig. . Colormagnitude and colorcolor diagrams for the S erpens Cloud left full SWIRE center and trimmed SWIRE regions. The black dashed lines show the fuzzy color magnitude cuts that dene the YSO candidate criterion in the various colormagnitude spaces. The red dashed lines show hard limits fainter than w hich objects are excluded from the YSO category. Fig. . Plot of the number of sources versus probability of being a background contami nant for the Serpens cloud and for the trimmed SWIRE catalog described in the text. The vertical dashed line shows the separation chosen for YSOs v ersus extragalactic candidates. For both samples only sources with detections in all four IR AC bands are plotted to keep the number counts of contaminants on scale Fig. . Left panel image of the entire mapped area of Serpen s at . m with the positions of YSOs plotted with circles and likely extragalactic bac kground contaminants with aster isks center panel same image with YSOs of luminosity L Lplotted with boxes and higher luminosity YSOs plotted with circles right pan el contours of visual extinction Avat levels of magnitudes as derived from tting th e energy distributions of sources that were wellt as reddened stellar photospheres in our data set. our observed area that had SN in those studies but we did not classify many of them as YSOs because of the lack of signicant excess in the IRAC o r MIPS bands. Most of these were indeed suggested only as candidate YSOs by the au thors so we do not consider this fact to be a problem for our selection criteria. We again emphasize the fact that our selection criteria for youth are based solely on the presenc e of an infrared excess at some Spitzer wavelength. The total number of objects classied as YSOs in the IRACMI PS overlap area of the Serpens cloud is . From the statistics of our classicati on of the SWIRE data we expect of order of these are likely to be galaxies. On the other hand as we di scuss in some of the faint red objects in Figure below the dashed lin e may also be young sub stellar objects. For example we note the case of the young br own dwarf BDSer found by Lodieu et al. that was not selected by our criteria bec ause of its relative faintness. Of these were detected in at least the H and K sbands of the MASS survey at better than . The number of YSOs in each of the four classes of the system s uggested by Lada and extended by Greene et al. is Class I C lass Flat Class II and Class III using the ux densities available between and m. Because we require some infrared excess to be identied as a YSO the Class III ca ndidates were necessarily selected by some measurable excess typically at the longer w avelengths or m. An obvious corollary is that objects identied as young on the b asis of other indicators e.g. Xray emission lithium abundance but without excesses in the range of m are not selected with our criteria. .. YSOs Selected By MIPS Harvey et al. found YSO candidates in the entire ar ea mapped by MIPS at m in Serpens an area of . deg of these are outside the IRACMIPS overlap area and are listed in Table . We can make a comparison of thos e statistics with the YSO counts here in two ways. First in the area covered by both IRAC and MIPS there are objects that satisfy the criteria of Harvey et al. i.e. K s K s and m SN . Of these satisfy our more restrictive criteria in thi s study based on the combination of MASS IRAC and MIPS data or . We would classify the other as likely background galaxies. Secondly of the YSOs found in this study have sucient data to be classiable by the mips only crite ria above but only or actually meet the mipsonly YSO criteria. In other words objects have been classied as high quality YSOs in this paper in the MIPSIRAC overlap r egion that did not meet the criteria based only on MIPS and MASS data. If these ratio s can be extrapolated to the larger area covered only by MIPS then we would expect Har vey et al. to have missed or of the YSOs but to have included or t hat would not meet our combined IRACMIPS criteria. With these corrections we might have expected to nd YSOs in the entire . degarea covered by MIPS if we had matching IRAC observations. Finally in light of our earlier discussion o f AGB contaminants it is possible that of these YSOs would actually be found to be backgrou nd AGB stars. . Search for Variability The fact that our data were taken in two epochs separated by h ours or more gives us the opportunity to search for variability over that time s cale. Rebull et al. and Harvey et al. have performed similar tests for variab ility of the m emission from sources in the cd observations of Perseus and Serpens and fo und no reliable evidence for variability at that wavelength. There is however substan tial evidence for short term vari ability in the nearinfrared for YSOs. We therefore perf ormed a similar investigation in the two shortest IRAC bands . and . m. No clear evidence was found at the level of for any sources in the eld over the hour time scale of ou r multiepoch observations. . Comparison with Previous Studies of Serpens We have crosscorrelated our source catalog with those from previous studies of Serpens that searched for YSOs. We chose three studies that covered much of Cluster A at both near IR ISO and Xray wavelengths Eiroa Casali Kaas et a l. Preibisch and one recent ISO study of Cluster B Djupvik et al. . Table lists the sources from each of these previous studies and the bestmatching Spitzer sou rce from our complete catalog. In brief we nd good matches for essentially all the previou s IRselected YSOs that had SN in the earlier studies and which were included in our mapped area. In detail however a number of YSO candidates from the earlier studies were not classied as YSOs in our study. The reasons for this are dierent for the variou s catalogs. From the Xray catalog of Preibisch Preibisch in Cluster A we only i dentied of the Xray sources as YSOs on the basis of their infrared excesses. The Xray sources that were not identied as YSOs included both many objects that were well tted as reddened stellar photospheres sources and objects with some likely infr ared excess but too little to t our criteria aimed at eliminating extragalactic interlop ers. The situation with the infrared catalogs is somewhat dierent. Examining our nonmatches f rom the groundbased study of Eiroa Casali we nd that a large fraction of their YS Os are classied as such by our criteria but not all. From the ISO surveys Kaas et al. Djupvik et al. we typically identify as YSOs. The ones that we do not classify as such are ty pically those with low SN in the ISO observations or where the amount of infrared excess was not large enough to satisfy our test of whether the object could n ot be tted as an extincted stellar photosphere as described by Evans et al. . . Luminosities .. The YSO Luminosity Function in Serpens One of the most important physical parameters for any star is its mass. For pre mainsequence stars this is problematic because the deter mination of mass depends on the placement of the star on an HR diagram andthe use of model evolutionary tracks for which there is signicant uncertainty at the level of at least a fac tor of . in the literature Hillenbrand White Stassun et al. . For young st ars in a cluster a poor but still useful proxy for mass is the stellar luminosity since i t is possible that most of the stars have formed more or less simultaneously. With all these cave ats in mind we display in Figure the histogram of total luminosities for the YSOs found in Serpens in our survey with the assumed distance of pc. We remind the reader that thes e objects were selected specically on the basis of infrared excess emission so thi s list is limited to YSOs that show substantial IR excess at least somewhere in the range of . m. For example as we discussed in a comparison of our list of YSOs with the list of Xray sour ces in Cluster A Preibisch showed that more than half the Xray source s were not classied as YSOs by our infrared excess criteria. In some sense then it is lik ely that the IRselected and x rayselected samples are complementary in selecting less evolved and moreevolved samples of YSOs respectively. The luminosity function of our IRex cessdened YSO sample peaks at roughly Land drops o steeply below L. This is interestingly equal to the luminosity of objects at the hydrogenburning limit o f . M in the models of Barae et al. for objects with ages of Myr a common estimate for the age of the Serpens star forming event Kaas et al. Djupvik et al. . Of course an important question to ask is to what extent this luminosity distributi on in Figure is inuenced by selection eects. We can estimate the selection eects in our sample from the st atistics in the SWIRE samples discussed above. The completeness limits of the ful l catalog are nearly magnitudes fainter than the trimmed version so we assume for simplicit y that the full catalog is complete down to the faintest magnitudes of interest for thi s test in the cd Serpens data set. Figure shows the number counts as a function of lumino sity all sources assumed to be at pc for three versions of our cdprocessed SWIRE catalog the fulldepth catalog the catalog cuto with cd sensitivity limits b ut without added extinction and the catalog corrected for both cd sensitivity levels and extinction in the Serpens cloud. The ratio of the second to the rst version serves as a good pro xy for a completeness function since it includes the eects of cd sensitivity only. The low er panel of Figure then shows this ratio as our estimate of the completeness function at th e range of luminosities of Serpens YSOs observed in Figure . In Figure then we also indicat e how the YSO luminosity function might be adjusted to account for this estimate of ou r survey completeness with an assumed completeness of at the bright end. Although su bstantial adjustments must be made to the number counts at fainter luminosities the gen eral conclusion remains intact that the luminosity function peaks around fewLand drops to both lower and higher luminosities. Interestingly if our completeness e stimates are valid there may still be a substantial population of IR excess sources down to lumino sities of Las was already suggested in Paper I. For example as noted earlier in . the young brown dwarf found by Lodieu et al. was not selected as a YSO with our criteri a because it was faint enough that its colors placed it into the color and magnitude ranges where extragalactic objects begin to be prominent. .. The Lowest Luminosity Sources There are YSOs with total luminosities m less than L without any correction for selection eects in either our observati ons or our selection criteria. Figure presented in . shows the spatial distribution of the low L L and high LL luminosity YSOs in Serpens. There does not appear to be any signicant dierence between these two distributions. Likewise Figur e shows the distribution of spec tral slopes for the low luminosity sample relative to two higher lumino sity samples and Table lists the average and standard deviation for the spec tral slopes for three luminos ity samples. Again there is no obvious dierence in the dist ributions within the statistical uncertainties of the samples. See also discussion in .. These two facts suggest that the mechanisms and timing of formation of these two luminosi ty groups may not be very dierent. Finally Figure shows the distribution of extin ction for stars nearby each YSO. For this analysis we selected all objects within of each Y SO that were classied as star by the process described earlier. We averaged the tted exti nction values for these stars the number of stars contributing to the average ranged from to . This gure shows that the lower luminosity YSOs have at least as much typical exti nction as the higher luminos ity ones a fact that would be unlikely if they were misclass ied background extragalactic objects. Fig. . Luminosity function for Serpens YSOs solid and e stimate of correction for completeness eects dashed. Fig. . Upper panel number counts for the full SWIRE catalo g as processed through the cd pipeline for objects detected in all four IRAC bands v ersus those for the trimmed version of the catalog with completeness limits for each ind ividual band comparable to those for cd. Lower panel the ratio of the two number counts i.e. completeness factor. Fig. . Histogram of distribution of spectral slopes alp ha for three luminosity classes of YSOs. Fig. . Histogram of distribution of average extinction fo r stars within of each YSO for high and low luminosity YSOs above or below L. . Spatial Distribution of Star Formation We have already noted in that the Serpens starforming region has been identied as one displaying strong evidence of clustering of the young est objects. We also showed in Figure that the spatial distribution of our high quality YSO candidates was highly clustered. A number of authors have attempted to quantify th e degree of clustering as a function of spatial scale using the twopoint correlation function Johnstone et al. Enoch et al. Simon Gomez Lada Bate Clarke McCaughrean . Typical results have found a steep slope don small spatial scales implying a rapid decrease in clustering on scales out to AU and a substantially shallower slope d.beyond that Simon Gomez Lada . Figure shows t he twopoint correlation function W for the YSOs in our Serpens catalog and the sample of object s classied as extragalactic background sources. The Serpe ns samples are divided into two groups those with spectral slopes that place them in the Class I or Flat categories of Greene et al. and those whose slopes imply Class II or III. Although our range of good sampling only extends down to AU equivalent to our data suggest that the slope for separations under AU is of order . and drops steeply for the more embedded and likely youngest Class I and FlatSED objects be yond AU. The nominally more evolved objects in Class II and III exhibit a lower leve l of clustering and more uniform slope in the twopoint correlation function. These results are consistent with the appearance of the source distributions as shown for example in Figure of Paper I. As shown in Figure the slope and magnitude of the correlation for our sample of background extra galactic objects is consistent with that found by for examp le Maddox et al. for a bright sample of galaxies. The total surface density of young stellar objects in a clust er is an indicator of the richness of star formation in the cluster. Allen et al. have computed surface densities for YSOs identied by infrared excess in a sample of young clusters. They nd typical peak surface densities of pcand average values of order pc. The peak surface density in Cluster A of our YSOs identied by IR excess is comparable to these of order pc and a factor of about two less in Cluster B. The average value s are about a factor of less than the peak in both clusters. In particular if we dene the cluster edges by theAv contour for comparison with other cd clusters we obtai n the values in Table for the number of stars per solid angle and per square parsec. We have compared the values for clusters A and B with those for the rest of the cloud and for the total cloud surveyed. The surface densities of YSOs are to times higher in the c lusters as in the rest of the cloud. As shown by Allen et al. Cluster A in Serpens is particularly striking in terms of the contrast between the peak surface density and how quic kly within pc the density drops to very low values fewpc. In terms of volume density though even Cluster A has a substantially lower volume density of star formation than such rich clusters as the Trapezium pc or Mon R pc Elmegreen et al. . Figure also shows the spatial distribution of visual extin ction in the cloud as derived from our data. These extinction values were derived from the combination of MASS and Spitzer data for sources that were well t as reddened stella r photospheres as described in detail by Evans et al. . As already noted in our previou s studies of the IRAC data alone Harvey et. al. and the MIPS data alone Harvey et al. there is clearly a striking correspondence between the areas of high extinct ion and the densest clusters of YSOs particularly those containing Class I and Class Flat sources. . Disk Properties The properties of the circumstellar dust surrounding young stars can be estimated from the overall energy distributions of the objects in a variety of ways. These properties include the overall amount of dust the density distribution as a fun ction of radial distance from the central star the morphology of the circumstellar disks which probably represent the conguration of many of these circumstellar distributions and to some extent the degree of evolution of the dust from typical interstellar dust to la rger and more chemically evolved grains likely to represent some stage in the formation of pla netary systems. We discuss several approaches to classifying the dust emission in this section beginning with the use of infrared colors. .. Colorcolor diagrams Numerous authors have shown how combinations of colors in th e infrared can provide signicant diagnostic information on the conguration and total amount of circumstellar material around young stars. Whitney et al. modelled a wide range of disk and envelope congurations and computed their appearance in a n umber of infrared colorcolor and colormagnitude diagrams particularly relevant to Spi tzers wavelength range. Similarly Allen et al. have published IRAC colorcolor diagram s for another set of models of objects with circumstellar disks andor envelopes. Recent ly Robitaille et al. have computed a very large grid of models to extend the prediction s from those of Whitney et al. to a much larger parameter space. Observationally L ada et al. have used IRAC and MIPS colors from Spitzer observations to classify t he optical thickness of disks around premainsequence stars in IC using the terms a nemic disks and thick disks Fig. . Left panel the twopoint correlation function W for Serpens. The dotted histogram is for sources identied as Class I and Flat SED o bjects i.e. .. The solid histogram is for the Class IIIII objects i.e. .. The dashed lines show several possible power law slopes for the portions of the YSO curves. Right panel the dashed histogram is for the objects classied as likely background galaxies with SN in all four IRAC bands. The dashdot line shows the slope and amplitude f ound by Maddox et al. for the bright end of the extragalactic population which is a quite good t to our estimate of the background contamination in our sample. to point to objects roughly in the Class III and Class II porti ons of the ubiquitous Class System Lada Greene et al. . Figure shows three colorcolor diagrams and one colorma gnitude diagram for the Serpens YSOs compared to the density of models from Robi taille et al. for a model cluster at the distance of Serpens with brightnesses l imited to those appropriate for our sensitivity levels. For two of the diagrams the gure als o indicates the approximate areas where most of the models fall for the three physical sta ges I II and III described by Robitaille et al. that roughly correspond to the ob servational classes IFlat II and III. These diagrams display rst of all that YSOs c ome in a wide range of colors and brightnesses large areas of all the diagrams are occupi ed. In a general way we nd objects located in these diagrams where the models of Whitne y et al. Allen et al. and Robitaille et al. would predict for prem ainsequence stars with a range of evolutionary states as well as general agreement with the locations of young objects found in IC by Lada et al. . For example consistent with o ur nding in paper I that the bulk of the YSOs are class II objects we see a strong concent ration in the area around . . . ... where both Allen et al. and Whit ney et al. predict such sources should be located. Additionally there is structure in the . vs. .. color magnitude diagram for the distribution of Serpens YSOs that is also ev ident in the density of models of Robitaille et al. . There are however some intere sting dierences. The Stage II area from Robitaille et al. includes a smaller fracti on of our nominal Class II objects than might be expected. There is also a larger number of very r ed objects in several of the diagrams than is predicted by the density of models in those a reas considering that the faintest grey levels correspond to a probability equal to of the maximum probability. Some of this may be due to eects of reddening but it suggests that the models may also need some renement despite their rough agreement with the distribution of observed colors. These data can also be examined to see if there is any correlat ion between luminosity and infrared excess e.g. the . vs. .. color ma gnitude diagram. For example if higher luminosity young objects had higher levels of multip licity e.g. Lada then it is possible this would be manifested in less massive disks with perhaps large inner holes. Figure shows no such correlation in fact if anything there appe ars to be a lack of relatively blue colors for the brightest objects. Figure that displays the distribution of spectral slopes and the accompanying Table also show no measurable eect withi n the scatter for a dependence of spectral slope on luminosity. Fig. . Colorcolor and colormagnitude plots of the S erpens YSOs compared with the distributions from models of Robitaille et al. . T he symbols are for the three dierent luminosity groups discussed in the text open diam onds L L light lled circles . L L L plus signs L . L . The model data were those for their model cluster with a distance of pc for Serpens and with t he cd completeness limits. Also shown are the rough areas from Robitaille et al. o ccupied by mainly stage I II and III models. .. Spectral Energy Distribution Modeling In order to go beyond the general conclusions possible from c olorcolor and color magnitude plots we have modelled the large fraction of our s ources for which enough data are available to characterize them as likely starplusdis k objects. For this analysis we have selected all Class II and Class III YSOs. We expect these obj ects to have a reddened photo sphere plus an infrared excess coming from the circumstella r material most likely in a disk conguration. For completeness we show without modeling the SEDs of the remaining YSOs. Figures to show the SEDs of all Class I Class Flat Class II and Class III sources. The open dots are the observed uxes and generally i nclude MASS J H and K uxes followed by the four IRAC uxes at . . . and . m and by the MIPS uxes at and m when available. For the Class IIs and IIIs we characterize the emission from the disk by comparing the energy distribution with that of a lowmass star. For this we have computed the extinction from the JK colors assuming a K underlying star and then we have dereddened the observed uxes with the interstellar extinction law of Weingartner Draine with R v . to t the dereddened SEDs to a NEXTGEN Hauschildt et al. model of a K stellar photosphere. I n the plots the lled dots are the dereddened uxes and the grey line is the photospheric em ission from the star. Each SED is labeled with the identication number in Table . The p arameters of the model ts are listed in Tables and . Two main assumptions are used in this approach. The rst is th at the star is a lowmass star this is reasonable given the fact that the luminosity f unction discussed earlier peaks at LfewL. In addition Oliveira et al. have found that of the YSOs they observed out of our sample had spectral types of K or M. Th e second assumption is that there is no substantial excess in the near infrared band s where we consider all ux to be photospheric. This assumption is obviously only correct for those stars in the sample without strong ongoing disk accretion. Cieza et al. have demonstrated that near IR excesses as short as Jband can be seen in some actively acc reting T Tauri stars and they give an observed range of Jband excesses of . . mag for their sample of sources in Taurus. The eect of this excess on the computed parameter s implies that the stellar luminosities for the Class II objects are upper limits and th erefore the disk luminosities are lower limits. More specically neglecting an excess ux in the Jband of . magnitude in one object would reduce its LdiskLstar ratio by and modi fy the disk emission SED diminishing its excess mostly at the shorter wavelengths. T hat would only happen however to the fraction of objects that are strongly accreting. Oliv eira et al. found strong Hemission indicative of active accretion in only out of S erpens YSOs observed. We ran a test removing these objects from the nal statistics an d this did not change the overall picture. The dashed line in the SED plots is the median SED of T Tauri sta rs in Taurus Hartmann et al. normalized to the dereddened Jband ux of our SEDs. It repre sents the typical SED of an optically thick accreting disk ar ound a Classical T Tauri star and is shown here to allow a qualitative estimation of the pre sence of disk evolution and dust settling. Based on similarity to this median SED we de ne as Tan SED which is identical to it within the errors as L an SED with lower uxes at some wavelengths and H an object with larger uxes than the median T Tauri SED. We hav e labeled the objects with these codes and use them to interpret the state of disk evolut ion. We interpret the Ltype objects as thin disks which could perhaps result from dust gr ain growth and settling to the midplane similar to the anemic disks in Lada et al. . Objects and are good examples of Ttype objects numbers and are Ltype star s and number is a Htype object. Also we have labeled as LUobjects that have photospheric uxes up to around m but then a sudden jump at longer wavelengths to the levels of a TTauri disk. We believe these objects may have large inner holes in their still optic ally thick disks number is one example of these. Out of the sources in the sample that are Class II or Class I II are T type so equivalent to a classical T Tauri star are Ltype so show evidence of some degree of disk evolution and nally show large r uxes than the median SED of Taurus. This latter category is generally the result o f imperfect tting to the stellar photosphere due to lack of nearIR data and will not be consid ered further. The numbers above indicate that there are many young stars in Serpens with disks that are virtually identical to those in Taurus. This points to a very similar origin of the disk structure across star forming regions. Within the unce rtainties in our modeling process discussed above however we see a majority of Ltype object s in Serpens. This suggests that the disks in Serpens may be generally more evol ved or attened that those in Taurus. Also interestingly the number of LUtype objects or those with large inner holes amounts to of the Ltype objects and only of the tota l YSO sample including Class I and F sources. This very small incidence indicates t hat either the process producing these large inner holes is a very fast transitional phase in t he disk evolution or that only a small number of systems undergo that phase. We examine this issue below. In order to put rmer limits on these numbers it will be necessary to get o ptical spectral types for the stars and optical photometry in order to produce more accura te photospherediskextinction models. The SEDs also allow a rough study of the disk properties acros s the surveyed area. For this purpose we integrated the stellar and total uxes to cal culate a ratio between the stellar and the disk uxes. The corresponding distribution is shown in Figure . Again the solid line is the whole Class II and III sample and the dotted line co rresponds to the Ttype SEDs. To guide the eye we have marked the approximate regimes of th ese ratios measured in debris disks LdiskLstar . passive disks . LdiskLstar . Kenyon Hartmann and accretion disks LdiskLstar . respectively. The gure illustrates well the large variety of disk evolutionary phases that we observe in Serpens as well as the large majority of massive accreting disks in the region. In order to study the disk evolution in the cloud there is nee d for a better charac terization of the full sample with optical spectroscopy. Th at work is in progress and will be published elsewhere. Here we explore further the shapes o f the SEDs to test another evolutionary diagnostic of the disk status. We have found th at the more commonly used evolutionary metrics e.g. spectral slope bolometric temperature Tbol or the Class sys tem discussed earlier do not seem to capture the full range of phenomena apparent in our distribution of SEDs for young stellar objects. We theref ore use excessandexcess two newsecondorder SED parameters presented in Cieza et al. that will be d iscussed in more detail in a separate paper. In short excessis the last wavelength where the observed ux is photospheric and excessis the slope computed as dlogFdlog starting from excess. The rst parameter gives us an indication of how close the ci rcumstellar matter is to the central object and the latter one a measure of how optic ally thick it is. Given the assumptions above for the tting process our values are upp er limits for excess and corre spondingly lower limits for excessfor the Class IIs. We assume good stellar ts for the Class III sources. Figure shows both values for a sample of Classical T Tauri s tars CTTs from Cieza et al. weaklined T Tauri stars wTTs from Cie za et al. debris disks from Chen et al. and our sample of YSOs in Serpens. Cie za et al. found that excessis well correlated with evolutionary phase and also as seen in Figure that is observed over wider ranges for later evolutionary phases. T his suggests a large range of possible evolutionary paths for circumstellar disks. Obje cts could either evolve to the lower right side of the diagram which could be interpreted as a sig n of dust grain growth and settling to the disk midplane they could also move to the ri ght and up from creation of a large inner hole in their disks while retaining a massive out er disk and also as this diagram shows all intermediate pathways in between both extremes. Fig. . Spectral Energy Distributions of the Class I sourc es in the sample. The open dots signal the observed uxes from Jband to MIPS when av ailable. The label gives the index in Table . Fig. . Spectral Energy Distributions of the Class I sourc es in the sample continued. Symbols as in Figure . Fig. . Spectral Energy Distributions of the Flat sources in the sample. Symbols as in Figure . Fig. . Spectral Energy Distributions SED of the Class I I sources in the sample. The open and solid dots are the observed and dereddened uxes res pectively. The grey line is the stellar model of a K star and the dashed line is the median SED of the TTauri stars in Taurus by Hartmann et al. normalized to the dereddene d Jband ux for comparison. See text for more information. Fig. . Spectral Energy Distributions of the Class II sour ces in the sample continued. Fig. . Spectral Energy Distributions of the Class II sour ces in the sample continued. Fig. . Spectral Energy Distributions of the Class II sour ces in the sample continued. Fig. . Spectral Energy Distributions of the Class III sou rces in the sample. Fig. . Spectral Energy Distributions of the Class III sou rces in the sample. . Selected Sources .. The Coldest Objects Table lists the YSOs that display the coldest energy dis tributions. These are the objects whose ratio of FF. Six of these are in Cluster A the core and four in Cluster B. Two are in a small grouping about .northeast of Cluster B and the remaining three appear as isolated cold objects though in areas with o ther moderately red objects. All of these except for two of the isolated cold objects IDs and are associated with dense clumps of millimeter emission as seen by Enoch et a l. . As discussed in the following section two in Cluster A and one in Cluster B are as sociated with high velocity outows. As has been noted already by Padgett et al. an d Rebull et al. it is striking how many of these coldest most obscured YSOs are l ocated in compact clusters together with objects that are substantially more evolved i n the nominal system of classes e.g. Class II and III. .. Outow Sources A number of recent Spitzer studies have found that highvelo city shocked outows from young stars are visible in IRAC images typically strongest at .m NoreigaCrespo et al. . We have examined our images for such outows as well as for correspondance with the lists of published HH objects in the region Ziener Eisloe l . Table summarizes the results of this eort. Two strong obvious jetlike feat ures are seen in Cluster A and one in Cluster B. In addition as shown in Table we nd smal l extended features at the positions of most of the known HH objects in Serpens that were within our covered area. The two jets in Cluster A appear to originate from two of the mos t deeply embedded objects in this cluster that are associated with the submm sources SMM and SMM Testi Sargent . Both these outows are aligned roughly in the NWSE di rection and are visible on both sides of the central m likely exciting sources. In Cluster B there is one obvious jetlike feature extending mostly south of YSO . There is also probably faint emission visible to the north of the embedded source as well. Harvey et al. discuss the Cluster B jet and several nearby Spitzer sources in more deta il. Figures and show color images of Clusters A and B with the color tables chose n to make these jets most visible. In addition to the optical HH objects in the Serpens Clouds there are a number of highvelocity molecular outows that have been mapped in Cluster A Davis et al. . These maps present a confusing picture of outows and becau se of the relatively larger beamwidth of the mm observations and close packing of infrar ed sources in this cluster it is Fig. . Distribution of disk to star luminosity ratios. Th e solid and dashed lines are the total sample and T Taurilike sample of SEDs respectively. Also marked are the typical ranges of L diskLstarratios for debris disks passive irradiated disks and accre tion disks. The gure indicates that objects of all three evolutionary stag es are found in Serpens with a predominance of young accreting T Tauritype stars. Fig. . Distribution of excess slopes excesswith respect to the wavelength at which the infrared excess begins turnofor the sample of wTTs solid dots a sample of cTTs in Lupus from Cieza et al. the median SED of cTTs in Tauru s from DAlessio et al. in asterisks marked as D and a sample of debris di sks from Chen et al. in diamonds. The arrows represent the limits for the class II ob jects in Serpens and the triangles the Class III sources. The diagram shows a much larger spread in inner disk morphologies in the more evolved objects than in the least evolved ones. Th e Serpens objects follow the previously observed trend. very dicult to associate the radio outows unequivocally w ith particular Spitzer sources. .. Other Objects Horrobin Casali Eiroa reported on the disappearan ce of a bright nearinfrared source in Serpens from the earlier study of EC. Table show s that we also see no obvious source at the position of EC other than a low SN single band detection of a source moderately distant from the nominal position. Interesting ly though this area marked in Figure appears to contain several small knots of emission that may represent shocked gas. For example there are two small knots visible in our . and .m images that have no . or m counterparts and therefore not classied as YSOs. Thes e two knots at RA . Dec J are only south of the position of EC. Therefore it is possible that the original source was a small clump of ex cited gas that has moved or dissipated since the original study of EC and perhaps th ese Spitzer knots are related to that earlier source in some way. . Overall Results on Star Formation The overall picture of star formation in Serpens is summariz ed in Table . As noted earlier the surface density of young stars is much higher in Clusters A and B than in the rest of the cloud by factors of to . On the other hand the majority of YSOs arenotin the clusters but in the rest of the cloud. If we assume a mea n mass for the stars of . M and assume that star formation has been proceeding for Myr we can estimate the rate at which the clusters and the whole cloud are convert ing mass into stars. These values are also given in Table . The Serpens cloud that we hav e surveyed is turning nearly M into stars per Myr. The rates for the clusters are probably un derestimates because they are probably younger than Myr a typical duration for t he Class II SED. Of course a signicant number of the older objects outside the clusters may have in fact formed in these or earlier clusters. A km srandom motion of a YSO relative to its birthplace results in pc of movement in yr or nearly degree at the distance of Serpens. The distribution of YSOs over class supports the younger age for the clusters than for star formation in general in Serpens. While the ratio of the n umber of Class I and Flat spectrum sources to the number of Class II and Class III sourc es is . for the whole cloud similar to other clouds surveyed by cd Evans et al. in prep . the same ratio is . for Cluster A and . for Cluster B. These high ratios strongly su ggest that Cluster A is too Fig. . Threecolor image of the Cluster A area of Serpens. The color coding is blue. m green. m and red m. Some of the more obvious objects that are likely to be jets are marked by arrows. The region of the disappearin g source of Eiroa Casali is circled. Fig. . Threecolor image of the Cluster B area of Serpens a s for Figure . young for most YSOs to have reached the Class II stage. In cont rast this ratio is . for the rest of the cloud outside the clusters which is strongl y dominated by Class II and Class III objects. . Summary We have identied a highcondence set of YSOs in Serpen s by a set of criteria based on comparison with data from the Spitzer SWIRE Legacy p rogram. This is a large enough number that we can draw important statistical conclu sions about various properties of this set. If we assume that the Class System of Lada and Greene et al. represents an evolutionary sequence then the relative num bers of YSOs found in each of the rst three classes I at and II suggests that the Clas s II phase lasts substantially longer than the combined total of the Class I and Flat phase s based on the overall cloud statistics. The clusters however show more YSOs in the Cla ss I and Flat phases than in Class II indicating that they are very young. The majorit y of YSOs mostly Class II are outside the clusters and probably represent a somewhat o lder epoch of star formation compared to the intense star formation now going on in the clu sters. The surface density of YSOs in the clusters exceeds that of the rest of the cloud by fa ctors of to Table . The luminosity function for the Serpens YSOs is populated d own to luminosities of L. It may extend even lower but our ability to distinguish low luminosity YSOs is severely restricted by the large population of backgroun d galaxies at these ux levels. The lower luminosity YSOs L L exhibit a similar spatial distribution and SED slope distribution to those of their higher luminosity coun terparts. This is consistent with the conclusion that they have formed in similar ways. . Acknowledgments Support for this work part of the Spitzer Legacy Science Pro gram was provided by NASA through contracts and issue d by the Jet Propulsion Lab oratory California Institute of Technology under NASA co ntract . Astrochemistry in Leiden is supported by a NWO Spinoza grant and a NOVA grant. B. M. thanks the Fundaci on Ram on Areces for nancial support. This publication makes use of data products from the Two Micron All Sky Survey which is a joint project of the Univ ersity of Massachusetts and the Infrared Processing and Analysis CenterCaliforni a Institute of Technology funded by NASA and the National Science Foundation. We also acknowl edge extensive use of the SIMBAD data base. A. YSO Selection Process The procedure we use to select YSOs and deselect extragal actic background sources is based on the colormagnitude diagrams shown in Figure . W e construct probability functions for each of the three colormagnitude diagrams ba sed on where a source falls relative to the black dashed lines in each diagram. These three proba bilities are multiplied and then additional adjustments to the probability are made based on several additional properties of the source uxes and whether or not they were found to be lar ger than pointlike in the source extraction process. In the . vs. .. color magnitude diagram the pr obability function is Pii . exp. .M.D where D . for M.M.. . for .M.M.. and object was found to be pointlike in all IRAC bands . for .M.M.. and object was found to be extended at . or . m . forM.M.. In the vs. . color magnitude diagram the prob ability function is PimexpMM.. M andPimis set to a minimum of .. In the vs. .. color magnitude diagram the pro bability function is Pim . expM.M .M. andPimis set to a minimum of . The combined probability is then PtotPiiPimPim Additionally the following factors inuence modication s toPtot PtotK. Ptot for sources that are extended at . or . m Ptot . where i.e. assumed GALc Ptot. where F mJy and source detected at . and m Based on the distribution of Ptotshown in Figure we chose the dividing line between YSOs and extragalactic sources to be logPtot .. Table . YSO vs. XGal Discrimination Criteria Criterion Contaminant Probability K . Prob K. . for .. . Smooth increase for . . . for . .. . Extended Smooth increase for . . . for . .. . Pointlike Smooth increase for . . . for . .. Smooth increase for . . ... . Smooth increase for values .... Smooth increase for values for all colors probability for . Extended at . or . m Twice as likely to be Xgal F Xgal prob . for F mJy Table . YSOs in Serpens ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . b . . b . . . . . . . . CDF . . . . . . . . . . . . . . . . . . . . . . . . CoKu SerG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . b D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . IRAS . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . VV Ser . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DD . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . D . . . . . . . . . . D D . . . . . . . . . . CoKu SerG . . . . . . . . . . . . . . . . CoKu SerG CoKu SerG . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . IRAS . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . b . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . b D . . . . . . . . K . . . . . . . . . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . . . K . . . . . . . . . . K CDF . . . . . . . . . . . . . . K . . . . . . . . . . D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . K . . . . . . . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . . . . . . . K . . . . . . . . . . . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . IRAS EC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . K . . . . . . . . EC . . . . . . . . . . OO Ser . . . . V Ser . . . . . . EC . . . . . . . . . . . . . . Ka . . . . . . . . EC . . . . . . . . . . . . . . . . . . K . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . V Ser . . . . EC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ETC . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . EC . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . IRAS . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy IRAS . . . . . . . . . . EC . . . . . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . EC . . . . . . . . . . CoKu SerG . . . . EC . . . . . . . . . . . . EC . . . . . . . . EC K . . . . . . . . . . EC . . . . . . . . . . EC EC . . . . . . . . . . EC EC . . . . . . . . . . EC . . . . K . . . . . . . . . . HH . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . EC . . . . . . . . HH . . . . . . . . . . K . . K . . . . . . . . . . . . . . EC . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . GCNM . . . . . . . . . . EC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . EC EC . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . EC . . . . . . . . . . EC . . . . . . . . . . Table Continued ID NamePosition Prev. Namea.m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . K . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . aSource names from SIMBAD including numbers from the follow ing catalogs EC Eiroa Casali D Djupvik et al. K Kaas et al. . bMay be AGB star based on Avderived from optical spectrum. Table . YSO Candidates in Serpens Without Band IRAC Obser vations ID NamePosition Prev. Name . m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy .. .. .. IRAC .. IRAS .. .. IRAS IRAS .. IRAS IRAS . . .. .. IRAS . . . . .. .. .. . . .. .. .. . . IRAS .. .. .. . . Table Continued ID NamePosition Prev. Name . m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy .. .. .. . . . . GSC .. .. . . .. .. IRAS IRAS .. .. . . .. .. .. .. .. HD .. .. .. .. .. .. Table Continued ID NamePosition Prev. Name . m . m . m . m . m . m SSTcdJ... mJy mJy mJy mJy mJy mJy .. .. .. Table . Matching Spitzer SourcesFluxes For Previously Id entied IR Sources In Serpens SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . . D . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . D . . . . . . . . . D . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . D D . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . K .. D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . K .. K .. D . . . . . . . . . D . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . K .. D . . . . . . . . . D . . . . . . . . D . . . . . . . . . D . . . . . . D . . . . . . . . . K .. D . . . . . . . . D . . . . . . . . . K .. D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . D . . . . . . . . . . D . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . D D . . . . . . . . D . . . . . . . . . . D . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . K .. D . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . K .. K . . D . . . . . . . . . . D D . . . . . . . . . . D . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D D . . . . . . . . . . D . . . . . . . . . . D . . . . K . . . . . . . . . . K . . . . . . . . . . K . . . . . . D P . . . . . . . . K . . . . . . . . K . . . . . . . . . . D . . . . . . . . . D . . D . . . . . . . . . . D . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . D . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . . . . . . . . . D . . . . . . . . . K . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . D . . D . . . . . . . . . D . . . . . . . . . . K . . . . . . . . . . D . . K . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . D . . . . . . . . . K . . . . . . . . . . D . . . . . . . . . . D . . . . . . D . . . . . . . . . . D . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . D . . . . . . . . . . K . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . K . . . . K . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . K . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . D . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . K . . . . . . . . D . . . . . . . . . D . . . . . . . . . P . . . . . . . . . . D D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . P . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . D . . . . . . D . . . . . . . . . . K . . . . . . D . . . . . . . . . . D . . . . . . . . . P . . . . . . . K . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . K . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . K . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . K . . . . . . . . K . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . . . K . . . . . . . . . . D . . . . . . . . . . K . . . . . . . . . P . . . . . . . . . K . . . . . . . . . . K . . K D . . . . . . . . . K . . . . . . . . . . P . . . . . . . . . K . . . . . . D . . . . . . . . . D . . . . . . . . . . P . . . . . . . . . P . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . P . . . . . . . . . . D . . . . . . . . . P . . . . . . . . . . D . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy D . . . . . . . . D . . . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . D . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . . D . . . . . . . . . K . . K . . . . K . . . . . . K . . . . . . D . . . . . . . . . . D . . . . . . . D . . . . . . . . . . P K . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . P K . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . . . . . . . . . K K EC . . . . . . . . . . K . . . . . . . . . K . . . . K EC . . . . . . . . . EC . . . . . . . . . K EC . . . . . . . . . K . . . . . . . . . K EC . . . . . . . . . . P . . . . . . . . . . K K . . . . . . . . K EC . . . . . . . . . . K . . . . . . . . K . . . . . . . . . . K . . . . EC . . . . . . . . . K . . . . . . K EC . . . . Ka EC . . . . . . . . K . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy Kb . . . . . . . K . . . . . . . . . . K . . . . K . . . . . . . . . . K . . . . . . . . P K EC . . . . K EC . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . K . . . . . . . . . K . . . . . . . . K EC . . . . . . . . . K . . . . . . K . . . . . . . . . . EC . . . . . . . . . . K . . . . . . . . . K . . . . . . . . . . P K EC . . . . . . . . . . K EC . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . . K EC . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . . . . . . . . K EC . . . . . . . . . . P . . . . . . . . . P K EC . . . . K . . P K . . . . . . P . . . . . . . . . . EC . . . . . . . . . EC . . . . . . . K EC . . . . . . . . . . K EC . . . . . . . . . . K . . . . . . . . . K EC EC . . . . . . . . K EC . . . . . . . . . . P EC . . . . . . . . K . . . . . . . . K . . . . . . . . . . K EC . . P . . . . . . ECP K EC Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy P K EC . . . . . . . . . . K EC . . . . . . . . . . P K EC K EC . . . . . . . . . . EC P K EC K . . . . . . . . . . K EC . . . . . . . . . . EC . . . . . . . . . K EC . . . . K . . . . . . . . . . P K EC K . . K . . K . . . . EC . . . . . . . . . . K . . . . . . . . . . K . . . . . . K EC . P K EC . . . . . . . . . . EC . . . . . . . . . K EC . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy P . . . . . . . . . K . . . . . . . . K EC . . . . . . . . K EC EC . . . . . . . . P K EC . . . . . . . . EC . . . . . . . . . . EC . . . . . . . . . K . . . K . . . . . . . . . EC . . . . . . . . . P . . . . . . . . . . EC . . . . . . . . . . EC . . . . . . . . . . EC EC . . . . . . . . . P K . . . . . . . . . . P K . . . . . . . . . . P . . . . . . . . . P K . . . . . . . . P . . . . . . . . . K . . . . . . K . . . . . . . . . . Table Continued SourceaSpitzer . m . m . m . m m m SSTcdJ... mJy mJy mJy mJy mJy mJy K . . . . . . . . K . . . . K . . . . . . . . K . . . . . . . . . . K . . P . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . K . . . . . . K . . . . . . . . . . K . . . . . . . . . . K . . . . . . . . . . P . . . . . . . . P . . . . . . . . . P . . . . . . . . . . P . . . . . . . . . . P . . . . . . . . P . . . . . . . . . P . . . . . . . . P . . . . . . . . P . . . . . . . aSource numbers from the following catalogs EC Eiroa Casa li D Djupvik et al. P Preibisch K Kaas et al. . Table . AverageStd Dev of Spectral Slope Versus Luminosity of YSOs Luminosity Range Average . L . . . . L . . . L . . Table . Numbers Densities Star Formation Rates Region Area NYSOs N NArea NVol SFR SFRArea pc deg pc pc M Myr M Myrpc Cluster A . Cluster B . . Rest of Cloud . . . . All of Cloud . . . . Table . Disk Modeling Results in Class II Sources Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . T . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . L . . . . . L . . . . . T . . . . . T . . . . . LU . . . . . T . . . . . L . . . . . L . . . . . L . . . . . T . . . . . T . . . . . L . . . . . T . . . . . L . . . . . T . . . . . Table Continued Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . L . . . . . T . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . T . . . . . L . . . . . L . . . . . T . . . . . L . . . . . T . . . . . LU . . . . . LU . . . . . L . . . . . L . . . . . L . . . . . Table Continued Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . L . . . . . T . . . . . T . . . . . L . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . LU . . . . . T . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . L . . . . . L . . . . . L . . . . . L . . . . . T . . . . . L . . . . . T . . . . . T . . . . . T . . . . . L . . . . . T . . . . . L . . . . . Table Continued Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . T . . . . . T . . . . . L . . . . . T . . . . . L . . . . . T . . . . . L . . . . . LU . . . . . L . . . . . L . . . . . LU . . . . . T . . . . . T . . . . . T . . . . . T . . . . . T . . . . . T . . . . . L . . . . . T . . . . . L . . . . . L . . . . . T . . . . . T . . . . . T . . . . . Table . Disk Modeling Results in Class III Sources Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . L . . . . . L . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . L . . . . . LU . . . . . L . . . . . L . . . . . L . . . . . L . . . . . Table Continued Star SED Type A VLstar LdiskLstar turnoexcess L . . . . . LU . . . . . L . . . . . L . . . . . L . . . . . L . . . . . Table . The Coldest YSOs FF ID NamePosition . m . m . m . m . m . m Tbl SSTcdJ... mJy mJy mJy mJy mJy mJy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Table . Probable High Velocity Outows in Serpens YSO ID RA J Dec J Matching Name Comments . HH ABE . HH A . HH A . HH BD . HH AB . HH ABCD . HH AB . SMM Jets to NW and SE . SMM Jets to NW and SE . Jets to N and S 
4,0704.0010,"  Partial cubes are isometric subgraphs of hypercubes. Structures on a graph
defined by means of semicubes, and Djokovi\'{c}'s and Winkler's relations play
an important role in the theory of partial cubes. These structures are employed
in the paper to characterize bipartite graphs and partial cubes of arbitrary
dimension. New characterizations are established and new proofs of some known
results are given.
  The operations of Cartesian product and pasting, and expansion and
contraction processes are utilized in the paper to construct new partial cubes
from old ones. In particular, the isometric and lattice dimensions of finite
partial cubes obtained by means of these operations are calculated.
", A hypercube HX on a setXis a graph which vertices are the nite subsets ofX two vertices are joined by an edge if they dier by a singleto n. A partial cube is a graph that can be isometrically embedded into a hype rcube. There are three general graphtheoretical structures that play a prominent role in the theory of partial cubes namely semicubes Djok ovi cs relation and Winklers relation . We use these structures in particula r to characterize bi partite graphs and partial cubes. The characterization pro blem for partial cubes was considered as an important one and many characterizatio ns are known. We list contributions in the chronological order Djokovi c Avis Winkler Roth and Winkler C hepoi and . In the paper we present new proofs for the results of Djokovi c Winkler and Chepoi and obtain two more characteri zations of partial cubes. The paper is also concerned with some ways of constructing ne w partial cubes from old ones. Properties of subcubes the Cartesian p roduct of partial cubes and expansion and contraction of a partial cube are in vestigated. We introduce a construction based on pasting two graphs togeth er and show how new partial cubes can be obtained from old ones by pasting the m together. The paper is organized as follows. Hypercubes and partial cubes are introduced in Section tog ether with two basic examples of innite partial cubes. Vertex sets of p artial cubes are described in terms of well graded families of nite sets. In Section we introduce the concepts of a semicube Djokovi csand Win klers relations and establish some of their properties. Bipartite graphs and partial cubes are characterized by means of these structure s. One more charac terization of partial cubes is obtained in Section where s ocalled fundamental sets in a graph are introduced. The rest of the paper is devoted to constructions subcubes a nd the Carte sian product Section pasting Section and expansio ns and contractions Section . We show that these constructions produce new pa rtial cubes from old ones. Isometric and lattice dimensions of new partial cu bes are calculated. These dimensions are introduced in Section . Few words about conventions used in the paper are in order. Th esum disjoint union ABof two sets AandBis the union A B. All graphs in the paper are simple undirected graphs. In the n otationG VE the symbol Vstands for the set of vertices of the graph GandEstands for its set of edges. By abuse of language we often write abfor an edge in a graph if this is the case abis an unordered pair of distinct vertices. We denote abracktltUabracktrihtthe graph induced by the set of vertices UV. IfGis a connected graph thendGab stands for the distance between two vertices aandbof the graph G. Wherever it is clear from the context which graph is under co nsideration we drop the subscript GindGab. A subgraph HGis anisometric subgraph ifdHab dGab for all vertices aandbofH it is convex if any shortest path inGbetween vertices of Hbelongs toH. Hypercubes and partial cubes LetXbe a set. We denote PfX the set of all nite subsets of X. Denition .. A graph HX has the set PfX as the set of its vertices a pair of vertices PQis an edge of HX if the symmetric dierence PQis a singleton. The graph HX is called the hypercube on X. IfXis a nite set of cardinality n then the graph HX is thencubeQn. The dimension of the hypercube HX is the cardinality of the set X. The shortest path distance dPQ on the hypercube HX is the Hamming distance between sets PandQ dPQ PQforPQPf. . The set PfX is a metric space with the metric d. Denition .. A graphGis apartial cube if it can be isometrically embedded into a hypercube HX for some set X. We often identify Gwith its isometric image in the hypercube HX and say that Gis apartial cube on the set X. Figure . A graph and its isometric embedding into Q. An example of a partial cube and its isometric embedding into the cubeQ is shown in Figure .. Clearly a family Fof nite subsets of Xinduces a partial cube on Xif and only if for any two distinct subsets PQFthere is a sequence RPR...R nQ of sets in Fsuch that dRiRi for all in anddPQ n. . The families of sets satisfying condition . are known as well graded fam ilies of sets . Note that a sequence Ri satisfying . is a shortest path fromPtoQinHX and in the subgraph induced by F. Denition .. A family Fof arbitrary subsets of Xis awgfamily well graded family of sets if for any two distinct subsets PQF the setPQis nite and there is a sequence RPR...R nQ of sets in Fsuch that RiRi for all in andPQn. Example .. The induced graph can be a partial cube on a dierent set if the family Fis not well graded. Consider for instance the family Faababcbc of subsets of Xabc. The graph induced by this family is a path of length in the cube Qcf. Figure .. Clearly Fis not well graded. On the other hand as it can be easily seen any path is a partial cube. Figure . A nonisometric path in the cube Q. Any family Fof subsets of Xdenes a graph GF FEF where EFPQ FPQ . Theorem .. The graph GFdened by a family Fof subsets of a set Xis isomorphic to a partial cube on Xif and only if the family Fis well graded. Proof. We need to prove suciency only. Let Sbe a xed set in F. We dene a mapping fFPfX byfR RSforRF. Then dfRfT RSTSRT. Thusfis an isometric embedding of FintoPfX. Let Ri be a sequence of sets in Fsuch thatRPRnQPQn and RiRi for all i n . Then the sequence fRi satises conditions .. The result follows. A setRPfX is said to be lattice between setsPQPfX if PQRPQ. It ismetrically between PandQif dPR dRQ dPQ. The following theorem is a wellknown result about these two betweenness re lations on PfX see for instance . Theorem .. Lattice and metric betweenness relations coincide on PfX. LetFbe a family of nite subsets of X. The set of all RFthat are betweenPQFis the interval IPQbetweenPandQinF. Thus IPQ FPQPQ where PQPQ is the usual interval in the lattice Pf. Two distinct sets PQFareadjacent in FifJPQ PQ. If setsP andQform an edge in the graph induced by F thenPandQare adjacent in F but generally speaking not vice versa. For instance in E xample . the vertices andbcare adjacent in Fbut do not dene an edge in the induced graph cf. Figure .. The following theorem is a local characterization of wgf amilies of sets. Theorem .. A family FPfXis well graded if and only if dPQ for any two sets PandQthat are adjacent in F. Proof. Necessity. Let Fbe a wgfamily of sets. Suppose that PandQare adjacent in F. There is a sequence RPR...R nQthat satises conditions .. Since the sequence Ri is a shortest path in F we have dPPi dPiQ dPQ for all in. ThusPiIPQ PQ. It follows that dPQ n . Suciency. Let PandQbe two distinct sets in F. We prove by induction onndPQ that there is a sequence RiFsatisfying conditions .. The statement is trivial for n . Suppose that n and that the statement is true for all k n . LetPandQbe two sets in Fsuch that dPQ n. SincedPQ the sets PandQare not adjacent in F. Therefore there exists RFthat lies between PandQand is distinct from these two sets. Then dPR dRQ dPQ and both distances dPR anddRQ are less than n. By the induction hypothesis there is a sequence RiFsuch that PR RRj QRnfor some j n satisfying conditions . for i j andji n. It follows that Fis a wgfamily of sets. We conclude this section with two examples of innite partia l cubes more examples are found in . Example .. LetZbe the graph on the set Zof integers with edges dened by pairs of consecutive integers. This graph is a partial cub e since its vertex set is isometric to the wgfamily of intervals m mZinZ. Example .. Let us consider Znas a metric space with respect to the metric. The graph ZnhasZnas the vertex set two vertices in Znare connected if they are on the unit distance from each other. We will show i n Section Corollary . that Znis a partial cube. Characterizations Only connected graphs are considered in this section. Denition .. LetG VE be a graph and dbe its distance function. For any two adjacent vertices abVletWabbe the set of vertices that are closer toathan tob WabwVdwadwb. Following we call the sets Waband induced subgraphs abracktltWababracktrihtsemicubes of the graphG. The semicubes WabandWbaare called opposite semicubes . Remark .. The subscript abinWabstands for an ordered pair of vertices not for an edge of G. In his original paper Djokovi c uses notation Gab cf. . We use the notation from . Clearly two opposite semicubes are disjoint. They can be us ed to charac terize bipartite graphs as follows. Theorem .. A graphG VEis bipartite if and only if the semicubes Wab andWbaform a partition of Vfor any edge abE. Proof. Let us recall that a connected graph Gis bipartite if and only if for every vertexxthere is no edge abwithdxa dxb see for instance . For any edgeabEand vertex xVwe clearly have dxa dxbx WabWba. The result follows. The following lemma is instrumental and will be used frequen tly in the rest of the paper. Lemma .. LetG VEbe a graph and wWabfor some edge abE. Then dwb dwa . Accordingly WabwVdwb dwa . Proof. By the triangle inequality we have dwadwbdwa dab dwa . The result follows since dtakes values in N. There are two binary relations on the set of edges of a graph th at play a central role in characterizing partial cubes. Denition .. LetG VE be a graph and exyandfuvbe two edges ofG. i Djokovi c The relation onEis dened by effjoins a vertex in Wxywith a vertex in Wyx. The notation can be chosen such that uWxyandvWyx. ii Winkler The relation on Eis dened by efdxu dyvatioslashdxv dyu. It is clear that both relations and are reexive and is symmetric. Lemma .. The relation is a symmetric relation on E. Proof. Suppose that xyuv withuWxyandvWyx. By Lemma . and the triangle inequality we have dux duyduv dvy dvy dvxdvu dux dux. Hencedux dvx anddvy duy. Therefore xWuvand yWvu. It follows that uvxy . Lemma .. . Proof. Suppose that xyuv withuWxy vWyx. By Lemma . dxu dyv dxv dyuatioslashdxv dyu. Hencexyuv. Example .. It is easy to verify that is the identity relation on the set of edges of the cycle C. On the other hand any two edges of Cstand in the relation . Thus atioslash in this case. Bipartite graphs can be characterized in terms of relations and as follows. Theorem .. A graphG VEis bipartite if and only if . Proof. Necessity. Suppose that Gis a bipartite graph two edges xyanduv stand in the relation that is dxu dyvatioslashdxv dyu and that edges xyanduvdo not stand in the relation . By Theorem . we may assume that uvWxy. By Lemma . we have dxu dyv dyu dxv dxv dyu a contradiction. It follows that . By Lemma . . Suciency. Suppose that Gis not bipartite. By Theorem . there is an edgexysuch thatWxyWyxis a proper subset of V. SinceGis connected there is an edge uvwithu WxyWyxandvWxyWyx. Clearlyuvdoes not stand in the relation toxy. On the other hand dxu dyvatioslashdxv dyu sinceu WxyWyxandvWxyWyx. Thusxyuv a contradiction since we assumed that . By Theorem . the relations and coincide on bipartite graphs. For this reason we use the relation in the rest of the paper. Lemma .. LetG VEbe a bipartite graph such that all its semicubes are convex sets. Then two edges xyanduvstand in the relation if and only if the corresponding pairs of mutually opposite semicubes form eq ual partitions of V xyuv WxyWyxWuvWvu. Proof. Necessity We assume that the notation is chosen such that uWxy andvWyx. LetzWxyWvu. By Lemma . dzu dzv dvu. SincezuWxyandWxyis convex we have vWxy a contradiction to the assumption that vWyx. ThusWxyWvu. Since two opposite semicubes in a bipartite graph form a partition of V we haveWuvWxyandWvuWyx. A similar argument shows that WuvWyxandWvuWxy ifuWyx andvWxy. Suciency. Follows from the denition of the relation . We need another general property of the relation cf. Lemma . in . Lemma .. LetPbe a shortest path in a graph G. Then no two distinct edges ofPstand in the relation . Proof. Letijandxixiandxjxjbe two edges in a shortest path Pfrom xtoxn. Then dxixjdxixj anddxixjdxixj soxixiWxjxj. It follows that edges xixiandxjxjdo not stand in the relation . The converse statement is true for bipartite graphs we omit the proof a counterexample is the cycle Cwhich is not bipartite. Lemma .. LetG VEbe a bipartite graph. The following statements are equivalent iAll semicubes of Gare convex. iiThe relation is an equivalence relation on E. Proof. iii. Follows from Lemma .. iii. Suppose that is transitive and there is a nonconvex semicube Wab. Then there are two vertices uvWaband a shortest path Pfromuto vthat intersects Wba. This path contains two distinct edges eandfjoining vertices of semicubes WabandWba. The edges eandfstand in the relation to the edge ab. By transitivity of we haveef. This contradicts the result of Lemma .. Thus all semicubes of Gare convex. We now establish some basic properties of partial cubes. Theorem .. LetG VEbe a partial cube. Then iGis a bipartite graph. iiEach pair of opposite semicubes form a partition of V. iiiAll semicubes are convex subsets of V. ivis an equivalence relation on E. Proof. We may assume that Gis an isometric subgraph of some hypercube HX that isG FEF for a wgfamily Fof nite subsets of X. i It suces to note that if two sets in HX are connected by an edge then they have dierent parity. Thus HX is a bipartite graph and so is G. ii Follows from i and Theorem .. iii LetWABbe a semicube of G. By Lemma . and Theorem . we have WABSFSBASB. LetQRWABandPbe a vertex of Gsuch that dQP dPR dQR. By Theorem . QRPQR. SinceQRWAB we have QBAQBandRBARB which implies PBQRBAQRBSB. HencePWAB and the result follows. iv Follows from iii and Lemma .. Remark .. Since semicubes of a partial cube G VE are convex subsets of the metric space V they are halfspaces inV. This terminology is used in . The following theorem presents four characterizations of p artial cubes. The rst two are due to Djokovi c and Winkler cf. Theore m . in . Theorem .. LetG VEbe a connected graph. The following statements are equivalent iGis a partial cube. iiGis bipartite and all semicubes of Gare convex. iiiGis bipartite and is an equivalence relation. ivGis bipartite and for all xyuv E xyuv WxyWyxWuvWvu. . vGis bipartite and for any pair of adjacent vertices of G there is a unique pair of opposite semicubes separating these two vertices. Proof. By Lemma . the statements ii and iii are equivalent an d by The orem . i implies both ii and iii. iiii. By Theorem . each pair WabWbaof opposite semicubes of Gform a partition of V. We orient these partitions by calling in an arbitrary way one of the two opposite semicubes in each partition a positive semicube . Let us assign to each xVthe setWx of all positive semicubes containing x. In the next paragraph we prove that the family FWxxVis well graded and that the assignment xmapstoWx is an isometry between VandF. Letxandybe two distinct vertices of G. We say that a positive semicube Wabseparatesxandyif eitherxWab yWbaorxWba yWab. It is clear thatWabseparatesxandYif and only if WabWxWy. LetP be a shortest path xxx...x nyfromxtoy. By Lemma . no two distinct edges of Pstand in the relation . By Lemma . distinct edges of P dene distinct positive semicubes clearly these semicub es separate xandy. Let Wabbe a positive semicube separating xandy and sayxWabandyWba. There is an edge fPthat joins vertices in WabandWba. Hencefstands in the relation toaband by Lemma . Wabis dened by f. It follows that any semicube in WxWy is dened by a unique edge in Pand any edge in P denes a semicube in WxWy. Therefore dWxWy dxy that isxmapstoWx is an isometry. Clearly Fis a wgfamily of sets. By Theorem . the family Fis isometric to a wgfamily of nite sets. HenceGis a partial cube. ivii. Suppose that there exist an edge absuch that semicube Wbais not convex. Let pandqbe two vertices in Wbasuch that there is a shortest pathPfromptoqthat intersects Wab. There are two distinct edges xyanduv inPsuch thatxuWabandyvWba. Sinceabxy andabuv we have by . WabWxyWuv. HenceuWxyandvWyx. By Lemma . dxu dxv dvy dvy a contradiction since Pis a shortest path from ptoq. iiiv. Follows from Lemma .. It is clear that iv and v are equivalent. Fundamental sets in partial cubes Semicubes played an important role in the previous section. In this section we introduce three more classes of useful subsets of graphs. We also establish one more characterization of partial cubes. LetG VE be a connected graph. For a given edge eabE we dene the following sets cf. FabfEefuvEuWabvWba UabwWabwis adjacent to a vertex in Wba UbawWbawis adjacent to a vertex in Wab. The ve sets are schematically shown in Figure .. Figure . Fundamental sets in a partial cube. Remark .. In the case of a partial cube G VE the semicubes Waband Wbaare complementary halfspaces in the metric space Vcf. Remark .. Then the set Fabcan be regarded as a hyperplane separating these halfspa ces see where this analogy is formalized in the context of h yperplane arrange ments. The following theorem generalizes the result obtained in for median graphs see also . Theorem .. Letabbe an edge of a connected bipartite graph G. If the semicubesWabandWbaare convex then the set Fabis a matching and induces an isomorphism between the graphs abracktltUababracktrihtandabracktltUbaabracktriht. Proof. Suppose that Fabis not a matching. Then there are distinct edges xu andxvwith sayxUabanduvUba. By the triangle inequality duv. SinceGdoes not have triangles duvatioslash . Hence duv which implies thatxlies between uandv. This contradicts convexity of Wba sincexWab. ThereforeFabis a matching. To show that Fabinduces an isomorphism let xyuv FabandxuE wherexuUabandyvUba. SinceGdoes not have odd cycles dvyatioslash . By the triangle inequality dvydvu dux dxy . SinceWbais convexdvyatioslash . Thus dvy that is vyis an edge. The result follows by symmetry. By Theorem .ii we have the following corollary. Corollary .. LetG VEbe a partial cube. For any edge abthe setFab is a matching and induces an isomorphism between induced gra phsabracktltUababracktrihtand abracktltUbaabracktriht. Figure . Graph G. Example .. LetGbe the graph depicted in Figure .. The set Fababxuyv is a matching and denes an isomorphism between the graphs in duced by subsets Uabaxy andUbabuv . The setWbais not convex so Gis not a partial cube. Thus the converse of Corollary . does not hol d. We now establish another characterization of partial cubes that utilizes a geometric property of families Fab. Theorem .. For a connected graph Gthe following statements are equivalent iGis a partial cube. iiGis bipartite and dxu dyvanddxv dyu . for anyabEandxyuv Fab. Proof. iii. We may assume that xuWabandyvWba. Sinceis an equivalence relation we have xyuvab . By Lemma . WuvWxyWab. By Lemma . dxu dxv dvy dyv. We also have dxv dyv dyu by the same lemma. iii. Suppose that Gis not a partial cube. Then by Theorem . there exist an edge absuch that say semicube Wbais not convex. Let pandqbe two vertices inWbasuch that there is a shortest path Pfromptoqthat intersects Wab. Letuvbe the rst edge in Pwhich belongs to Fabandxybe the last edge inPwith the same property see Figure .. Figure . An illustration to the proof of theorem .. SincePis a shortest path we have dvy dvu dux dxyatioslashdxu which contradicts condition .. Thus all semicubes of Gare convex. By Theorem . Gis a partial cube. Remark .. One can say that four vertices satisfying conditions . d ene arectangle inG. Then Theorem . states that a connected graph is a partial cube if and only if it is bipartite and for any edge abpairs of edges in Fabdene rectangles in G. Dimensions of partial cubes There are many dierent ways in which a given partial cube can be isometrically embedded into a hypercube. For instance the graph Kcan be isometrically embedded in dierent ways into any hypercube HX with X. Following Djokovi c see also we dene the isometric dimension dimIG of a partial cube Gas the minimum possible dimension of a hypercube HX in whichGis isometrically embeddable. Recall see Section that th e dimension of HX is the cardinality of the set X. Theorem .. Theorem in . LetG VEbe a partial cube. Then dimIG E . whereis Djokovi cs equivalence relation on EandEis the set of its equiv alence classes the quotientset . The quotientset Ecan be identied with the family of all distinct sets Fab see Section . If Gis a nite partial cube we may consider it as an isometric subgraph of some hypercube Qn. Then the edges in each family Fabare parallel edges inQncf. Theorem .. This observation essentially proves . in the nite case. LetGbe a partial cube on a set X. The vertex set of Gis a wgfamily Fof nite subsets of Xsee Section . We dene the retraction ofFas a family F of subsets of XF Fconsisting of the intersections of sets in FwithX. It is clear that Fsatises conditions Fand FX. . Proposition .. The partial cubes induced by a wgfamily Fand its retraction Fare isomorphic. Proof. It suces to prove that metric spaces FandFare isometric. Clearly PmapstoPXis a mapping from FontoF. ForPQF we have PXQX PQX PQF F PQ. ThusdPQ dPQ. Consequently is an isometry. LetGbe a partial cube on some set Xinduced by a wgfamily Fsatisfying conditions . and let PQbe an edge of G. By denition there is xXsuch thatPQx. The following two lemmas are instrumental. Lemma .. LetPQbe an edge of a partial cube GonXand letPQx. The two sets RFxRand RFx R form the same bipartition of the family Fas semicubes WPQandWQP. Proof. We may assume that QPx. Then for any RF RQRPx braceleftBigg RP xifxR RP ifx R. Hence RPRQif and only if xR. It follows that WPQRFxR. A similar argument shows that WQPRFx R. Lemma .. IfFis a wgfamily of sets satisfying conditions . then for anyxXthere are sets PQFsuch thatPQx. Proof. By conditions . for a given xXthere are sets SandTinFsuch thatxSandx T. LetRSR...R nTbe a sequence of sets in Fsatisfying conditions .. It is clear that there is isuch thatxRiand x Ri. HenceRiRix so we can choose PRiandQRi. By Lemmas . and . there is onetoone correspondence be tween the set Xand the quotientset E. From Theorem . we obtain the following result. Theorem .. LetFbe a wgfamily of nite subsets of a set Xsuch that FandFX and letGbe a partial cube on Xinduced by F. Then dimIG X. Clearly a graph which is isometrically embeddable into a pa rtial cube is a partial cube itself. We will show in Section Corollary . that the integer lattice Znis a partial cube. Thus a graph which is isometrically embedd able into an integer lattice is a partial cube. It follows that a n ite graph is a partial cube if and only if it is embeddable in some integer lattice. E xamples of innite partial cubes isometrically embeddable into a nite dimens ional integer lattice are found in . We call the minimum possible dimension nof an integer lattice Zn in which a given graph Gis isometrically embeddable its lattice dimension and denote it dim ZG. The lattice dimension of a partial cube can be expressed in terms of maximum matchings in socalled semicube graphs . Denition .. Thesemicube graph ScG has all semicubes in Gas the set of its vertices. Two vertices WabandWcdare connected in Sc G if WabWcdVandWabWcdatioslash. . IfGis a partial cube then condition . is equivalent to each of the two equivalent conditions WbaWcdWdcWab . where stands for the proper inclusion. Theorem .. Theorem in . LetGbe a nite partial cube. Then dimZG dim IG M whereMis a maximum matching in the semicube graph ScG. Example .. LetGbe the graph shown in Figure .. It is easy to see that dimIG and dim ZG . Example .. LetTbe a tree with nedges andmleaves. Then dimIT nand dim ZT m cf. and respectively. Example .. For the cycle Cwe have see Figure . dimIC dim ZC . Subcubes and Cartesian products LetGbe a partial cube. We say that Gis asubcube ofGif it is an isometric subgraph of G. Clearly a subcube is itself a partial cube. The converse doe s not hold a subgraph of a graph Gcan be a partial cube but not an isometric subgraph of Gcf. Example .. IfGis a subcube of a partial cube G then dim IGdimIG and dimZGdimZG. In general the two inequalities are not strict. For instance the cycle Cis an isometric subgraph of the cube Qsee Figure . and dimIC dim ZC dim IQ dim ZQ . Semicubes of a partial cube are examples of subcubes. Indeed by Theo rem . semicubes are convex subgraphs and therefore isome tric. In general the converse is not true a path connecting two opposite vert ices inCis an isometric subgraph but not a convex one. Another common way of constructing new partial cubes from ol d ones is by forming their Cartesian products see for details and p roofs. Denition .. Given two graphs G VE andG VE their Cartesian product GGsquareG has vertex set VVV a vertex u uu is adjacent to a vertex v vv if and only if uvEanduv oruvanduvE. The operation squareis associative so we can write GGsquare squareGnnproductdisplay iGi for the Cartesian product of graphs G...G n. A Cartesian productproducttextn iGi is connected if and only if the factors are connected. Then we have dGuv nsummationdisplay idGiuivi. . Example .. LetXin ibe a family of sets and Ysummationtextn ibe their sum. Then the Cartesian product of the hypercubes HXi is isomorphic to the hy percube HY. The isomorphism is established by the mapping f P...P nmapstonsummationdisplay iPi. Formula . yields immediately the following results. Proposition .. LetHibe isometric subgraphs of graphs Gifor all in. Then the Cartesian productproducttextn iHiis an isometric subgraph of the Cartesian productproducttextn iGi. Corollary .. The Cartesian product of a nite family of partial cubes is a partial cube. In particular the integer lattice Zncf. Examples . and . is a partial cube. The results of the next two theorems can be easily extended to arbitrary nite products of nite partial cubes. Theorem .. LetGGsquareGbe the Cartesian product of two nite partial cubes. Then dimIG dim IG dim IG. Proof. We may assume that Gresp.G is induced by a wgfamily Fresp. F of subsets of a nite set Xresp.X such that FandFX resp. FandFX see Section . By Theorem . dimIG Xand dim IG X. It is clear that the graph Gis induced by the wgfamily FFFof subsets of the setXXXcf. Example . with FFX. By Theorem . dimIG XXX dim IG dim IG. Theorem .. LetG VEbe the Cartesian product of two nite partial cubesG VEandG VE. Then dimZG dim ZG dim ZG. Proof. LetWabcdbe a semicube of the graph G. There are two possible cases ica bd E. Let xy be a vertex of G. Then by . dGxyab dGxa dGyb and dGxycd dGxc dGyd. Hence dGxyabdGxycddGybdGyd. It follows that WabcdVWbd. . iidb acE. Like in i we have WabcdWacV. . Clearly two semicubes given by . form an edge in the semi cube graph ScG if and only if their second factors form an edge in the semicu be graph ScG. The same is true for semicubes in the form . with respec t to their rst factors. It is also clear that semicubes in the form . and in the form . are not connected by an edge in Sc G. Therefore the semicube graph Sc G is isomorphic to the disjoint union of semicube graphs Sc G and ScG. IfM is a maximum matching in Sc G andMis a maximum matching in Sc G thenMMMis a maximum matching in Sc G. The result follows from theorems . and .. Remark .. The result of Corollary . does not hold for innite Cartesi an products of partial cubes as these products are disconnect ed. On the other hand it can be shown that arbitrary weakCartesian products connected com ponents of Cartesian products of partial cubes are par tial cubes. Pasting partial cubes In this section we use the set pasting technique ch.I . to build new partial cubes from old ones. LetG VE andG VE be two graphs H UF and H UF be two isomorphic subgraphs of GandG respectively and UUbe a bijection dening an isomorphism between HandH. The bijectiondenes an equivalence relation Ron the sum VVas follows any element in VUVU is equivalent to itself only and elements uU anduUare equivalent if and only if uu. We say that the quotient setV VVRis obtained by pasting together the sets VandValong the subsets UandU. Since the graphs HandHare isomorphic the pasting of the sets VandVcan be naturally extended to a pasting of sets of edges EandEresulting in the set Eof edges joining vertices in V. We say that the graphG EV is obtained by pasting together the graphs GandG along the isomorphic subgraphs HandH. The pasting construction allows for identifying in a natural way the graphs GandGwith subgraphs of G and the isomorphic graphs HandHwith a common subgraph Hof both graphs GandG. We often follow this convention below. Remark .. Note that in the above construction the resulting graph Gde pends not only on graphs GandGand their isomorphic subgraphs Hand Hbut also on the bijection dening an isomorphism from HontoHsee the drawings in Figures . and .. Figure . Pasting of two trees. Figure . Another pasting of the same trees. In general pasting of two partial cubes GandGalong two isomorphic subgraphsHandHdoes not produce a partial cube even under strong as sumptions about these subgraphs as the next example illustr ates. Figure . Pasting partial cubes GandG. Example .. Pasting of two partial cubes GCandGCalong subgraphsHandHis shown in Figure .. The resulting graph Gis not a partial cube. Indeed the semicube Wabis not a convex set. Note that subgraphs HandHare convex subgraphs of the respective partial cubes. In this section we study two simple pastings of connected gra phs together the vertexpasting and the edgepasting and show that thes e pastings produce partial cubes from partial cubes. We also compute the isomet ric and lattice dimensions of the resulting graphs. LetG VE andG VE be two connected graphs aV aV andH a H a. LetGbe the graph obtained by pasting GandGalong subgraphs HandH. In this case we say that the graphGis obtained from graphs GandGbyvertexpasting . We also say thatGis obtained from GandGbyidentifying verticesaanda. Figure . illustrates this construction. Note that the vertex aaais a cut vertex ofG sinceGGGandGGa. We follow our convention and identify graphs GandGwith subgraphs of G. Figure . An example of vertexpasting. In what follows we use superscripts to distinguish subgraph s of the graphs GandG. For instance W abstands for the semicube of Gdened by two adjacent vertices abV. Theorem .. A graphG VEobtained by vertexpasting from partial cubesG VEandG VEis a partial cube. Proof. We denote aaathe vertex of Gobtained by identifying vertices aVandaV. ClearlyGis a bipartite graph. Let xybe an edge of G. Without loss of generality we may assume that xyEandaWxy. Note that any path between vertices in VandVmust go through a. SinceaWxy we have for any vV dvx dva daxdva day dvy which implies VWxyandWyxV. It follows that WxyW xyVand WyxW yx. The sets W xy W yxandVare convex subsets of V. Since W xyVa the setWxyW xyVis also convex. By Theorem .ii the graphGis a partial cube. The vertexpasting construction introduced above can be ge neralized as follows. Let GGi ViEiiJbe a family of connected graphs and AaiGiiJbe a family of distinguished vertices of these graphs. Let G be the graph obtained from the graphs Giby identifying vertices in the set A. We say that Gis obtained by vertexpasting together the graphs Gialong the setA. Example .. LetJ...n withn GGi aibiaibiiJand AaiiJ. Clearly each GiisK. By vertexpasting these graphs along A we obtain the nstar graph Kn. Since the star Knis a tree it can be also obtained from Kby successive vertexpasting as in Example .. Example .. LetGbe a tree and GK. By vertexpasting these graphs we obtain a new tree. Conversely let Gbe a tree and vbe its leaf. Let Gbe a tree obtained from Gby deleting the leaf v. ClearlyGcan be obtained by vertexpasting GandK. It follows that any tree can obtained from the graph Kby successive vertexpasting of copies of Kcf. Theorem .e in . Any connected graph Gcan be constructed by successive vertexpasting of its blocks using its block cutvertex tree structure. Let Gbe an endblock of Gwith a cut vertex vandGbe the union of the remaining blocks of G. Then Gcan be obtained from GandGby vertexpasting along the vertex v. It follows that any connected graph can be obtained from its blo cks by successive vertexpastings. LetG VE be a partial cube. We recall that the isometric dimension dimIG ofGis the cardinality of the quotient set E whereis Djokovi cs equivalence relation on the set Ecf. formula .. Theorem .. LetG VEbe a partial cube obtained by vertexpasting together partial cubes G VEandG VE. Then dimIG dim IG dim IG. Proof. It suces to prove that there are no edges xyEanduvEwhich are in Djokovi cs relation with each other. Suppose that GandGare vertexpasted along vertices aEandaEand letaaa E. Let xyEanduvEbe two edges in E. We may assume that uWxy. Since ais a cutvertex of GanduWxy we have dua dax duxduy dua day. Hencedaxday which implies dvx dva daxdva day dvy. It follows that vWxy. Therefore the edge xydoes not stand in the relation to the vertex uv. The next result follows immediately from the previous theor em. Note that blocks of a partial cube are partial cubes themselves. Corollary .. LetGbe a partial cube and G...G nbe the family of its blocks. Then dimIG nsummationdisplay idimIGi. In the case of the lattice dimension of a partial cube we can cl aim only much weaker result than one stated in Theorem . for the isometri c dimension. We omit the proof. Theorem .. LetGbe a partial cube obtained by vertexpasting together parti al cubesGandG. Then maxdimZGdimZG dimZGdimZG dim ZG. The following example illustrate possible cases for inequa lities in Theo rem .. Let us recall that the lattice dimension of a tree wit hmleaves is mcf. . Example .. The starKcan be obtained from the stars KandKby vertexpasting these two stars along their centers. Clearl y maxdimZKdimZKdimZK dim ZK dim ZK. The same star Kis obtained from two copies of the star Kby vertex pasting along their centers. We have dim ZK dimZK so maxdimZKdimZKdimZKdimZK dim ZK. Let us vertexpaste two stars Kalong their two leaves. The resulting graphTis a tree with four vertices. Therefore maxdimZKdimZK dim ZTdimZK dim ZK. We now consider another simple way of pasting two graphs toge ther. LetG VE andG VE be two connected graphs abE abE andH abab H abab. LetGbe the graph obtained by pasting GandGalong subgraphs HandH. In this case we say that the graph Gis obtained from graphs GandGbyedgepasting . Figures . . and . illustrate this construction. Figure . An example of edgepasting. As before we identify the graphs GandGwith subgraphs of the graph Gand denote aaa bbbthe two vertices obtained by pasting together vertices aandaand respectively bandb. The edge abEis obtained by pasting together edges abEandabEcf. Figure .. ThenGGG VVabandEEab. We use these notations in the rest of this section. Proposition .. A graphGobtained by edgepasting together bipartite graphs GandGis bipartite. Proof. LetCbe a cycle in G. IfCGorCG then the length of Cis even since the graphs GandGare bipartite. Otherwise the vertices aand bseparateCinto two paths each of odd length. Therefore Cis a cycle of even length. The result follows. The following lemma is instrumental it describes the semic ubes of the graph Gin terms of semicubes of graphs GandG. Lemma .. Letuvbe an edge of G. Then iForuvE ab WuvWuvW uvV WvuW vu. iiForuvE ab WuvWuvW uvV WvuW vu. iiiaWuvbWvuWuvWab. Figure . Edgepasting of graphs GandG. Proof. We prove parts i and iii see Figure .. i Since any path from wVtouorvcontainsaorbandabWuv we havewWuv. HenceWuvW uvVandWvuW vu. iii Sinceabuv inG we haveW uvW ab by Theorem .iv. Let w be a vertex in W uv. Then by the triangle inequality dwudwvdwb dbvdwb dbu. Since any shortest path from wtoucontainsaorb we have dwa dau dwu. Therefore dwa daudwb dbu. Sinceabuv inG we havedau dbv by Theorem .. It follows that dwa dwb that is wW ab. We proved that W uvW ab. By symmetry W vuW ba. Since two opposite semicubes form a partition of V we haveW uvW ab. The result follows. Theorem .. A graphGobtained by edgepasting together partial cubes G andGis a partial cube. Proof. By Theorem .ii and Proposition . we need to show that f or any edgeuvofGthe semicube Wuvis a convex subset of V. There are two possible cases. iuvab. The semicube Wabis the union of semicubes W abandW ab which are convex subsets of VandV respectively. It is clear that any shortest path connecting a vertex in W abwith a vertex in W abcontains vertex aand therefore is contained in Wab. HenceWabis a convex set. A similar argument proves that the set Wbais convex. iiuvatioslashab. We may assume that uvE. To prove that the semicube Wuvis a convex set we consider two cases. aabWuv. The case when abWvuis treated similarly. By Lemma .i the semicube Wuvis the union of the semicube W uvand the setVwhich are both convex sets. Any shortest path Pfrom a vertex in Vto a vertex in W uvcontains either aorb. It follows that PW uvVWuv. Therefore the semicube Wuvis convex. baWuvbWvu. The case when bWuvaWvuis treated similarly. By Lemma .ii WuvWab. The result follows from part i of the proof. Theorem .. LetGbe a graph obtained by edgepasting together nite partial cubesGandG. Then dimIG dim IG dim IG. Proof. Let andbe Djokovi cs relations on EE andE respectively. By Lemma . for uvxy Eresp.uvxy E we have uvxy uvxyresp.uvxy uvxy. LetuvExyE anduvxy . Suppose that uvab . We may assume that abWuv. By Lemma .i VWuv a contradiction since xyE. Henceuvxyab . It follows that each equivalence class of the relationis either an equivalence class of an equivalence class of or the class containing the edge ab. Therefore EEE . The result follows since the isometric dimension of a parti al cube is equal to the cardinality of the set of equivalence classes of Djokovi c s relation formula .. We need some results about semicube graphs in order to prove a n analog of Theorem . for a partial cube obtained by edgepasting of tw o partial cubes. Lemma .. LetGbe a partial cube and WpqWuv W qpWxybe two edges in the graph Sc G. ThenWxyWuvis an edge in Sc G. Proof. By condition . WqpWuvandWyxWqp. HenceWyxWuv. By the same condition WxyWuvScG. As before we identify partial cubes GandGwith subgraphs of the partial cubeG. ThenGGGandGG abab Kcf. Figure .. Lemma .. LetGbe a partial cube obtained by edgepasting together partial cubesGandG. LetW uvW xyresp.W uvW xybe an edge in the semicube ScG resp. Sc G. ThenWuvWxyis an edge in Sc G. Figure . Semicubes forming an edge in Sc G. Proof. It suces to consider the case of Sc G see Figure .. By condi tion .W vuW xyandW yxW uv. Suppose that aW vuandbW yx the case when bW vuandaW yxis treated similarly. Then abxyand abuv. By transitivity of we haveuvxy a contradiction since semicubes W uvandW xyare distinct. Therefore we may assume that say abW uv. Then by Lemma . WvuW vuV. SinceW vuW xyWxy we have WvuWxy. By condition . WuvWxyis an edge in Sc G. Lemma .. LetMandMbe matchings in graphs Sc Gand Sc G. There is a matching Min ScGsuch that M MM . Proof. By Lemma . MandMinduce matchings in Sc G which we denote by the same symbols. The intersection MMis either empty or a subgraph of the empty graph with vertices WabandWba. IfMMis empty then MMMis a matching in Sc G and the result follows. IfMMis an empty graph with a single vertex say in M we remove fromMthe edge that has this vertex as its end vertex resulting in t he matching M . ClearlyMM Mis a matching in Sc G and MMM . Suppose now that MMis the empty graph with vertices WabandWba. LetWabWuv W baWpqresp.WabWxy WbaWrs be edges in Mresp.M. By Lemma . WxyWrsis an edge in Sc G. Let us replace edges WabWxyand WbaWrsinMby a single edge WxyWrs resulting in the matching M . Then MMM is a matching in Sc G and MMM . Corollary .. LetMandMbe maximum matchings in Sc Gand Sc G respectively and Mbe a maximum matching in Sc G. Then M MM . . By Theorem . we have dimIG dim ZG MdimIG dim ZG M and dimIG dim ZG M whereMandMare maximum matchings in Sc G and ScG respectively andMis a maximum matching in Sc G. Therefore by Theorem . and . we have the following result cf. Theorem .. Theorem .. LetGbe a partial cube obtained by edgepasting from partial cubesGandG. Then maxdimZGdimZG dimZGdimZG dim ZG. Example .. Let us consider two edgepastings of the stars GKand GKof lattice dimension shown in gures . and .. In the rst case the resulting graph is the star GKof lattice dimension . Then we have maxdimZGdimZGdimZGdimZG dim ZG. In the second case the resulting graph is a tree with leaves. Therefore maxdimZGdimZG dim ZGdimZG dim ZG. Letcaandcabe edges of stars GKandGKeach of which has lattice dimension where candcare centers of the respective stars. Let us edgepaste these two graphs by identifying cwithcandawith a respectively. The resulting graph Gis the starKof lattice dimension . Thus maxdimZGdimZG dimZG dim ZG dim ZG. Expansions and contractions of partial cubes The graph expansion procedure was introduced by Mulder in where it is shown that a graph is a median graph if and only if it can be obta ined from Kby a sequence of convex expansions see also . A similar result for partial cubes was established in see also as a corol lary to a more general result concerning isometric embeddability into Hamming gr aphs it was also established in in the framework of oriented matroids th eory. In this section we investigate properties of isometric ex pansion and con traction operations and in particular prove in two diere nt ways that a graph is a partial cube if and only if it can be obtained from the graph Kby a sequence of expansions. A remark about notations is in order. In the product VV we denoteV ii Viandxi ix forxVi whereij . Denition .. LetG VE be a connected graph and let G VE andG VE be two isometric subgraphs of Gsuch thatGGG. Theexpansion of Gwith respect to GandGis the graph G VE constructed as follows from Gsee Figure . iVVVV V iiEEEM whereMis the matchinguniontext xVVxx. In this case we also say that Gis acontraction ofG. Figure . Expansioncontraction processes. It is clear that the graphs GandabracktltV abracktrihtare isomorphic as well as the graphs GandabracktltV abracktriht. We dene a projectionpVVbypxi xforxV. Clearly the restriction of ptoV is a bijection pV Vand its restriction to V is a bijectionpV V. These bijections dene isomorphisms abracktltV abracktriht Gand abracktltV abracktriht G. LetPbe a path in G. The vertices of Gobtained from the vertices in P under the projection pdene a walk PinG we call this walk Ptheprojection of the path P. It is clear that P PifP abracktltV abracktrihtorP abracktltV abracktriht. . In this case Pis a path in Gand either PpP orPpP. On the other hand PPifP abracktltV abracktriht atioslashandP abracktltV abracktriht atioslash . andPis not necessarily a path. We will frequently use the results of the following lemma in t his section. Lemma .. iForuvV any shortest path PuvinGbelongs to abracktltV abracktriht and its projection PuvpPuvis a shortest path in G. Accordingly dGuv dGuv andabracktltV abracktrihtis a convex subgraph of G. A similar statement holds for uvV . iiForuV andvV dGuv dGuv . LetPuvbe a shortest path in G. There is a unique edge xxMsuch that xxPuvand the sections PuxandPxvof the path Puvare shortest paths in abracktltV abracktrihtandabracktltV abracktriht respectively. The projection PuvofPuvinGis a shortest path in G. Proof. i LetPuvbe a path in Gthat intersects V . Since abracktltVabracktrihtis an isometric subgraph of G there is a path PuvinGthat belongs to abracktltVabracktriht. Thenp Puv is a path in abracktltV abracktrihtof the same length as Puv. By . and . p PuvPuv. Therefore any shortest path PuvinGbelongs to abracktltV abracktriht. The result follows. ii LetPuvbe a shortest path in GandPuvbe its projection to V. By . dGuv PuvPuvdGuv. Since there is no edge of Gjoining vertices in VVandVV a shortest path inGfromutovmust contain a vertex xVV. SinceGandG are isometric subgraphs there are shortest paths PuxinGandPxvinGsuch that their union is a shortest path from utov. Then by the triangle inequality and part i of the proof we have cf. Figure . dGuvdGux dGxx dGxv dGuv . The last two displayed formulas imply dGuv dGuv . SinceuV andvV the pathPuvmust contain an edge say xx in M. Since this path is a shortest path in G this edge is unique. Then the sec tionsPuxandPxvofPuvare shortest paths in abracktltV abracktrihtandabracktltV abracktriht respectively. ClearlyPuvis a shortest path in G. Letaabe an edge in the matching MxVVxx. This edge denes ve fundamental sets cf. Section the semicubes WaaandWaa the sets of vertices UaaandUaa and the set of edges Faa. The next theorem follows immediately from Lemma .. It gives a hint to a conne ction between the expansion process and partial cubes. Theorem .. LetGbe an expansion of a connected graph Gand notations are chosen as above. Then iWaaV andWaaV are convex semicubes of G. iiFaaMdenes an isomorphism between induced subgraphs abracktltUaaabracktrihtand abracktltUaaabracktriht which are isomorphic to the subgraph GG. The result of Theorem . justies the following constructi ve denition of the contraction process. Denition .. Letabbe an edge of a connected graph G VE such that i semicubes WabandWbaare convex and form a partition of V ii the set Fabis a matching and denes an isomorphism between subgraphs abracktltUababracktrihtandabracktltUbaabracktriht. A graphGobtained from the graphs abracktltWababracktrihtandabracktltWbaabracktrihtby pasting them along subgraphs abracktltUababracktrihtandabracktltUbaabracktrihtis said to be a contraction of the graph G. Remark .. IfGis bipartite then semicubes WabandWbaform a partition of its vertex set. Then by Theorem . condition i implies c ondition ii. Thus any pair of opposite convex semicubes in a connected biparti te graph denes a contraction of this graph. By Theorem . a graph is a contraction of its expansion. It i s not dicult to see that any connected graph is also an expansion of its con traction. The following three examples give geometric illustrations for the expansion and contraction procedures. Example .. Letaandbbe two opposite vertices in the graph GC. Clearly the two distinct paths PandPfromatobare isometric subgraphs ofGdening an expansion GCofGsee Figure .. Note that PandP are not convex subsets of V. Example .. Another isometric expansion of the graph GCis shown in Figure .. Here the path Pis the same as in the previous example and GG. Example .. Lemma . claims in particular that the projection of a sho rtest path in an extension Gof a graphGis a shortest path in G. Generally speaking Figure . An expansion of the cycle C. Figure . Another isometric expansion of the cycle C. the converse is not true. Consider the graph Gshown in Figure . and two paths inG Vabcef andVbde. The graphGin Figure . is the convex expansion of Gwith respect to Vand V. The path abdef is a shortest path in G it is not a projection of a shortest path inG. Figure . A shortest path which is not a projection of a shor test path. One can say that in the case of nite partial cubes the contr action procedure is dened by an orthogonal projection of a hypercube onto one of its facets. By Theorem . the sets V andV are opposite semicubes of the graph G dened by edges in M. Their projections are the sets VandVwhich are not necessarily semicubes of G. For other semicubes in Gwe have the following result. Lemma .. For any two adjacent vertices uvV WuivipWuvforuvViandi . Proof. By Lemma . dGxjuidGxjvidGxudGxv forxVandij . The result follows. Corollary .. Ifuvis an edge of GG thenWuvWuv. The following lemma is an immediate consequence of Lemma . . We shall use it implicitly in our arguments later. Lemma .. LetuvVandxVV. Then xWuvxWuv. The same result holds for semicubes in the form Wuv. Generally speaking the projection of a convex subgraph of Gis not a con vex subgraph of G. For instance the projection of the convex path bdein Figure . is the path bdewhich is not a convex subgraph of G. On the other hand we have the following result. Theorem .. LetG VEbe an expansion of a graph G VEwith respect to subgraphs G VEandG VE. The projection of a convex semicube of Gdierent from abracktltV abracktrihtandabracktltV abracktrihtis a convex semicube of G. Proof. It suces to consider the case when WuvpWuv foruvVcf. Theorem .. Let xyWuvandzVbe a vertex such that dGxz dGzy dGxy. We need to show that zWuv. Figure . A shortest path from xtoy. ixyVthe case when xyVis treated similarly. Suppose that zV. ThenxyzV and by Lemma . dGxz dGzy dGzy. SincexyWuvandWuvis convexzWuv. HencezWuv. Suppose now that zVV. Consider a shortest path PxyinGfromx toycontaining z. This path contains vertices xyVVsuch that see Figure . dGxx dGxz dGxz anddGyy dGyz dGyz. SincePxyis a shortest path in G we have dGxx dGxy dGxy d Gxy dGyy dGxy and dGxz dGzy dGxy. SincexxyV we havexxyV . BecausexyWuvandWuv is convexxWuv. HencexWuvand similarly yWuv. Since xyzV andWuvis convexzWuv. HencezWuv. iixVVandyVV. We may assume that zV. By Lemma . dGxy dGxy dGxz dGzy dGxz dGzy. SincexyWuvandWuvis convexzWuv. HencezWuv. By using the results of Lemma . it is not dicult to show tha t the class of connected bipartite graphs is closed under the expansion and contraction operations. The next theorem establishes this result for th e class of partial cubes. Theorem .. iAn expansion Gof a partial cube Gis a partial cube. iiA contraction Gof a partial cube Gis a partial cube. Proof. i LetG VE be a partial cube and G VE be its expansion with respect to isometric subgraphs G VE andG VE. By Theorem .ii it suces to show that the semicubes of Gare convex. By Lemma . the semicubes abracktltV abracktrihtandabracktltV abracktrihtare convex so we consider a semicube in the form WuvwhereuvEthe other case is treated similarly. LetPxybe a shortest path connecting two vertices in WuvandPxybe its projection to G. By Theorem . xyWuvand by Lemma . Pxyis a shortest path in G. SinceWuvis convexPxybelongs to Wuv. Letzbe a vertex inPxyandzpzPxy. By Lemma . dGzudGzvdGzudGzv. SinceGis a bipartite graph dGzu dGzv. HencePxyWuv soWuvis convex. ii LetG VE be a contraction of a partial cube G VE. By Theorem . we need to show that the semicubes of Gare convex. By The orem . all semicubes of Gare projections of semicubes of Gdistinct from abracktltV abracktrihtandabracktltV abracktriht. By Theorem . the semicubes of Gare convex. Corollary .. iA nite connected graph is a partial cube if and only if it can be obtained from Kby a sequence of expansions. iiThe number of expansions needed to produce a partial cube GfromK isdimIG. Proof. i Follows immediately from Theorem .. ii Follows from theorems . and . see the discussion in Section just before Theorem . . The processes of expansion and contraction admit useful des criptions in the case of partial cubes on a set. Let G VE be a partial cube on a set X that is an isometric subgraph of the hypercube HX. Then it is induced by some wgfamily Fof nite subsets of Xcf. Theorem .. We may assume see Section that FandFX. In what follows we present proofs of the results of Theorem . and Corol lary . given in terms of wgfamilies of sets. The expansion process for a partial cube GonXcan be described as follows LetFandFbe wgfamilies of nite subsets of Xsuch that FFatioslash FFF and the distance between any two sets PFFandQFF is greater than one. Note that abracktltFabracktrihtandabracktltFabracktrihtare partial cubes abracktltFabracktrihtabracktltFabracktriht atioslash andabracktltFabracktriht abracktltFabracktrihtabracktltFabracktrihtG. LetXXp wherep X and F QpQFFFF . It is quite clear that the graphs abracktltF abracktrihtandabracktltFabracktrihtare isomorphic and the graph GabracktltFabracktrihtis an isometric expansion of the graph G. Theorem .. An expansion of a partial cube is a partial cube. Proof. We need to verify that Fis a wgfamily of nite subsets of X. By Theorem . it suces to show that the distance between any t wo adjacent sets in Fis . It is obvious if each of these two sets belong to one of the families ForF . Suppose that PFandQp F are adjacent that is for any SFwe have PQpSPQpSPorSQp.. IfQF then PQpQPQp sincep P. By . QPimplyingdPQp . IfQFF there isRFFsuch that dPR dRQ dPQ sinceFis well graded. By Theorem . PQRPQ which implies PQpRp PQp. By .RpQp a contradiction. It is easy to recognize the fundamental sets cf. Section i n an isometric expansionGof a partial cube GabracktltFabracktriht. LetPFFandQPp F be two vertices dening an edge in Gaccording to Denition .ii. Clearly the families FandF are the semicubes WPQandWQPof the graph Gcf. Lemma . and therefore are convex subsets of F. The setFPQis the set of edges dened by pas in Lemma .. In addition UPQFFand UQPRpRFF. LetGbe a partial cube induced by a wgfamily Fof nite subsets of a set X. As before we assume that FandFX. LetPQbe an edge of G. We may assume that QPpfor somep P. Then see Lemma . WPQRFp RandWQPRFpR. LetXX pandFR pRF. It is clear that the graph G induced by the family Fis isomorphic to the contraction of Gdened by the edgePQ. Geometrically the graph Gis the orthogonal projection of the graph Galong the edge PQcf. gures . and .. Theorem .. iA contraction Gof a partial cube Gis a partial cube. iiIfGis nite then dimIG dim IG. Proof. i ForpXwe dene FRFp RFRFpR andF R p FpR. Note that FandFare semicubes of G andF is isometric to F. Hence FandF are wgfamilies of nite subsets ofX. We need to prove that FFF is a wgfamily. By Theorem . it suces to show that dPQ for any two adjacent sets PQF. This is true ifPQForPQF since these two families are well graded. For PFF andQF F the setsPandQpare not adjacent in F sinceFis well graded and Q F. Hence there is RFsuch that PQpRPQp andRatioslashP. Sincep R we have PQRPQ. SinceRatioslashPandRatioslashQ the setsPandQare not adjacent in F. The result follows. ii IfGis a nite partial cube then by Theorem . dimIG XX dim IG. Conclusion The paper focuses on two themes of a rather general mathemati cal nature. .The characterization problem. It is a common practice in mathematics to characterize a particular class of object in dierent ter ms. We present new characterizations of the classes of bipartite graphs and pa rtial cubes and give new proofs for known characterization results. .Constructions. The problem of constructing new objects from old ones is a standard topic in many branches of mathematics. For the c lass of partial cubes we discuss operations of forming the Cartesian produ ct expansion and contraction and pasting. It is shown that the class of parti al cubes is closed under these operations. Because partial cubes are dened as graphs isometrically em beddable into hypercubes the theory of partial cubes has a distinctive ge ometric avor. The three main structures on a graphsemicubes and Djokovi cs and Winklers relationsare dened in terms of the metric structure on a gr aph. One can say that this theory is a branch of discrete metric geometry. Not surprisingly geo metric structures play an important role in our treatment of the characterization and construction problems. 
5,0704.0012,"  Recently, Bruinier and Ono classified cusp forms $f(z) := \sum_{n=0}^{\infty}
a_f(n)q ^n \in S_{\lambda+1/2}(\Gamma_0(N),\chi)\cap \mathbb{Z}[[q]]$ that does
not satisfy a certain distribution property for modulo odd primes $p$. In this
paper, using Rankin-Cohen Bracket, we extend this result to modular forms of
half integral weight for primes $p \geq 5$. As applications of our main theorem
we derive distribution properties, for modulo primes $p\geq5$, of traces of
singular moduli and Hurwitz class number. We also study an analogue of Newman's
conjecture for overpartitions.
", and Results LetM N andS N be the spaces respectively of modular forms and cusp forms of weight on N with a Dirichlet character whose conductor dividesN. IffzM N thenfz has the form fz summationdisplay nanqn whereqeiz. It is wellknown that the coecients of fare related to interesting objects in number theory such as the special values of Lfunction class number traces of singular moduli and so on. In this paper we study congruence properties of the Fourier coecients of fzM NZq and their applications. Recently Bruinier and Ono proved in that gzS NZq has a special form see . by modulo pwhenpis an odd prime and the coecients of fz do not satisfy the following property for p Property A. IfMis a positive integer we say that a sequence nZsatises Property A forMif for every integer r nXnrmodM and gcdMn rMbraceleftBigg X logXifrneationslash modM X ifr modM. Mathematics Subject Classication. FF. Key words and phrases. Modular forms Congruences. D. CHOI Let fz id dzfz summationdisplay nnanqn. Using RankinCohen Bracket see . we prove that there exists tildewidefzSp NZq such thatfztildewidefz modp. We extend the results in to modular forms of half integral weight. Theorem . Letbe a nonnegative integer. We assume that fz summationtext nanqn M NZqwhereis a real Dirichlet character. If pis a prime and there exists a positive integer nfor which gcdanp andgcdnp then at least one of the following is true The coecients of pfzsatises Property A for p. There are nitely many squarefree integers nn ntfor which . pfztsummationdisplay isummationdisplay manimqnimmodp. Moreover if gcdNp and an odd prime divides some ni then p NorN. Remark .. Note that for every odd prime p pfzsummationdisplay n pnanqnmodp. As an applications of Theorem we study the distribution of traces of singular moduli modulo primes p. Letjz be the usual jinvariant function. We denote by Fdthe set of positive denite binary quadratic forms Fxy axbxycy abc with discriminant dbac. For eachFxy letFbe the unique complex number in the complex upper half plane which is a root of Fx. We dene F as F ifFaa ifFaaa otherwise where SLZ. HereFabc denotes that Fxy is equivalent to abc. From these notations we dene the Hecke trace of singular mo duli.DISTRIBUTION OF INTEGRAL FOURIER COEFFICIENTS MODULO PRIM ES Denition .. Ifm then we dene the mth Hecke trace of the singular moduli of discriminant das tmd summationdisplay FFdjmF F whereFd denotes a set of equivalence classes of Fdand jmz jzTm summationdisplay dm admdsummationdisplay bjparenleftbiggazb dparenrightbigg . HereTm denotes the normalized mth weight zero Hecke operator. Note thattd td where td summationdisplay FFdjF F is the usual trace of singular moduli. Let hz z zEz z andBmd denote the coecient of qdinhzTm where Ez summationdisplay nsummationdisplay dndqn z q productdisplay nqn andis a trivial character. Here Tm denotes the mth Hecke operator of weight with a Dirichlet chracter see VI. . in or .. Zagier proved in that for allmandd . tmd Bmd. Using these generating functions Ahlgren and Ono studied t he divisibility properties of traces and Hecke traces of singular moduli in terms of the f actorization of primes in imaginary quadratic elds see . For example they prov ed that a positive proportion of the primes has the property that tmn modps for every positive integer n coprime to such thatpis inert or ramied in Qparenleftbig nparenrightbig . Herepis an odd prime and sandmare integers with pm. In the following theorem we give the distribution of traces and Hecke traces of singular moduli modulo primes p. D. CHOI Theorem . Suppose that pis a prime such that p mod . Then for every integer rpr nXtnrmodp rpbraceleftBigg X logXifrneationslash modp X ifr modp. Then a positive proportion of the primes has the property that nXtnrmodp rpbraceleftBigg X logXifrneationslash modp X ifr modp. for every integer rpr. As another application we study the distribution of Hurwitz class number modulo primesp. The Hurwitz class number HN is dened as follows the class number of quadratic forms of the discriminant Nwhere each class Cis counted with multiplicity AutC. The following theorem gives the distribution of Hurwitz cl ass number modulo primesp. Theorem . Suppose that pis a prime. Then for every integer r nXHnrmodp rpbraceleftBigg X logXifrneationslash modp X ifr modp. We also use the main theorem to study an analogue of Newmans c onjecture for overpar titions. Newmans conjecture concerns the distribution of the ordinary partition function modulo primes p. Newmans Conjecture. LetPnbe an ordinary partition function. If Mis a positive integer then for every integer rthere are innitely many nonnegative integer nfor which PnrmodM. This conjecture was already studied by many mathematicians see Chapter . in . The overpartition of a natural number nis a partition of nin which the rst occurrence of a number may be overlined. Let Pn be the number of the overpartition of an integer n. As an analogue of Newmans conjecture the following theor em gives a distribution property of Pn modulo odd primes p. Theorem . Suppose that pis a prime such that p mod . Then for every integerr nXPnrmodp rpbraceleftBigg X logXifrneationslash modp X ifr modp. Remark .. Whenr modp Theorem and were proved in and .DISTRIBUTION OF INTEGRAL FOURIER COEFFICIENTS MODULO PRIM ES Next sections are detailed proofs of theorems Section giv es a proof of Theorem . In Section we give the proofs of Theorem and . .Proof of Theorem We begin by stating the following theorem proved in . Theorem . .Letbe a nonnegative integer. Suppose that gz summationtext nagnqn S NZqwhereis a real Dirichlet character. If pis an odd prime and a positive integer nexists for which gcdagnp then at least one of the following is true If rp then nXagnrmodp rMbraceleftBigg X logXifrneationslash modp X ifr modp. There are nitely many squarefree integers nn ntfor which . gztsummationdisplay isummationdisplay magnimqnimmodp. Moreover if gcdpN andNpis a prime withparenleftbigni parenrightbig forit then gzis an eigenform modulo pof the halfintegral weight Hecke operator T. In particular we have . gzTpparenleftbigg parenrightbiggparenleftbig parenrightbig gz modp. Recall that fz summationtext nanqnM NZq. Thus to apply Theorem . we show that there exists a cusp form tildewidefz such thattildewidefzpfz modp for a primep. Lemma .. Suppose that pis a prime and fz summationdisplay nanqnM NZq. Then there exists a cusp form tildewidefzSpp NZqsuch that tildewidefzpfz modp. Proof of Lemma .. ForFzMk N andGzMk N let . FzGzk FzGzk FzGz. This operator is referred to as a RankinCohen bracket an d it was proved in that FzGzSkk N D. CHOI where ifk andk Zd parenleftbig dparenrightbigki ifki Zandki Z and d parenleftbig dparenrightbigkk ifk andk Z. For evenk let Ekz k Bksummationdisplay nsummationdisplay dndkqn be the usual normalized Eisenstein series of weight k. Here the number Bkdenotes the kth Bernoulli number. The function Ekz is a modular form of weight konSLZ and . Epz modp see . From . and . we have Epzfzfz modp and EpzfzSp N. Repeating this method p times we com plete the proof. square Using the following lemma we can deal with the divisibility ofagn for positive integers npn wheregz summationtext nagnqnS NZq. Lemma . see Chapter in .Suppose that gz summationtext nagnqnS N has coecients in OK the algebraic integers of some number eld K. Furthermore suppose that and that m OKis an ideal norm M. Then a positive proportion of the primes Q mod MNhas the property that gzTQ mod m. Then a positive proportion of the primes Q mod MNhas the property that gzTQgz mod m. We can now prove Theorem . Proof of Theorem . From Lemma . there exists a cusp form tildewidefzSpp NZq such that tildewidefzpfz modp. Note that for Fz summationtext naFnqnMk N and each prime QN the halfintegral weight Hecke operator TQ is dened as . FzTQk summationtext nparenleftBig aFQn QparenleftBig n QparenrightBig QkaFn QQkaFnQparenrightBig qnDISTRIBUTION OF INTEGRAL FOURIER COEFFICIENTS MODULO PRIM ES wheren nparenleftBig k nparenrightBig andaFnQ ifQn. IfFzTQk modp for a prime QN then we have aFQQn QparenleftbiggQn Qparenrightbigg QkaFQn QQkaFparenleftbig QnQparenrightbig aFQn modp for every positive integer nsuch that gcd Qn . Thus we have the following by Lemma . nXan modp and gcdpn X. We apply Theorem . with tildewidefz. Then the purpose of the remaining part of the proof is to show the following if gcd pN an odd prime divides some ni and . pfztsummationdisplay isummationdisplay manimqnimmodp thenp NorN. We assume that there exists a prime such thatn p NandN. We also assume that nt and that ninfor every i it. Then we can take a prime ifor eachi it such that ini andin. For convention we dene parenleftBign parenrightBig braceleftBigg nifnis odd otherwise andQd parenleftBig d QparenrightBig for a prime Q. Letd producttextt iid.We take a prime such that nn . If we denote the twist oftildewidefz bytildewidefz and thetwist oftildewidefz bytildewidefz then tildewidef ztildewidefzsummationdisplay gcdmQ jjanmqnmmodp andtildewidefzSpp NZq see Chapter in . Note that gcdNp gcdN . Thus tildewidefztildewidefzT p p satises the formula . of Theorem . for both of and. This results in a contradiction since tildewidefztildewidefzT p pneationslash modp andp. Thus we complete the proof. square D. CHOI .Proofs of Theorem and ..Proof of Theorem . Note thathz z zEz zis a meromorphic modular form. In it was obtained a holomorphic modular form on p whose Fourier coecients generate traces of singular moduli modulo psee the formula . and .. Since the level of this modular form is not relatively prime to p we need the following proposition. Proposition . .Suppose that pis a prime. Also suppose that pNjis an integer and gz summationdisplay nanqnS NpjZq. Then there exists a cusp form GzS NZqsuch that Gzgz modp where pjpepfor a suciently large eN. Using Theorem and Proposition . we give the proof of Theo rem . Proof of Theorem . Let . hpz hzparenleftbigg pparenrightbigg hpz wherehpz is theptwist ofhz. From . we have hpz summationdisplay d mod pdtdqdsummationdisplay d mod d ptdqd and hmpz hpzTm summationdisplay d mod pdtmdqdsummationdisplay d mod d ptmdqd for every positive integer m. Let Fpz zp pz. It was proved in that if is a suciently large positive integer then hpzFpz M kp and . hpzFpzhpz modpDISTRIBUTION OF INTEGRAL FOURIER COEFFICIENTS MODULO PRIM ES wherekp . Lemma . and Proposition . imply that there exists fpz S Zq such that fpz summationdisplay d mod d ptmdqdmodp where k pp ppep for a suciently large eN. We assume that the coecients of fpz do not satisfy Property A for an odd prime p mod . Note thatparenleftBig pparenrightBig and thatp. So Theorem implies that t modp. This results in a contradiction since t . Thus we obtain a proof when m . For every odd prime we have fpzTphpzT phpzTphpz modp. Moreover Lemma . implies that a positive proportion of th e primessatises the property fpzTfpmodp. This completes the proof. square ..Proofs of Theorem . The following theorem gives the formula for the Hurwitz class number in terms of the Fourier coecients of a modular f orm of half integral weight. Theorem .. LetTz summationtext nqn. If integers rnare dened as summationdisplay nrnqnTz then rn Hnifn mod Hnifn mod rn ifn mod ifn mod . Note thatTz is a half integral weight modular form of weight on . Combining Theorem and Theorem . we derive the proof of Theorem . Proof of Theorem . LetGz be theparenleftbigparenrightbig twist ofTz. Then from Theorem . we have Gz summationdisplay n mod Hnqnsummationdisplay n mod Hnqn D. CHOI andGzM . Note that H . This gives the complete proof by Theorem . square ..Proofs of Theorem . In the following we prove Theorem . Proof of Theorem . Let Wz z z. It is known that Wz summationdisplay nPnqn and thatWz is a weakly holomorphic modular form on . Let Gz parenleftbigg Wzparenleftbigg pparenrightbigg Wpzparenrightbigg Fpzp whereFpz zp pzandare positive integers. Then we have Gzsummationdisplay n n pPnqnsummationdisplay n pnPnqnmodp. We claim that there exists a positive integer such thatGz is a holomorphic modular form of half integral weight on p. To prove our claim we follow the arguments of Ahlgren and Ono Lemma .. Note that by a wellknow n criterion Fpz is a holomorphic modular form on p that vanishes at each cuspa cQfor whichpc see . This implies that Gz is a weakly holomorphic modular form on p. If is suciently large then Gz is holomorphic except at each cuspa cfor whichpc. Thus we prove that Gz is holomorphic at mpfor m. Let for odd d dbraceleftBigg ifd mod iifd mod . Iffz is a function on the complex upper half plane Z and a b c d then we dene the usual slash operator by fz parenleftBigc dparenrightBig dczd fparenleftbiggazb czdparenrightbigg . Letgsummationtext vparenleftBig v pparenrightBig eivpbe the usual Gauss sum. Note that Wpz g ppsummationdisplay vparenleftbiggv pparenrightbigg Wz parenleftbigvp parenrightbig . Choose an integer kvsatisfying kvvmodp.DISTRIBUTION OF INTEGRAL FOURIER COEFFICIENTS MODULO PRIM ES Then we have .parenleftBigg v p parenrightBiggparenleftBigg mpparenrightBigg vmparenleftBigg mpparenrightBiggparenleftBigg v pkv p parenrightBigg where vmparenleftBigg mpvkv mvpmvkvp pvkvmvpvkvp mpvp kvp mvpmkvp parenrightBigg . Note that Wz has its only pole at z up to . Since vm the formula . implies that Wpz is holomorphic at mpfor m. ThusGz is holomorphic at mpfor m. Ifm then we have Wz vparenleftbiggvp kvp vpkvp parenrightbigg Wz parenleftbiggpvpkvp vpkvp parenrightbigg Wz Wz. Note that . Wz parenleftbig pparenrightbig q O whereis a nonzero complex number. The qexpansion of Wpz at pis given by . Wpz parenleftbig pparenrightbig . Using . and . the only term in . with a negative e xponent on qis the term g pq psummationdisplay vparenleftbiggv pparenrightbigg ei pvkv. If N is dened by N modp then we have g pq psummationdisplay vparenleftbiggv pparenrightbigg ei pvkvg pq psummationdisplay vparenleftbiggv pparenrightbigg ei pNvg pq parenleftbigg pparenrightbigg q . Thus we have that WzWpz parenleftbig pparenrightbig O. This implies that Gz is a holomorphic modular form of half integral weight on p. Noting that P the remaining part of the proof is similar to that in Theorem . Thus it is omitted. square D. CHOI 
6,0704.0013,"  Serre obtained the p-adic limit of the integral Fourier coefficient of
modular forms on $SL_2(\mathbb{Z})$ for $p=2,3,5,7$. In this paper, we extend
the result of Serre to weakly holomorphic modular forms of half integral weight
on $\Gamma_{0}(4N)$ for $N=1,2,4$. A proof is based on linear relations among
Fourier coefficients of modular forms of half integral weight. As applications
we obtain congruences of Borcherds exponents, congruences of quotient of
Eisentein series and congruences of values of $L$-functions at a certain point
are also studied. Furthermore, the congruences of the Fourier coefficients of
Siegel modular forms on Maass Space are obtained using Ikeda lifting.
", and Statement of Main Results In Serre obtained the padic limits of the integral Four ier coecient of modular forms onSLZ forp . In this paper we extend the result of Serre to weakly holomorphic modular forms of half integral weight on N forN . A proof is based on linear relations among Fourier coecients of mod ular forms of half integral weight. As applications congruences of Borcherds exponent s congruences of values of L functions at a certain point and congruences of quotient of E isentein series are obtained. Furthermore the congruences of the Fourier coecients of S iegel modular forms on Maass Space are obtained using Ikeda lifting and . First we need some notations to state the main theorems. Let for oddd by dbraceleftigg ifd mod iifd mod NtN t t and angbracketleftbigparenleftbight parenrightbigangbracketrightbig Nt t Mathematics Subject Classication. FF. Key words and phrases. Modular forms padic limit Congruences Borcherds exponents Lfunctio ns Maass space . This work was partially supported by KOSEF R and ITRC. D. CHOI AND Y. CHOIE wheret a b c d such that tt . Denote the qexpansion of a modular form fM N at each cusp tof N by . f tz parenleftigc dparenrightig dczd fparenleftbiggazb czdparenrightbigg qr tsummationdisplay nbtat fnqn t qtqiz ht. Whent we denote a fn byafn. A cusptis called a regular cusp if r . Let UNt tNbe the set of the inequivalent regular cusps of N. Note that the genus of N is zero if and only if N. Let M N be the space of weakly holomorphic modular forms of weight on N andM N denote the set offz M N whose the constant term of qexpansion at each cusps is zero. Dene an operator Upforfz summationtext nnafnqnby fzUpsummationdisplay nnafpnqn. With these notations we state the following theorem. Theorem . Suppose that pis a prime and that N or. Let fz summationdisplay nnafnqn M NZpq where Zpdenotes the ring of padic integers. Ifp andaf then for each jN there exists a positive integer bsuch that fzUpb modpj. Ifpandfz M Nwithor bracketleftbig Nbracketrightbig modp then for eachjN there exists a positive integer bsuch that fzUpb modpj. Remark .. In the padic limit of a certain sum of Fourier coecients is obtaine d when the weight of a modular form is . Let Nbe the unique normalized modular form of weight on N with the zero of the maximum order at . Further let Rz z z Rz z z Rz zz zzandRz z zpADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS wherez q producttext nqn. Dene for nN mn braceleftigg ifbracketleftbign bracketrightbig mod ifbracketleftbign bracketrightbig mod and n n bracketleftbiggn bracketrightbigg . It turns out that the congruence properties of fz are more complicated if fzeatioslash M N. Theorem . Suppose that pis a prime and N. Let fz summationdisplay nafnqn M NZpqq. Ifor bracketleftbig Nbracketrightbig modp then there exists a positive integer bsuch that afparenleftbig pbmpparenrightbig summationdisplay tUNhtat Npz RNzeNat f mod p for every positive integer bb . Example .. An overpatition of n is a partition of nin which the st occurrence of a number may be overlined. Let Pn be the overpartition of n. It is known that summationdisplay nPnqnz z and thatz z M . From Theorem we have Pb mod for every positive integer b. .Applications More Congruences of Modular Forms of Half Int egral Weight In this section we study several results related to padic limit of Borcherds exponents congruence relations of values of Lfunctions and congruences of quotients of Eisenstein series which are derived from Theorem and . D. CHOI AND Y. CHOIE ..padic Limits of Borcherds Exponents. As the rst application we obtain con gruences of Borcherds exponents. Let MHdenote the set of integer weight meromorphic modular forms on SLZ with a Heegner divisor integer coecients and leading co e cient . Let M fz summationdisplay nmafnqn M an forn mod . Iffz summationtext nnafnqn M then dene fz by fz qhproductdisplay nqnafn whereh af summationtext n mod afnHn andHn denotes the usual Hur witz class number of discriminant n. Borcherds proved that the map is an isomor phism. Theorem . .The map is an isomorphism from M toMH and the weight of fzisaf. Letjz be the usual jinvariant function. We denote the product expansion of jz by jz qproductdisplay nqnAn. LetFz qhproducttext nqncnbe a meromorphic modular form of weight kinMH. The padic limit ofsummationtext dndcd was studied in for p . In the following theorem we obtain the padic limit of cd forp . Theorem . LetFz qhproducttext nqncnbe a meromorphic modular form of weight kinMH. Ifp then for each jN there exists a positive integer bsuch that cmpbkmodpj for every positive integer m. Ifp then for for each jN there exists a positive integer bsuch that cmpbFAmpbkmodpj for every positive integer m. HereFis a constant determined by the constant term ofqexpansion of Fat.pADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS ..Sums ofnSquares. As the second application we study congruences of represen tation numbers of the sums of nsquares. Let for uZ rnu s snZns s nu. Theorem . Suppose that pis a prime. If or modp then there exists a positive integer Csuch that for every integer bC rparenleftbig pbmpparenrightbig p parenleftbigg pparenrightbigg ppmp modp. Remark .. For example if modp andpis a odd prime then there exists a positive integer Csuch that for every integer bC rparenleftbig pbparenrightbig modp. ..Values ofLFunctions. Thirdly we derive congruences among values of Lfunctions at a certain point. Let Dbe a fundamental discriminant and Dn parenleftbigD nparenrightbig . The Dirichlet Lfunction of Dis dened by LsD summationdisplay nDn ns. In Carlitz studied an analog of the StaudtClausen theo rem forLm D modulo primep wherepepmandpD. The value of Lp D modulopwas also studied in where D p pNis a fundamental discriminant andparenleftig N pparenrightig . We now give the values of Lp modulo primes p. Theorem . Letpbe a prime and pn parenleftbigg p p nparenrightbigg . Ifp modp then Lp B modp. ..Quotients of Eisenstein Series. Congruences among the coecients of quotients of Eisentein series have been studied in . Let Hr z summationtext NHrNqndenote the Cohen Eisenstein series of weight r wherer is an integer. We derive congruences for the coecients of quotients of CohenEisentein series a nd Eisentein series. Theorem . Let Fz H z Ezsummationdisplay naFnqn Gz H z Ezsummationdisplay naGnqn D. CHOI AND Y. CHOIE and Wz H z Ezsummationdisplay naWnqn. Then there exists a positive integer Csuch that aFb mod aGb mod aWb mod for every integer bC . ..Maass Space. Next we deal with congruences of the Fourier coecients of a S iegel modular form in Maass space. To dene Maass space we follow n otations given in . LetTMgQ be a rational halfintegral symmetric nondegenerate matrix of size nand DT gdetT be the discriminant of T. ThenDT mod and we write DTDTf T where DTis the corresponding fundamental discriminant. Let G andGbe the upper submatrix of G. Let Sbraceleftigg GLg circleplustextifg mod GLg circleplustextGifg mod . FormN the set of natural numbers N with gm mod dene a rational halfintegral symmetric positive denite matrix Tmof size gby Tm parenleftigg Ss mparenrightigg ifm mod parenleftigg Ss eg e gm nparenrightigg ifmgmod whereeg ...Znis the standard column vector and e gdenotes the transpose of eg. Following Kohnen and Kojima see we dene the Maass space of weight gkand genus g which is realized as the image of Ikeda lifting.pADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS Denition .. Maass Space Suppose that g mod and let kNwithgk mod . Let SMaass kgg FZ summationdisplay TATqtrTZSkggvextendsinglevextendsinglevextendsinglevextendsinglevextendsinglevextendsingleAT summationdisplay afTakaTATDTa see . for more detailed notations. This space is calle d as a Maass space of genus g and weight nk. Recently it was proved in that Maass space is the same as t he image of Ikeda lifting when g mod . Using this fact with Theorem we derive the follow ing congruences of the Fourier coecients of FZ inSMaass kgg. Theorem . Suppose that g mod . Let FZ summationdisplay TATqtrTZSMaass kgg with an integral ATT . Ifkor modp for a prime p then for each jN there exists a positive integer bfor which AT modpj for everyT withdetT modpb. This paper is organized as follows Section gives a linear r elation among the Fourier coecients of modular forms of half integral weight. Using t his result in Section we prove Theorem and . In Section we give a proof of Theorem . We prove Theorem and in Section . .Linear Relation among the Fourier Coecients of modular for ms of Half Integral Weight LetVNkn be the subspace of Cngenerated by the rst ncoecients of qexpansion offatforfSkN whereSkN denotes the space of cusp forms of weight kZon N. LetLNkn be the orthogonal complement of VNkn inCn with the usual inner product of Cn. The vector space Lkdk was studied by Siegel when the value of Dedekind zeta function at a certain p oint was computed where dk dimSk. The vector space Lkn is explicitly obtained by the principal part of negative weight modular forms in . These results w ere extend in to groups D. CHOI AND Y. CHOIE N of genus zero. Let for N EVparenleftbigg N nparenrightbigg braceleftigparenleftig at f atN faf afnparenrightig CnnvextendsinglevextendsinglevextendsinglefM Nbracerightig whereUNt tNis the set of the inequivalent regular cusps of N. We deneELN n to be the orthogonal complement of EVN n inCnN. Note thatRNzMN has its only zero at . So the valence formula see implies that . . For eachgMr N andeN let .gz RNzeeNsummationdisplay bNeg qO at . With these notations we state the following theorem Theorem .. Suppose that is an integer and N. For each eN such thate taker e . The linear map reN Mr N ELN eN dened by reNg parenleftbigg htat gz RNze htNatN gz RNzebNeg bNeg eNparenrightbigg is an isomorphism. Proof of Theorem .. Suppose that Gz is a meromorphic modular form of weight on N. ForHCN letDbe the image of under the canonical map from HCN to a compact Riemann surface XN. Here His the usual complex upper half plane andCNdenotes the set of all inequivalent cusps of N. The residue Res DGdzof Gz atDXN is welldened since we have a canonical correspondence be tween a meromorphic modular form of weight on N and a meromorphic form of XN. IfRes Gdenotes the residue of GatonH then ResDGdz lRes G. Herelis the order of the isotropy group at . The residue of Gat each cusp tCNis . Res DtGdzhtat G ipADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS where Gtz czdGparenleftbigazb czdparenrightbig summationtext nmtat Gnqn tfort a b c d such that tt andhtdenotes the smallest positive integer such that Gtzht G tz andqteiz ht. Now we give a proof of Theorem .. To prove Theorem . take Gz gz RNzefz wheregMr N andfz summationtext nafnqnM N. Note that Gz is holomorphic on H. SincegzRNz andfz are holomorphic and RNz has no zero on H it is enough to compute the residues of Gz only at the inequivalent cusps to apply the Residue theorem. The qexpansion ofgz RNzefz atis gz RNzefz eNsummationdisplay bNeg qa gz RNze Oq parenleftiggsummationdisplay nafnqnparenrightigg . SinceRNz has no zero at t we have gz RNzefzvextendsinglevextendsinglevextendsinglevextendsingle tat gz RNzeaf Oqt. Further note that for an irregular cusp t at gz RNzeaf . So we have .summationdisplay tUNhtatg ReN Nat f eNsummationdisplay bNeg af . by the Residue Theorem and .. This implies that reN is welldened. The linearity of the map reN is clear. It remains to show that reN is an isomorphism. Since there exists no holomor phic modular form of negative weight except the constantly z ero function we obtain the injectivity of reN. Note that for e dim Cparenleftbigg ELparenleftbigg N eNparenrightbiggparenrightbigg eN UN dim Cparenleftig M Nparenrightig . However the set CNof inequivalent cusps of N are for N Cbraceleftbig bracerightbig Cbraceleftbig bracerightbig Cbraceleftbig bracerightbig Cbraceleftbig bracerightbig D. CHOI AND Y. CHOIE and it can be checked that . U U UU for detail see Chapter . in . We recall the dimension f ormula ofM N for N Table . Dimension Formula for MkN Nk n k n k n N n n n N n n n N n n n N n n n So we have by . . and Table dim Cparenleftbigg ELparenleftbigg N eNparenrightbiggparenrightbigg dim CMr N sincer e . This implies that reN is surjective since the map reN is injective. This completes the proof. square .Proofs of Theorem and ..Proof of Theorem . First we get linear relations among the Fourier coecients of modular forms of half integral weight modulo primes p. Let tildewiderM pN Hz summationdisplay naHnqnZppZpq Hhmodp for somehZpqM N. and tildewideS pN Hz summationdisplay naHnqnZppZpq Hhmodp for somehZpqS N. The following lemma gives the dimension of tildewiderM pN. Lemma .. Suppose that is a positive integer and N. Letpbe a prime such that braceleftigg pifN pifN . Then dimtildewiderM pN dimM NpADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS and dimtildewideS pN dimS N. Proof. Let jNz qOq be a normalized meromorphic modular function with a pole onl y at. Explicitly they are jz z z j z z zz jz zz zz j z zz zz . Since the Fourier coecients of z and zare integral the qexpansion of jNz has integral coecients. Recall that Nis the unique normalized modular form of weight on N with the zero of the maximum order at . Denote the order of zero of Natby N. Then the basis of M N can be chosen as . NzjNzeeN. If Nz ispintegral then NzjNzeeNforms also a basis of tildewiderM pN. Note that N dimM N. So we have from Table . Nz NjzRNzj wherejmod for j . One can choose Njz as the following z zz z z zz zzz z zz parenleftigsummationtext xyzZqxyzyzsummationtext xyzZqxyzyzparenrightig z zzz zzz zzz. Sincez summationtext nqn the coecients of the qexpansion of Njzj are pintegral. This completes the proof with . and .. square Remark .. The proof of Lemma . implies that the spaces of M N for N are generated by etaquotients since z z zz. For N denote tildewiderVSparenleftbigg N nparenrightbigg braceleftig af afnFn pftildewideS Nbracerightig D. CHOI AND Y. CHOIE where FpZppZp. We denetildewiderLSN n to be the orthogonal complement of tildewiderVSN n inFn p. Using Lemma . we obtain the following proposition. Proposition .. Suppose that is a positive integer and N. For each eN e taker e . The linear map tildewidestreN tildewiderMr NtildewiderLSN eN dened by tildewidestreNg bNeg bNeg eN is an isomorphism. Here bNeg is given in .. Proof. Note that dim S N and that dimS N N bracketleftbiggN bracketrightbigg dimM N see . So from Lemma . and Table it is enough to show t hatreN is injective. Ifgis in the kernel of reN thengz RNzeRNze modp by the Sturms formula see . So we have gz modp sinceRNzeeatioslash modp. This completes our claim. square Theorem .. Suppose that pis a prime and that N or. Let fz summationdisplay nafnqnS NZpq. Ifor bracketleftbig Nbracketrightbig modp orp then there exists a positive integer bsuch that for every positive integer n afparenleftbig npbparenrightbig modpnN. Proof of Theorem .. iFirst suppose that p Take a positive integer andbsuch that .p pbparenleftbigg parenrightbigg pmpp . Moreover if blogpparenleftig pparenleftbig parenrightbig pmpparenrightig then there exists a positive integer satisfying .. Note that at f for every cusp tof N since the given function fz is a cusp form. So if r ep then Theorem . implies that for every gztildewiderMr N eNsummationdisplay bNeg afpbmp modppADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS since parenleftbigggz RNzeparenrightbiggpb fzpmpE pz eNsummationdisplay bNeg qpba gz RNze summationdisplay na gz RNzenqnpb parenleftiggsummationdisplay nafnqnpmpparenrightigg modp. So we have by Proposition . that parenleftbig aparenleftbig pbmpparenrightbig aparenleftbig pbmpparenrightbig aparenleftbig eNpbmpparenrightbigparenrightbig tildewiderVSparenleftbig Np nparenrightbig . Ifp or bracketleftbig Nbracketrightbig then dimSp N tildewiderVSparenleftbigg Np nparenrightbigg . iiWe assume that p Note thatNz RNzqO forN . So there exist a polynomial FXZX such that FjNzNz RNzqnO. For an integer b b let Gz parenleftbigg FjNzNz RNzparenrightbiggb fzzb. Sincez mod Theorem . implies that afbn mod . Therefore we completes the proof. square Remark .. In the proof of Theorem . the case when p can be also treated as the same as the case of p . However one gets more structure information about fzUp following the given proof. To apply Theorem . we need the following two propositions . Proposition . .Suppose that pis an odd prime kandNare integers with Np andis a Dirichlet character modulo N. Let fz summationdisplay anqn M N. Suppose that that parenleftbiga b cpdparenrightbig withac . then there exists an integer n a sequence annn a positive integer hN and anr such that for each m D. CHOI AND Y. CHOIE we have fzUpm summationdisplay nn nr mod pmanqnr hpm. Proposition . .Suppose that pis an odd prime. Suppose that pN thatj is an integer and that gz summationdisplay nanqnS NpjZq. Then there is a cusp form GzS NZqsuch that Gzgz modp where pjpepfor enough large eN. Remark .. In Proposition . is proved for p. But one can check by following the method given in that Proposition . holds when p . Now we prove Theorem . Proof of Theorem . Let Gpz z zM ifp z zM if p zp pzMp p ifp. By the well known properties of etaquotients see and Proposition . there exit positive integers msuch that braceleftigg fzUpmGpzSk ifp fzUpmGpzSk p ifp Using Proposition . we nd FzSk N such thatFzfzUpmGpzfzUpm modp. Theorem . implies that there exist a positive integer bsuch thatFzUpb modp. So we have that pFzUpmbZqq. Repeating this method we obtain the result. squarepADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS ..Proof of Theorem . Using Theorem . with a special modular form we prove Theorem . Proof of Theorem . We take a positive integer and a positive odd integer bsuch that p pbparenleftbigg parenrightbigg pmpp . LetFz parenleftigNpz RNzparenrightigpb andGz Epzfzpmp. Since that Ep modp we have FzGzparenleftiggsummationdisplay naNpz RNznqnpbparenrightiggparenleftiggsummationdisplay nmat fnqnparenrightigg modp. We claim that the Fourier coecients of fz at each cusps are pintegral. Then we have FGtzparenleftigg qr tsummationdisplay nmtat Fnqn tparenrightiggparenleftigg qr tsummationdisplay nat Gnqn tparenrightigg parenleftigg qr tsummationdisplay nmtat fnqn tparenrightiggparenleftigg qr htpusummationdisplay nat Npz RNznqn htpuparenrightigg modp fort. Ifuis large enough then aFzGzaNpz RNzaf afpu mod p at FzGzat Npz RNzat f mod p fort. Then using the Residue theorem again we completes the proo f. We check the claim. Let z qproducttext nqn. Note that z is a cusp form of weight on . So we may take a positive integer esuch that zefz is a holomorphic modular form. Note that the qexpansion of jNz and Nez at each cusps arepintegral. Then we have zefz eNsummationdisplay ncnjNznNez by the formula .. Moreover cnispintegral since jNznNez qeNnOparenleftbig qeNnparenrightbig andfzZpqq. Note that pNsince N andp is a prime. So the Fourier coecients of jNz Nez and zat each cusps are pintegral. This completes the proof. square D. CHOI AND Y. CHOIE .Proof of Theorem Using Theorem and Theorem . we prove Theorem . Proof of Theorem . Note thatjz M H. Let gz jz andfz Fz summationdisplay nnafnqn. It is known see in that gz d dzzEz izzd dzEz iz z. Since the constant terms of qexpansions at offzkz andgz are zero and a z i we have fzkza f ki a ggz M . Herea g is dened by .. By Theorem we completes the proof. square .Proofs of Theorem and We begin by introducing the following proposition. Proposition .. Letpbe an odd prime and fz summationdisplay nafnqnM Zpq. Ifor modp then afparenleftbig pbmpparenrightbig paf parenleftbig iparenrightbigpbpa f mod p for every integer blogpparenleftig pparenleftbig parenrightbig pmp parenrightig . Proof of Proposition .. Note that the given function fz summationtext nafnqnis a modular form of weight where or modp . So let parenleftbigg parenrightbigg pmpp p forZ. For every integer b b logpparenleftbigg pparenleftbiggparenleftbigg parenrightbigg pmpparenrightbiggparenrightbigg pADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS there exist an positive integer such that p pbparenleftbigg parenrightbigg pmpp since p pbparenleftbigg parenrightbigg pmp p pb p. We have Fzsummationtext nafnqnpmpmodp Gzqpb p aGq modp. NoteaGn ispintegral for every integer n. Moreover we obtain FzGz parenleftbig a f parenrightbigparenleftigg pbparenleftbigg i parenrightbiggpbp parenrightigg modp wherea f is given in .. Note thatbraceleftbig bracerightbig is the set of distinct cusps of and that is a irregular cusp. So Theorem implies that that afpumpn pafa fparenleftbigg i parenrightbiggpbp modp. This gives a proof of Proposition .. square ..Proof of Theorem . Now we prove Theorem . Proof of Theorem . Letz summationtext nq. To use Theorem . take fz z summationdisplay rqsummationdisplay nafnqn. Note thatzM . Since z i Oparenleftig q parenrightig we obtain af and a f parenleftbigg i parenrightbigg . Since modp andparenleftbig i parenrightbig we have parenleftbigg i parenrightbiggpup a fpmp parenleftbigg i parenrightbiggpupparenleftbigg i parenrightbiggpmppp pmp parenleftbigg i parenrightbiggppuparenleftbigg i parenrightbiggp pmppmpppmp p parenleftbigg i parenrightbigg ppppmp parenleftbigg pparenrightbigg ppmp modp D. CHOI AND Y. CHOIE whereuis a positive integer. Applying Theorem . we derive the re sult. square ..Proofs of Theorem and . A modular form Hr z summationtext NHrNqn denotes the Cohen Eisenstein series of weight r wherer is an integer. If rN mod then HrN . IfN then Hr Br r. IfNis a positive integer and Df rN whereDis a fundamental discriminant then . HrN LrDsummationdisplay dfdDddrrfd. Hered is aMobius function. The following theorem implies that the Fourier co e cients of Cohen Eisenstein series Hr z arepintegral ifp r. Theorem . .LetDbe a fundamental discriminant. If Dis divisible by at least two dierent primes then LnDis an integer for every positive integer n. IfDpp thenLnDis an integer for every positive integer nunless gcdpDggneatioslash wheregis a primitive root modp. UsingHr z we give proofs of Theorem and . Proof of Theorem . We takefz H z summationtext nafnqn. Then the Fourier coe cients offz arepintegral by Theorem . and by the assumption that p . Note that afpn Lpsummationdisplay dpndpndpnd af B anda f B parenleftbig iparenrightbig i. We have parenleftbig iparenrightbigppa fparenleftbig iparenrightbigpB parenleftbig iparenrightbig i parenleftbigg iparenleftbigg pparenrightbiggparenrightbiggB parenleftbigg iparenleftbigg pparenrightbiggparenrightbigg iparenleftbigg pparenrightbigg B modp. So we obtain Lp B modp. SinceLp andB are apintegral rational number this completes the proof. squarepADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS Proof of Theorem . Note that Ez EzEz. So the functions EzFz EzGz andEzWz are a modular form of weight and respectively. Moreover the Fourier coecients of those are integral since the Fourier coecients of H zH z andH z are integral by Theorem .. We have EzFz B Oq EzFz B iiOparenleftig q parenrightig EzGz B Oq EzGz B iiOparenleftig q parenrightig EzWz B Oq EzWz B iiOparenleftig q parenrightig whereBris the rth Bernoulli number. The conclusion follows by Theorem .. square ..Proofs of Theorem . We begin by introducing some notations. Let V Fn pQ be the quadratic space over Fp whereQis a quadratic form obtained from a quadratic formxmastoTxxZn p by reducing modulo p. We denote by xy Qxy QxQyxyFn p the associated bilinear form and let RV xFn pxy yFn p Qx be the radical of RV. Following dene a polynomial HnpTX ifsp producttextsp j pjX if sp spodd pTpspXproducttextsp j pjX ifsp speven where for even spwe denote pT braceleftigg ifWis a hyperbolic space or sp n otherwise . Following for a nonnegative integer deneTp by summationdisplay TpXbraceleftigg XHnpTXifpfT otherwise . We extend the functions Tmultiplicatively to natural numbers Nby dening summationdisplay TpXproductdisplay pfpXHnpTX. Let DT GLnZ GMnZGLnQ TG halfintegral D. CHOI AND Y. CHOIE whereGLnZ operates by leftmultiplication and TG TGT. Then DT is nite. ForaNwithafTlet . aT asummationdisplay dasummationdisplay GDTdetGdTGad. Note thataTZfor alla. With these notations we state the following theorem Theorem . .Suppose that g mod and letkNwithgkmod . A Siegel modular form Fis inSMaass kngif and only if there exists fz summationdisplay ncnqnSk such thatAT summationtext afTakaTcparenleftig DT aparenrightig for allT. Here DT gdetT andDTDTf TwithDTthe corresponding fundamental discriminant and fTN. Remark .. The proof of Theorem . in implies that if ATZfor allT then cmZfor allmN. Proof of Theorem . From Theorem . we can take fz summationdisplay ncnqnSk Zpq such that FZ summationdisplay TATqtrTZsummationdisplay Tsummationdisplay afTakaTcparenleftbiggDT aparenrightbigg qtrTZ. From Theorem there exists a positive integer bsuch that for every positive integer m cpbm modpj sincek or modp . Suppose that pbjDT. IfpjaandafT then akaTcparenleftbiggDT aparenrightbigg modpj. IfpjaandafT thenpbvextendsinglevextendsinglevextendsingleDT aandakaTcparenleftig DT aparenrightig modpj.This completes the proof. squarepADIC LIMIT OF WEAKLY HOLOMORPHIC MODULAR FORMS 
7,0704.0017,"  Results from spectroscopic observations of the Intermediate Polar (IP) EX Hya
in quiescence during 1991 and 2001 are presented. Spin-modulated radial
velocities consistent with an outer disc origin were detected for the first
time in an IP. The spin pulsation was modulated with velocities near ~500-600
km/s. These velocities are consistent with those of material circulating at the
outer edge of the accretion disc, suggesting corotation of the accretion
curtain with material near the Roche lobe radius. Furthermore, spin Doppler
tomograms have revealed evidence of the accretion curtain emission extending
from velocities of ~500 km/s to ~1000 km/s. These findings have confirmed the
theoretical model predictions of King & Wynn (1999), Belle et al. (2002) and
Norton et al. (2004) for EX Hya, which predict large accretion curtains that
extend to a distance close to the Roche lobe radius in this system. Evidence
for overflow stream of material falling onto the magnetosphere was observed,
confirming the result of Belle et al. (2005) that disc overflow in EX Hya is
present during quiescence as well as outburst. It appears that the hbeta and
hgamma spin radial velocities originated from the rotation of the funnel at the
outer disc edge, while those of halpha were produced due to the flow of
material along the field lines far from the white dwarf (narrow component) and
close to the white dwarf (broad-base component), in agreement with the
accretion curtain model.
", EXHya is anIntermediate PolarIPa subclass of magnetic Cat aclysmic Variable Stars mCVs where a latetype main seque nce star transfers material to the magnetic white dwarf star as t he two stars orbit each other under the inuence of their mutual gra v itation. Unlike in Polars another subclass of mCVs where t he white dwarf is in synchronous rotation with the binary rotat ion PspinPorbthe whitedwarf inan IPisinasynchronous rotation with the orbital motion of the system. EX Hya however is nea rer synchronismthanthemajorityofIPsasithasaspinperiod . min which is about its orbital period . min Mumford Hellier etal. and is one of only six out of thirty nine conrmedIPswithitsorbitalperiodbelowthehCVperiod gap Nortonet al. .It has aninclination i. Recent studies have shown that EX Hya does not conform to the traditional IP model King Wynn Wynn Belleet al. Nortonet al. Belleet al. . This sys Email ncebacircinus.ast.uct.ac.zatem has a large PspinPorbratio . implying that it can not be in the usual spin equilibrium rotation since most IPs have been shown to attain spin equilibrium near PspinPorb . KingWynn Wynn . This further implies that the corotation radius is far greater than the circularisati on radius RcoRcir and that EX Hya cannot possess a Keplerian disc. Systems with Keplerian discs are expected to have RcoRcirand thus a smaller PspinPorb. These factors have prompted theorists to suggest that the spin equilibrium state in EX Hya is determin ed byRcob wherebis the distance to the inner Lagrangian point LKing Wynn Wynn Norton etal. . In this model the accretion curtains extend to near the Lpoint and EX Hya resembles an asynchronous Polar where most of the materi al accretes viathe streamKing Wynn Wynn andvia both the ringof material near the Roche lobe radius of the pri mary and the stream Norton etal. depending on the orbital and spin periods of the system and the magnetic eld strength. I n the later publication it was shown that material in EX Hya is fed f rom a ring of material at the outer edge of the Roche lobe and that for ccirclecopyrt RASN. MhlahloD.A.H.Buckley V.S.DhillonS.B.PotterB. Wa rnerandP.A.Woudt Date HJDstart Time Spectra . . . . . . . . . . . . . . . . Table.Tableofspectroscopic observations duringquiescence in and . The column Datedenotes the date at the beginning of the observing nightbeforemidnight thecolumn Timedenotes thenumber ofobserving hours and Spectrathe number of spectra obtained. thePspinPorbof EX Hya this mode of accretion is preferred over streamfedaccretion. In this work we present spectroscopic data of EX Hya in qui escenceobtainedfromtheSAAOinjustbeforeEXHyawen t intooutburstandadayortwoafteroutburstandin.Ou tburst data of willbe discussed ina laterpublication. OBSERVATIONSAND DATA REDUCTION . Observations EX Hya was observed in April of by Buckley et al. usingtheSAAO.mtelescope withtheReticonphotoncount ing system RPCSdetector on the Cassegrainspectrograph. A gr ating with a resolution of mmwas used and a wavelength range of A was covered at a spectral resolution of . A and at a time resolution of s. The spectrograph slit width was m . arcsecs. Wavelength calibration expo sures were taken using a CuAr arc lamp. Three nights of observ a tions and April were covered in quiescence an d in total spectra were obtained. The observing log is giv en in Table together withthe startingtimesof the observations . Following wavelengthcalibration and skysubtraction t he data were ux calibrated using the spectra of the standard st ar LTT. . Observations Theobservations wereobtainedusingtheSITeCCDdetec tor pixels on the Cassegrain spectrograph of the SAAO .m telescope. A grating with a resolution of mmwas used over the wavelength range A on the nights of the th and th April. Another grating witha resolution of mmwas used on the th th and th April over the range A. The spectral resolution was .A and a binning scheme was employed i.e. binning by in the spatial direction. The exposure times during observations were s. The observations covered the period April April and in total spectra were obtained Table . The extraction a nd re duction of the data were performed the standard way using the Image Reduction and Analysis Facility IRAFpackage and the IRAF is a software package for the reduction and analysis of a stronom ical data distributed by National Optical Astronomy Observ atory NOAOFigure . Radialvelocity Fourier amplitude spectra from the co m bined data are shown for km sand km sfor the Hline top left panel and second left panel fromthe top and for kmsand kmsfortheHlinetoprightpanelandsecondrightpanelfromthe top.denotes the orbital frequency of the system its rst harmonic andthe upper orbital side band where is the spin frequency. The data were prewhitened by the orbital frequency and are displ ayed in the third panels from the top. Window spectra are plotted below t he amplitude spectra bottom panels. spectra were uxcalibrated using observations of the stand ard star LTT. THERADIAL VELOCITIES ItiswidelyacceptedthatinacanonicalCVthehighvelocit yemis sion line wings are formed in the inner parts of the accretion disc orbiting close to the white dwarf and thus should reect its o rbital motion Shafter Shafter Szkody Shafter . In IPs however high velocity emission line wings are forme d in the gas streaming towards the white dwarf at high velociti es Hellieretal. Ferrario Wickramasinghe . The r a dial velocities were determined by measuring the wings of th e H and Hemission lines from the data and the data obtained on the th was not added since EX Hya had not fully recovered from outburst and the wings of H Hand H emission lines from the data using the Gaussian Convolu tion which is operated by the Association of Universities for Res earch in As tronomy AURA ccirclecopyrt RASMNRAS SpectroscopicStudyoftheIP EXHydraein Quiescence Figure . Radial velocity amplitude spectra shown for the H line from for km sand km s. The vertical dashed line shows the expected position of the orbital and spin period pe aks. The data were prewhitened by and are shown in the third panel from the top. A window spectrum is shown at the bottom. Scheme GCS Schneider Young Shafter Szkody Shafter.TheGCSmethodconvolveseachspectrumwitht wo identical Gaussian one in the red wing and one in the blue win g. The separation between the two Gaussians is . Care was taken nottoincluderegionsfaroutinthewingswherethecontinuu m be ginstodominate bychoosing reasonable values ofthewidth of the Gaussians and . Twelve standard Gaussian bandpasses were used with values ranging from to km sand corre sponding widthvalues from to km s. . PeriodSearches The radial velocities were Fourier transformed using the Di screte Fourier Transform DFT algorithm to search for any periods in the data Deeming Kurtz . The H and Hamplitude spectra from and Aprilare shown inFigure and th e Hamplitude spectra from are showninFigure . A prominent peak at a frequency corresponding to the minute orbital frequency is observed in all the emission lines. Second in strength to the orbital frequency is the spin frequ ency of the narrow swave component NSC km s Figures and . The third panels from the top in Figures and show the data after prewhitening by . Power at is clearly present. The spin frequency was not detected at high values of km s where it is most expected since at these velocitiesthematerialisquiteclosetothewhitedwarfand itsemis sion is expected to be modulated at the white dwarf spin perio d.It was alsonot present in H and Hradial velocities of . The amplitude of relativeto wasfound tobe for H for Hand for H . ORBITALVARIATIONSOF THEEMISSIONLINES The data were phasebinned on the orbital ephemeris of Helli er Sprouts Teclipse . . E whereEis the number of orbital cycles and T is the time of mid eclipse.Thisephemeris isdenedbythezeropoint ofmidec lipse where minimum intensity is at phase .. This means that for t he radial velocitiesmaximum blueshift isperpendicular tot he line of centres at phase . meaning that spectroscopic phase ze ro oc curs at the bluetored crossing of the emission line radial velocity curve. phase bins were used toproduce the radial velociti es. . OrbitalTomograms andTrailed Spectra The H Hand HDoppler tomograms were computed using the Back Projection Method BPM with the application of a l ter and the Maximum Entropy Method MEM Marsh Horne Marsh Horne Spruit .TheBPMDoppler maps are shown in Figure and those constructed using MEM are shown in Figure . Error in ephemerides both orbital and spi n is sufciently small to phase all of our data accurately on the o rbital andspin cycles. A velocity amplitude of the primary K km s from our radial velocity measurements and that of the second ary K km s taken from Vande Putte et al. and Beuermannetal.wereusedtoxthepositionsoftheR oche lobe and the stream trajectories on the tomograms. A seconda ry massM.. M for EX Hya was derived from the up todatesecondary massperiodrelationof SmithDhillon . The mass of the primary M was then determined from the above values usingK KM Mand was found tobe . . M . The H Hand HeI Doppler tomograms Figure and show strong emission at the bright spot some at the Roc he lobe and the stream and some from the disc. Those of H also show strong bright spot emission but less or no emission from the stream.DiscemissionisdiminishedinH whencomparedtoother emissionlinesespeciallyathighervelocities.Thisismo reobvious in the BPM tomogram. The bright spot emission falls near the r e gion km s. Averagesubtracted trailed spectra Fig ure show the corresponding NSC. ergs cms of the original line uxes is contained in the averag e subtracted proles of H and H andergs cms is contained inH and HeI. This uxis mainly due tothebright spotandthe stream.Thetrailedspectra hav ebeen repeatedover cycles for clarity. The trailed spectra of have revealed two interesting fe a tures. The rst one is the asymmetry in the intensity of the s wave Figure . In H the red wing of the NSC is brighter at ..andseemstoreachmaximumbrightnessnear . whereas the blue wing is dimmer in the range .. and seems toreach minimum brightness near .. A similar ef fectisseenintheH andtheH linesandtoalesser extentinHeI . The second feature is redshifted emission extending f rom the NSCto highvelocities km s at earlybinary phases ... ccirclecopyrt RASMNRAS N. MhlahloD.A.H.Buckley V.S.DhillonS.B.PotterB. Wa rnerandP.A.Woudt Figure. ThepanelsshowtheH HHandHeIorbitalDopplermapsfromandH tomogramsofconstructed usingtheBackProjection Method with the application of a lter top panels and after subtracting the average of the line prole bottom panels. The positions of the Roche lobe and stream trajectories areshown velocity amplitudes of KkmsandK kmsfor theprimary and secondary starsrespectively wereuse d.The two curves with marked intervals represent the gas stream ve locity upper curve and the Keplerian velocity along the st ream lower curve. Thecircles on all tomograms represent . of the distance from the L point to the primary. The three crosses are centres of mass of the secondary system and primary from toptobottom. The asterisk represents the velocity of clo sest approach. All the maps are plotted on the same velocity s cale. The lookup table of this gure is such that the brightest emission features appear with decre asing intensity from yellowgreen to light blue in the onlin e edition or white to grey in the printed edition. The reconstructed trailed spectra suggest that this latter fea ture is another swave which we shall refer to as the high vel ocity component HVC crossing the NSC near ... The Doppler tomograms show emission extending from the bright s pot positionpassingalongthestreampathtothebottomleft quadrant at high velocities near km swhich is responsible for the HVC most of this emission does not fall within the disc and ga s streamvelocities onthe mapsuggesting thatthere wassmal lor no overlapof the stream component withthedisc. Thetomogramsshowedsimilarresults.Itisworthnotin g thatmostofthediscemissionincamefromtheouterdisc than in. Even though the MEM and BPM pick out the same features in the BP tomograms some features are more prominent than in the MEM tomograms while the reconstruction obtained using t he MEMreproduces the observed data well. The advantage of BPM over MEM is that it is faster and it is easier to get a consistent set of maps of different emissio n lines interms of the apparent noise in the images. For this reaso n both methods have been used. SPINVARIATIONSOFTHE EMISSIONLINES . TheSpinRadial VelocityCurve The radial velocities were phasefolded using bins on the quadratic spin ephemeris of Hellier Sproats where spin maximum was dened as . Figure shows the variation of theHHandHnarrowcomponentswith .Maximumblueshift isseen at .for Hand at. forH.Whereas for H maximum blueshift is seen at .. It should be noted thatHandHHhavenotbeenobservedsimultaneouslyandsoboth data sets probably sample the spin phases at different o rbital phases. FigureshowstheH narrowcomponent kms andthebroadbasecomponent kmsoverplotted.The twocomponents areinphase.Theradialvelocityvariationw iththe spin period of the H and Hbroadbase component could not be detected possibly due to velocity cancellation We discuss this in Section. . SpinTomograms andTrailed Spectra Spin tomograms of EX Hya were constructed by Hellier but revealed little information. Also Belleet al. o bserved no coherent emission sites on their tomograms folded on the spin phase. The Hand the H BPM and MEM spin tomograms from however have revealed a coherent emission site betwe en Vx km sand km swhich is evidence of emis sion from the accretion curtains Figures and . But it is a well knownfact thatsince thespinperiodis ofthe orbitalperiodin EX Hya orbital cycle variations do not smear out when folded on the spin phase but repeat every spin cycles Hellieret al. . Thisisthought tobetheoriginofmostofthestructureinthe emis sion lines at velocities km sHellier . To address thisproblemphaseinvariantsubtractionisperformedwh ereemis sion that does not vary with the spin cycle is subtracted from the data. This is achieved by measuring minimum ux at each wave length and subtracting this value. The results are shown int he sec ondpanelsfromthetopofFigure.Itshouldbementionedtho ugh that even subtracting the invariant part of the line proles does not guaranteethattheinuenceoftheorbitalperiodvariation shasbeen completelyremoved. ccirclecopyrt RASMNRAS SpectroscopicStudyoftheIP EXHydraein Quiescence Figure . HH Hand HeI trailed spectra top row of pan els and MEM orbital Doppler maps second row of panels from t he top as well as the averagesubtracted trailed spectra third ro w of panels are shown plotted on the same scale except for H panels. The HVC and the NSC are indicated. The fourth row shows the averagesubtrac ted Doppler maps and the models plotted for q.iandM.M. The bottom panels are the reconstruction of the averagesubtra cted data. The fourth and bottom panels are also plotted on the same scale ex cept for H panels. The lookup table of this gure is such that the bright est emission features appear with decreasing intensity from black to lig ht grey. A spinwave todifferentiate it from the swave which is nor mallycausedbythebrightspotintheH trailedspectraFigure wasdetectedfromthedataafterthephaseinvariantsubtra ctionwas performed. This is the rst detection of modulation over the spin cycle in the optical emission line data of EX Hya. This spinw ave can be seen in the trailed spectra before but hard to see and af ter subtraction of the phaseinvariant line prole. The nar row peak component is responsible for this spinwave which is shown e x Radial Velocity kmsSPIN PHASE Figure . The Htop panel H middle panel and H bottom panel spinradialvelocitiesofthenarrowcomponentfromthe combineddata HandHanddataH .Theradialvelocities wereprewhitened by the orbital frequency and phasefolded on the spin frequenc y using bins and are shown plotted as afunction of the spin phase. Figure . The spin radial velocity curves of the H narrow crosses and broad dots components from bins plotted as a func tion of the spin phase. Thesolid line represents atto thedata. pandedinthesecondcolumnofpanelsinFigurethenarrowp eak component wasselectedbyhandoveravelocityrangeof km s. The spinwave shows maximum blueshift near phase .and maximum redshift near phase . and has an amplitude of kms.TheHtomogramshowscorrespondingemissionnearthe oclockpositionblobofemissionrightattheedgeofth emap around km s. DFTs show lower amplitude km s forHandkmsforHandHprobablyduetodi lutionbystationarymaterial.AlsotheH MEMtomogram shows strongeremissionthatpeaksinabroadstructureatlowerve locities Vx km s km s around the oclock position.Circularmotiongivesrisetoloworzeroradialv elocities whenthe motionisperpendicular tothe lineof sightandthe emis sionseenaroundtheoclockpositioncouldnotbefrom such velocities since it shows maximum blueshift at ... Similar emission was observed in a Polar and was thought to be due tomaterial that has just been decelerated after having a ttached to the magnetic eld lines Schwarz etal. we discuss a n alternative explanation in Section . The emission near th e edge ccirclecopyrt RASMNRAS N. MhlahloD.A.H.Buckley V.S.DhillonS.B.PotterB. Wa rnerandP.A.Woudt Figure. TheHHHand HeI trailed spectra from folded on the spin period are shown at the top panels and the average subtracted spectra are shown at the second panels. Doppler maps constru cted from the phaseinvariant subtracted spectra are shown in the bot tom panels. The Doppler maps were constructed using the BPM and are shown on t he same velocity scale with thetrailed spectra. Thelookup table is as in Figure . of the tomogram at km s shows maximum blueshift at . and therefore cannot be due to motion perpendicular to the line of sight either. TheHtrailedspectraalsoshowemissioncoupledtothespin wave near .. that extends to high velocities in the red a similar situation to that seen the in orbital tomogram s due to the HVC Section .. The corresponding emission in the H tomograms extending tohigher velocitiesintheredspectra l region isnot clear. Both the H and Hphaseinvariant subtracted trailedspectra show three weakintensity spinwaves. The most clearly vis ible of the three is phased with maximum redshift near .. with an estimated velocity amplitude of km sand corre sponds to the emission near the oclock position in the to mo gram Figure . The reconstructed trailed spectra reprodu ce the observed data. The Hand Htrailed spectra in Figure seem to support these results. The emission observed near the oclock pos ition in the tomograms has also been seen in other IPs such as AO Psc andFOAqrHellier andwasinterpretedas emanatingfr om the upper accretioncurtain. The spinwaves are weak in intensity though and more data are needed tosupport these results. DISCUSSIONOF THEORBITAL ANDSPINDATA The generally accepted model of EX Hya has the material leavi ng the secondary star through the L point passing via a stream of material which orbits about the white dwarf to form an accre tion Figure . H Hand Htrailed spectra of folded on the spin period areshowninthetoppanelsandthephaseinvariant subtract edtrailedspectra areshowninthesecondpanelsfromthetop.MEMspinDopplert omograms constructed from the phaseinvariant subtracted spectra a re shown in the third panels with the reconstructed spectra in the bottom pa nels. The spin wave observed in the H phaseinvariant subtracted trailed spectra which was caused by the H narrow component is shown expanded on a smaller velocity scale.Therstcolumn ofpanelsareplotted betwee n kms and km sand the last two column are plotted between km sand km s. Thelookup table is as in Figure . disc.Themagneticeldlinesofthewhitedwarfwhichformac cre tioncurtainsaboveandbelowtheorbitalplanechannelthem aterial from the disc starting from the corotation radius Rco where the discistruncatedbytheeldlinestothesurface ofthewhit edwarf Hellieretal. Rosen etal. . King Wynn challenged this model by arguing that systemswith PspinPorb.cannotpossessKepleriandiscssince thisimplies RcoRcir.Theyshowedthatthespinequilibriumstate inEX Hya isdetermined by Rcob wherebis the distance tothe Lpoint. In this model the accretion curtains extend to near th eL pointandEXHyaresemblesanasynchronous polarwheremost of the material accretes via the stream King Wynn Wynn . Belle et al. revised the model of EX Hya after they showed that their EUV data support the model of King Wynn ccirclecopyrt RASMNRAS SpectroscopicStudyoftheIP EXHydraein Quiescence . Their revised model suggested that the magnetic el d in EXHyaformsalargeaccretioncurtainextending totheouter edge of the Roche lobe causing part or all of the nonKeplerian disc hereafter the ringof m a terialor the ring torotate withthe white dwarf an extended bulge later Belle et al. showed that the re was Vertically Extended Material VEM obscuring the swav e emission during .. and evidence for overowing stream accretioninEXHya and theringofmaterialtofeelmagneticforceattheregionsoft he ring close to the poles causing the ring material at these lo cations to be controlled by the magnetic eld forming two chunks alo ng the accretionringthat rotate withthe whitedwarf. RecentlyNortonetal.a haveshownthatforsys tems with PspinPorb. when the mass ratio is smaller at q. the material forms a ring near the edge of the primary Rochelobefromwhereaccretioncurtainsfunneldowntothe white dwarf surface in agreement with King Wynn and Belle et al. . The material is fed from the ring ringfed acc retion and channeled along the magnetic eld lines when the angle b e tween the white dwarf spin axis and magnetic dipole axis is sm all i.ewhichis true for EXHya. The discussion by Eisenbart etal. on the IRUV ux distributioninEXHyaimpliesadiscisobaricandisotherm alwith an outer radius of . cm and a thickness of cm and an assumed central hole of cm but Eisenbart et al. suggested that the structure could also be a ring with a large r in ner radius in line with the suggestion of King Wynn Belleet al. and Norton etal. . They found that t he disc component contains about of the total ux which is a b it more than expected from gravitational energy release at the inner radius R incm. Our spectroscopic data support both the model of Belle et al. and Norton et al. in which material from a ring cir cling the white dwarf and corotating with the magnetic eld lines atthe outer edge of theRoche lobe isaccretedbythe whitedw arf. Thepresenceofthebrightspotrevealedbythetrailedspect ra the DFTs of the radial velocities and the Doppler maps Figur es and suggest the presence of a disc or ring of material exten ding tonear the Roche lobe radiusaround thewhite dwarf. Whenco m paring the and tomograms for the H they appear to be in the same state or similar given the fact that they are ten y ears apart. It is reassuring that the fact that the twogroups of li nes have not been measured simultaneously is not a signicant proble m in the analysis. More importantly a spin pulse modulated at velocities con sistent with those of the material circulating at the outer e dge of the disc km s Figures and was detected and providesevidenceforcorotationoftheextendedaccretio ncurtains withtheringmaterial.AsdiscussedinSection.theselo wradial velocities mentioned above were not caused by motion perpen dic ular to the line of sight near the white dwarf neither were th ey caused byvelocity cancellationas willbe shown later. A spin wave was detected in the spinfolded trailed spectra of HFigure with a velocity semiamplitude of km s. The spin wave shows maximum blueshift near phase . when the upper magnetic pole is pointed away from theobserver andmaximumredshiftnear phase ..TheH equivalent widthsshowmaximum uxnear ..Thispicture isconsistentwiththeaccretioncurtainmodel ofIPsandisp ossible if accretion occurs via a discring. The spin tomograms Fig ures and show evidence of the accretion curtain emission exten ding fromkmstohighvelocities kmssuggesting that material is channeled along the eld lines from the oute r ring. The Hnarrow and broad base components show similar phase variation suggesting same position of maximum radial velo city as shown inFigures and line OA.This indicates that materi alis channeled from the ringat low velocities tohigh velociti es along the eldlines. A mass ratio of q. was measured from our data and so the periodratio PspinPorb.isconsistent withthe ringaccre tionmodel of Nortonet al.. Decreased prominence of the narrow swave component around.. Figure and was observed and sug gests the presence of VEM at the outer edge of the ring of ma terial obscuring the emission at these phases. The presence of the overow stream may be infered from this observation Bellee t al. .Butdirectevidence comes from orbitalDoppler tomog rams which show an asymmetry in the emission where more emission is observed from the secondary Roche lobe to the lower left qu ad rant than from the opposite side. Averagesubtracted orbit al tomo gramsshowthisemissionathighervelocities kms Figures and and it corresponds to the HVC observed in th e trailedspectra which is modulated witha velocitysemiam plitude of km s. This HVC is reminiscent of that detected by Rosen et al. in the trailed spectra of the AM Her system V Cen. Their HVC was blueshifted with a velocity of km sand was said to be produced in the stream close to the white dwarf. The only difference is that there was no evidence of th e HVCemissionwhenitwasexpectedtobeseenredwardofanothe r component mediumvelocity component intheir datawher eas in EX Hya the evidence of the HVC emission is missing between ... The HVC emission is maximally blueshifted at ...Thisphasingisconsistent withtheexpectedphase of impact of a stream of material from the secondary withthe d isc or of the overow stream material freefalling onto the magn eto sphere of the primary Hellieretal. . Support for overow stream is also provided by spin tomo grams where emission is observed on the upper accretion curt ain withvelocitiesconsistent withstreamvelocities.Thissu ggests that thisemissionsitemayalsohave resulteddue toimpactof ove row streamwiththemagnetosphere. The resultingemissionisre ceding from the observer at maximum redshift near . Figure inagreement withthe accretioncurtain model. The model of King Wynn is not fully supported by our observations since itpredicts direct accretionviaa st ream.Our observations however t the models of Nortonet al. and Belleet al. . There is evidence for strong H emis sion of the narrow swave component in the spin tomograms ce n tred around km sFigure that is not accounted for by these models. This emission shows maximum blueshift at phas e . suggesting thatthese are rotationalvelocities ora com bination of streaming and rotational velocities of the ant iphased motion of a source locked to the white dwarf. One possible exp la nation is that this emission comes from the opposite pole of t he white dwarf at a radial distance of cm Rwd. Siegel found that the eclipsed optical source in EX Hya is cen tred at a radial distance of . cm Rwd which is about four times closer to the white dwarf compared to our result. This c ould bethesameemissionregionbutinourobservationstheemis sionis spreadoutpossiblyduetothequalityofthedataandthisc ouldac count for the difference in the radial distance values quote d above. But we cannot imagine a geometry where such low rotational ve ccirclecopyrt RASMNRAS N. MhlahloD.A.H.Buckley V.S.DhillonS.B.PotterB. Wa rnerandP.A.Woudt .Observer. . . .. ring of material. .VEMthrough upper polemagnetic axis phases of maximum blueshift of the phase of maximum blueshift phases of maximum redshiftchunk of materials overflowing stream of the swavenarrow swave chunk of material with fieldcorotating phase of maximum blueshift of the HVC. .Observer.. .. outer disccorotating with fieldpart of disc maximum blueshift BBC phase of maximum intensityphase of ofmagnetic axis through upper pole phase of minimum intensity BBCmaximum redshiftphase of of . Figure. Amodelof EXHyain quiescence. Thegures aredrawn over theo rbital cycle left and spin cycle right and show themagne tosphere extending to the outer edge ofthe ring and the chunk of material corota ting with the eld lines. Averticaly extended material VEM isirradiated by the white dwarf in its inner regions left. B AO Observer Figure . A depiction of the regions where H was formed. Both the nar row and broad base components fall along the same radial dire ction OA resulting in similar phase variation. locitiescandominateoverstreamingvelocitiesalongthe eldlines near the whitedwarf. Wetherefore suggest that thisisevide nce for material that is diverted out of the orbital plane. Since one of the assumptions of Doppler tomography is that everything lies o n the plane itisnotpossible tolocate theexact positionof this emission relative tothe whitedwarf. . Whitedwarfandsecondary masses Hellieret al. showed that maximum line widths of km sconstrain the mass of the white dwarf and a freefall velocity of this magnitude could be achieved for white dwarf masses greater than . M . We found M ..M in good agreement with the results obtained from recent stud ies by Hoogerwerf et al. Beuermann et al. and Vande Putte etal. . For the secondary we derived M .. M from thesecondarymassperiodrelationofSmithDhillon and this value agrees with that obtained by Vande Putteet al. .Beuermann etal. and Hoogerwerf et al. nd lowe r values for M consistent with. M . Eisenbart et al. ar gues that for a secondary mass as low as . M the secondary wouldhave tobe substantiallyexpanded by . . Therevised modelof EX Hya We propose a model where one of the two chunks alluded to by Belle et al. which are formed by the magnetic pull alo ng theaccretionringcorotateswiththeaccretioncurtains attheouter edgeoftheRochelobeat kmsgivingrisetothepul sationof emissionat the spinperiodwhichwe observe inour d ata while the other is hidden by the accretion curtain below the r ing of material. The resulting emission is maximally blueshift ed near . Figure . In the accretion curtain model at . inthespincycleminimum uxduetohigheropacityisobse rved when the upper accretion pole of the white dwarf is pointed to wards the observer Hellieret al. and so the phasing m en tioned above is compatible with the motion of a rotating accr etion funnel. This is illustrated in Figure where the position of the observer at pulse maximum is indicated and the axis of the ma g netic pole is shown. The disruption of the disc by the magneti c eld at the outer disc is illustrated and part of the disc cor otating with the magnetosphere is shown. At a corotation radius Rc ba..logM Mcm the material is ro tating at a velocity of vGM b km s in good agreement with the observations. Also a rotation velocity of km s wasmeasuredfromthespectraandtheradialdistancefromth estar to the ring of material was found to be cm which is similar to b for a white dwarf mass of . M Keplerian motion about the white dwarf had to be assumed in these calculations . At this radius the accretion curtain is also rotating at a ve locity of RcoPspin km s. ergs cms integrated over one spin cycle of the original line uxes that is contained in the ave rage ccirclecopyrt RASMNRAS SpectroscopicStudyoftheIP EXHydraein Quiescence subtracted prole of H shows radial velocity variations with the spin period. Assuming that H and Halso show a similar ux variation H and Hspin tomograms also show a lowvelocity s wave but this result is not secured due to poor quality of data the total line uxes showing radial velocity variations wit h the spin period can be estimated to be ergs cms for the three emission lines. This is of the total disc ux Eisenbart etal. suggesting that only part of the rin g coro tates withthe white dwarf while the rest of the materialmay b e in volvedinanearKeplerianmotionthisisaroughcomparison since the uxis integrated over one spin cycle for H Hand Hinour data whereas Eisenbart etal. derived their total ux values fromonespectrumoverthewavelengthrange A. While some of the ring material corotates with the accre tion curtains i.e. remains in the disc rather than being imm edi ately channeled along the eld lines some is channeled alo ng the eld lines at km stowards the white dwarf. There is also some material that overows the ring and attaches onto the ma g neticeldlines.Theoverowstreamhitsthemagnetosphere prob ably causing a second bright spot on the slowly rotating magn eto sphere Figure . The overow stream is irradiated by the w hite dwarf initsinner regions close tothe whitedwarf theregio ns fac ing the white dwarf. This results in the HVC emission being o b scured at .. which are phases where the stream is viewed from behindopposite the side facing the white dwarf hid ing the irradiated inner regions. HVC emission from the stre am is blueshifted when that from the narrow swave component show s maximum redshift. Near . the two swaves intersect ex plaining the asymmetry in the brightness of the swave seen n ear .Figure .Theoverow streamcurls nearlybehindthe whitedwarfanditistruncatedbytheeldwhentheuppermagn etic pole is facingthe stream. Ferrario Wickramasinghe andFerrarioWickramas ingheKingshowedthatinIPstheaccretioncurtainb elow the orbital plane can contribute in the radial velocities of a system if it can be seen either through the central hole of the trunca ted disc or from below the disc or both. This effect will result in ve locity cancellation due to nearly equal quantities of mater ial that are blueshifted and redshifted on the accretion curtains F errario Wickramasinghe King. In EX Hya where the inclination is high and the disrup tionradius is large RWDfor a white dwarf mass of . M as proposed inFigure it is clear that we see spinvarying emis sionfromtwooppositemagneticpolesproducingafairlysy mmet ric structure in the spinfolded line proles Hellieret al . Rosenet al. . If emission from these opposite poles is c an cellingoutthenthesumwillhaveamuchlowervelocity.This could explainthe near zeroand low amplitude of the radial velocit yvari ation at the spin period of the H and H and Hlessorequalslant km s broadbase component respectively see also Hellieret al . and FerrarioWickramasinghe King. One could take this argument further by suggesting that the spin modulation we observe in our data at velocities near km sFigures and is just the slight asymmetries between the two poles. The resulting velocity could just be a measure of the degree to which the poles cancel their velocities near km sCoel Hellier private communication. This however can not be the case for H and Hsince these twoemission lines show motion that is consistent with that of a rotating object sug gesting that the line proles are not dominated by the infall velocit ies at the two opposite accretion poles. If they were produced clos e to the white dwarf then maximum rotational velocity near kmswould be RPspinkm swhich ismuch smaller than km s. However rotional velocities close to the ring are km s. For H however we observe maximum blueshift at.andsovelocityduetocancellationanywherebetween and km sare expected depending on how much the two poles cancel. If both accretion curtains are still visib le and symmetric at large radii which is possible as suggested by F er rario Wickramasinghe King and our model velocit y cancellation will still result in smaller amplitudes than t hose of km sobserved in our data. This would then count against the argument above. Furthermore H orbital Doppler tomograms showstrongemissionatthebright spot.Ifour modeliscorre ctthe eldlines should also attract this H dominated material whichis chanelledalong the eldlinesas alreadyshown above. The v eloc ity of this material due to streaming motion near the outer ri ng is less than that of the H broadbase component close to the white dwarf as expected. A strong constraint on our model is that t he disruption radius of EX Hya has been shown to be at cm Hellieretal. Beuermann etal. whichimpliesaw hite dwarf magnetic moment of G cm. For our model this would imply that the accretion curtains do not extend to near the Roche lobe radius. The theoretical analysis of King Wyn n andWynn however has shownthatequilibrium ro tationispossibleifthemagneticmomentinEXHyafallswith inthe rangeoflessorequalslantlessorequalslantGcm.Thesearecomparable toweakest eld AM Hers below the period gap and that EX Hya could pos sesssuch magnetic moments issupported toa certainextent b ythe averagesubtracted trailed spectra of EX Hya that are remin iscent ofemissionlines seeninsome Polarse.g.V Cenas discu ssed aboveEFEriCramptonet al. Cowleyet al. QST el RomeroColmenero et al. and VV Pup Diaz . Fur thermoreCumming raisedthepossibilitythatthema gnetic elds in IPs are buried by the material due to high accretion r ates andsoarenotreallyaslowastheyappear.Theringstructure inEX Hya could imply higher accretion rates in EX Hya than previou sly thought since the capacity of the ring of material to store ma tter may be low when compared to that of a classical disc resultin g in the accretionof more material thanina classical disc case. SUMMARY Optical observations of EX Hya and the analysis have suggest ed that large accretion curtains extending to a distance close to the Lpoint exist in this system. The DFTs and spin tomograms have for the rst time provided evidence for corotation of the el d lines with the ring material near the Roche lobe. Also tomography and the phasing of the spin waves have suggested that feeding by t he accretioncurtainsof thematerialfromtheringringfeda ccretion takesplace.ThesendingssupportthemodelsofBelleetal. and Norton et al. for EX Hya and the simulations done by Norton et al. a which have shown that for systems with t he parameters of EX Hya the accreting material forms a ring at t he outer edge of the primary Roche lobe from where accretion cu r tains funnel down tothe whitedwarf surface. Evidence for stream overow accretion has been observed. The HVC caused by the overow stream disappeared at ..duetoobscurationbythestream.ObscurationoftheNSC at..suggestedthepresenceoftheVEMwhichwas irradiatedbythe white dwarf initsinner regions. The Hbroadbase component shows a radial velocity varia tion with the spin period whereas that of H and Hcould not be ccirclecopyrt RASMNRAS N. MhlahloD.A.H.Buckley V.S.DhillonS.B.PotterB.Wa rner andP.A.Woudt detected. The lowamplitude velocity variations modulate d at the spin period for H and for H and His explained in terms of ve locitycancellation effects. We have provided an explanation for the asymmetry in the intensity of the narrow swave component seen in EX Hya trail ed spectra inthe optical. Thenarrow swave component and the H VC cross at. resulting in the asymmetry in brightness that we observe atthese phases. The spinfolded trailed spectra are not of good quality and more data are needed toconrm these results. ACKNOWLEDGMENTS NM would like to acknowledge nancial support from the Sains buryLinsbury Fellowship Trust and the University of Cape T own. WewouldliketothankKunegundaBelleCoelHellierandAndr ew Norton for invaluable discussions and for their constructi ve com ments.WeacknowledgeuseofD.ODonoghuesandTomMarshs programs Eagle andMolly respectively. 
8,0704.0022,"  We present Lie group integrators for nonlinear stochastic differential
equations with non-commutative vector fields whose solution evolves on a smooth
finite dimensional manifold. Given a Lie group action that generates transport
along the manifold, we pull back the stochastic flow on the manifold to the Lie
group via the action, and subsequently pull back the flow to the corresponding
Lie algebra via the exponential map. We construct an approximation to the
stochastic flow in the Lie algebra via closed operations and then push back to
the Lie group and then to the manifold, thus ensuring our approximation lies in
the manifold. We call such schemes stochastic Munthe-Kaas methods after their
deterministic counterparts. We also present stochastic Lie group integration
schemes based on Castell--Gaines methods. These involve using an underlying
ordinary differential integrator to approximate the flow generated by a
truncated stochastic exponential Lie series. They become stochastic Lie group
integrator schemes if we use Munthe-Kaas methods as the underlying ordinary
differential integrator. Further, we show that some Castell--Gaines methods are
uniformly more accurate than the corresponding stochastic Taylor schemes.
Lastly we demonstrate our methods by simulating the dynamics of a free rigid
body such as a satellite and an autonomous underwater vehicle both perturbed by
two independent multiplicative stochastic noise processes.
",. We are interested in designing Lie group numerical schemes for the strong approximation of nonlinear Stratonovich sto chastic dierential equa tions of the form ytydsummationdisplay iintegraldisplayt ViydWi . . HereW...Wdaredindependent scalar Wiener processes and W tt. We suppose that the solution yevolves on a smooth submanifold MofRnandViM R TMi ...d are smooth vector elds which in local coordinates are Visummationtextn jVj iyj. The owmap tM M of the integral equation . is dened as the map taking the initial data yto the solution ytat timet i.e.ytty. Our goal in this paper is to show how the Lie group integration methods developed by MuntheKaas and coauthors can be extended to stochastic dierential equations on smooth manifolds see Crouch and Grossman and Munthe Kaas . Suppose we know that the exact solution of a given system of stochasti c dierential equations evolves on a smooth submanifold MofRn but we can only nd the solution pathwise numerically. How can we ensure that our approximate numeric al solution also lies in the manifold Suppose we are given a nite dimensional Lie group Gand Lie group action y that generates transport across the manifold Mfrom the starting point y M via elements of G. Then with any given elements in the Lie algebra gcorresponding to the Lie group G we can associate the innitesimal action using the Lie group action y. The map mastois a Lie algebra homomorphism from gtoXM the Lie algebra of vector elds over the manifold M. Further the Lie subalgebra XMgis isomorphic to the nite dimensional Lie algebra gwith the same structure constants see Olver p. and Marsden a nd Ratiu p. . Maxwell Institute for Mathematical Sciences and School of M athematical and Computer Sciences HeriotWatt University Edinburgh EH AS UK. Malham and Wiese Conversely suppose we know that the Lie algebra generated b y the set of govern ing vector elds Vii ...d onMis nite dimensional call this XFM. Then we know there exists a nite dimensional Lie group Gwhose Lie algebra ghas the same structure constants as XFM relative to some basis and there is a Lie group action ysuch thatViii ...d for someigsee Olver p. or Kunita p. . The choice of group and action is not uni que. In this paper we assume that there is a nite dimensional Lie g roupGand action ysuch that our set of governing vector elds Vii ...d are each innitesimal Lie group actions generated by some element in gvia y i.e.Viifor someig i ...d . They are said to be fundamental vector elds. This means tha t we can write down the set of governing vector elds Xifor a system of stochastic dierential equations on the Lie group Gthat via the Lie group action y generates the ow governed by the set of vector elds Vion the manifold. The vector elds VionMare simply the push forward of the vector elds XionGvia the Lie group action y. Typically the ow on the Lie group also needs to be computed nu merically. We thus want the approximation to remain in the Lie group so that the L ie group action takes us back to the manifold. To achieve this we pull back the set of governing vector eld sXionGto the set of governing vector elds viong via the exponential map exp from gtoG. Thus the stochastic ow generated on gby the vector elds vigenerates the stochastic ow onGgenerated by the Xi. The set of governing vector elds on gare for each g visummationdisplay kBkadki . whereBkis thekth Bernoulli number and the adjoint operator ad is a closed operator ong in fact ad the Lie bracket on g. Now the essential point is that igand so the series on the right or any truncation of it is closed ing. Hence if we construct an approximation to our stochastic dierent ial equation on gusing the vector elds vior an approximation of them achieved by truncating the serie s representation then that approximation must reside in the Lie algebra g. We can then push the approximation in the Lie algebra forward onto the Li e group and then onto the manifold. Provided we compute the exponential map and ac tion appropriately our approximate solution lies in the manifold to within machin e accuracy. In summary for a given gand anyy Mwe have the following commutative diagram gexp XGy XM varrowtparrowtpXarrowtp gexp Gy M We have implicitly separated the governing set of vector el dsVii ...d from the driving path process wW...Wd. Together they generate the unique It o solution process y M to the stochastic dierential equation .. When there is only one driving Wiener process d the It o map wmastoyis continuous in the topology of uniform convergence. When there are two or mo re driving processes d the Universal Limit Theorem tells us that the It o map wmastoyis continuous in thepvariation topology in particular for p see Lyons Lyons and Qian and Malliavin . A Wiener path with d has nite pvariation forStochastic Lie group integrators p. This means that from a pathwise perspective approximati ons toyconstructed using successively rened approximations to ware only guaranteed to converge to the correct solution y if we include information about the L evy chordal areas of the driving path process. Note however that the Lnorm of the variation of a Wiener process is nite. In the Lie group integration proced ure prescribed above we must solve a stochastic dierential system on the Lie algebr agdened by the set of governing vector elds viand the driving path process wW...Wd. In light of the Universal Limit Theorem and with stepsize adapt ivity in mind in future see Gaines and Lyons we for instance use in our exampl es order stochastic numerical methodsthat include the L evy chordal areato s olve for the ow on the Lie algebra g. We have thus explained the idea behind MuntheKaas methods a nd how they can be generalized to the stochastic setting. The rst half of th is paper formalizes this procedure. In the second half of this paper we consider autonomous vect or elds and con struct stochastic Lie group integration schemes using Cast ellGaines methods. This approach proceeds as follows. We truncate the stochastic ex ponential Lie series expan sion corresponding to the ow tof the solution process yto the stochastic dierential equation .. We then approximate the driving path proces swW...Wd by replacing it by a suitable nearby piecewise smooth path in th e appropriate variation topology. An approximation to the solution ytrequires the exponentiation of the approximate truncated exponential Lie series. This can be a chieved by solving the system of ordinary dierential equations driven by the vect or eld that is the approx imate truncated exponential Lie series. If we use ordinary M untheKaas methods as the underlying ordinary dierential integrator the Castel lGaines method becomes a stochastic Lie group integrator. Further based on the CastellGaines approach we then prese ntuniformly accurate exponential Lie series integrators that are globally more accurate than their stochastic Taylor counterpart schemes these are investigated in deta il in Lord Malham and Wiese for linear stochastic dierential equations. T hey require the assumption that a suciently accurate underlying ordinary dierentia l integrator is used that integrator could for example be an ordinary Lie group Munthe Kaas method. In the case of two driving Wiener processes we derive the order and in the case of one driving Wiener process the order uniformly accurate exponential Lie series integrators. As a consequence we conrm the asymptotic eci ency properties for both these schemes proved by Castell and Gaines see Newt on for more details on the concept of asymptotic eciency. We also present in th e case of one driving Wiener process a new order uniformly accurate exponential Lie series integrator also see Lord Malham and Wiese . We present two physical applications that demonstrate the a dvantage of using stochastic MuntheKaas methods. First we consider a free ri gid body which for ex ample could model the dynamics of a satellite. We suppose tha t it is perturbed by two independent multiplicative stochastic noise processe s. The governing vector elds are noncommutative and the corresponding exact stochasti c ow evolves on the unit sphere. We show that the stochastic MuntheKaas method wit h an order stochastic Taylor integrator used to progress along the corresponding Lie algebra preserves the approximate solution in the unit sphere manifold to within m achine error. However when an order stochastic Taylor integrator is used directl y the solution leaves the unit sphere. The contrast between these two methods is more e mphatically demon Malham and Wiese strated in our second application. Here we consider an auton omous underwater vehicle that is also perturbed by two independent multiplicative st ochastic noise processes. The exact stochastic ow evolves on the manifold which is the dual of the Euclidean Lie algebra se two independent Casimirs are conserved by the exact ow . Again the stochastic MuntheKass method preserves the Casimirs t o within machine error. However the order stochastic Taylor integrator is not only unstable for large step sizes but the solution drifts o the manifold and makes a dra matic excursion o to innity in the embedding space R. Preserving the approximate ow on the manifold of the exact d ynamics may be a required property for physical or nancial systems driven b y smooth or rough paths for general references see Iserles MuntheKaas Nrsett a nd Zanna Hairer Lubich and Wanner Elworthy Lyons and Qian and Milst ein and Tretyakov . Stochastic Lie group integrators in the form of Magnus integ rators for linear stochastic dierential equations were investigated by Burrage and Bur rage . They were also used in the guise of M obius schemes see Schi and Shnider to solve stochastic Riccati equations by Lord Malham and Wiese where they o utperformed direct stochastic Taylor methods. Further applications where the y might be applied include backward stochastic Riccati equations arising in optimal s tochastic linearquadratic control Kohlmann and Tang jump diusion processes o n matrix Lie groups for Bayesian inference Srivastava Miller and Grenander fractional Brownian motions on Lie groups Baudoin and Coutin and stochasti c dynamics triggered by DNA damage Chickarmane Ray Sauro and Nadim . Our paper is outlined as follows. In Section we present the b asic geometric setup sansstochasticity. In particular we present a generalized righ t translation vector eld on a Lie group that forms the basis of our subsequent transfor mation from the Lie group to the manifold. Using a Lie group action this vector eld pushes forward to an innitesimal Lie group action vector eld that generat es a ow on the smooth manifold. In Section we specialize to the case of a matrix Li e group and using the exponential map derive the pullback of the generalized right translation vector eld on the Lie group to the corresponding vector eld on the L ie algebra. To help give some context to our overall scheme we provide in Sectio n illustrative examples of manifolds and natural choices for associated Lie groups a nd actions that generate ows on those manifolds. Then in Section we show how a ow on a smooth manifold corresponding to a stochastic dierential equation can be generated by a stochastic ow on a Lie algebra via a Lie algebra action. We explicitly pr esent stochastic Munthe Kaas Lie group integration methods in Section . We start the second half of our paper by reviewing the exponential Lie series for stochasti c dierential equations in Section . We show in Section how to construct geometric sto chastic CastellGaines numerical methods. In particular we also present uniformly accurate exponential Lie series numerical schemes that not only can be used as geometr ic stochastic integrators but also are always more accurate than stochastic Taylor num erical schemes of the corresponding order. In Section we present our concrete nu merical examples. Finally in Section we conclude and present some further future app lications and directions. . Lie group actions. Suppose Mis a smooth nite dimensional submanifold ofRn. We use XM to denote the Lie algebra of vector elds on the manifold M equipped with the LieJacobi bracket UVUVVU for allUVXM. LetGdenote a nite dimensional Lie group. Definition . Lie group action .A left Lie group action of a Lie group Gon a manifold Mis a smooth map G M M satisfying for all y MandRS GStochastic Lie group integrators idy y RSy RSy. We denote ySSy. Hereafter we suppose y M is xed and focus on the action map yGM . We assume that the Lie group action is transitive i.e. tran sport across the manifold from any point y Mto any other point y Mcan always be achieved via a group elementS Gwithy ySMarsden and Ratiu p. . We dene the Lie algebra gassociated with the Lie group Gto be the vector space of all right invariant vector elds on G. By standard construction this is isomorphic to the tangent space to Gat the identity ididGsee Olver p. or Marsden and Ratiu p. . Definition . Generalized right translation vector eld .Suppose we are given a smooth map Mg. With each such map we associate a vector eld XG XGdened as follows XSexpparenleftbig ySparenrightbig Svextendsinglevextendsingle forS G where exp is the usual local dieomorphism expg Gfrom a neigh bourhood of the zero element ogto a neighbourhood of id G. Definition . Innitesimal Lie group action .We associate with each vector eldXGXGa vector eld MXMas the push forward of XfromGto Mbyy i.e.parenleftbig yparenrightbig X so that if S Gandy yS M then yy wheret G Sand Xthe ow generated on Gby the vector eld Xstarting at S G. Naturally as a vector eld is linear and also y LXyS the Lie derivative of yalongXatS G. Remarks. . Our denition for the generalized right translation vect or eldXonGis motivated by the standard right translation vector eld use d to identify g the vector space of right invariant vector elds on G withTidG the tangent space to Gat the identity. When gis constant XXG is right invariant and a Lie bracket onTidGcan be dened via right extension by the corresponding LieJ acobi bracket for the vector elds XonXG. Unlessgis constant Xis not in general right invariant. For further details see Varadarajan Olver or Marsden and Ratiu . . The innitesimal generator map mastofromgtoXM is a Lie algebra homomorphism. If we identify gas the vector space of left invariant vector elds on G this map becomes an antihomomorphism. The LieJacobi brac ket as dened above gives the right rather than left Lie algebra stucture over the group of dieomorphisms onM. If in addition we take the LieJacobi bracket to be minus tha t dened above associated with the left Lie algebra structurethen the in nitesimal generator map becomes a homomorphism again. See for example Marsden and Ra tiu p. or MuntheKaas . . A comprehensive study of the systematic construction of s ymmetry Lie groups from given vector elds can be found in Olver . . We assumed above that the vector elds Xandare autonomous. However all results in this and subsequent sections up to Section ca n be straightforwardly extended to nonautonomous vector elds generated by M Rgwith ytmasto yt for ally MandtR. Malham and Wiese . The map SMM dened by ymastoSyySrepresents a ow on M. Hence if y Sy the push forward of by S is given byparenleftbig Sparenrightbig AdSMarsden and Ratiu p. . . If the action is eectivefaithful then the map SmastoS from Gto Di M the group of dieomorphisms on M is onetoone. If the action is freeso that y is onetoone and the only xed point is the identity element id G then yis a dieomorphism see Marsden and Ratiu p. . . Pull back to the Lie algebra. For ease of presentation we will assume in this section that Gis a matrix Lie group. Recall that the exponential map exp g G is a local dieomorphism from a neighbourhood of ogto a neighbourhood of id G. Letvggbe the pull back of the vector eld XGXG from Gtogvia the exponential mapping exp gG i.e.vexpX. Ifgthen v dexp parenleftbig yexpparenrightbig . . Here dexp ggis the inverse of the righttrivialized tangent map of the ex ponential dexpggdened as follows. If is a curve in gsuch that and gthen dexp gggis the local smooth map Varadarajan p. dexpexpexp parenleftbiggexpad id adparenrightbigg . Note that as a tangent map dexpggis linear. The inverse operator dexp is the operator series . generated by considering the recipro cal of dexp. To show that . is true if exp gGwithmastoS exp andgwith and v then expvSexp parenleftbig dexpvparenrightbig exp XS. Since exp is a dieomorphism in a neighbourhood of og this push forward calcu lation establishes the pull back . for all gin that neighbourhood. . Illustrative examples. Suppose the vector eld VM RXM gener ates a ow solution yt Mstarting from y M where Mis a smooth submanifold ofRn. Then assume there exists a . Lie group Gwith corresponding Lie algebra g . Lie group action yGM for which a starting point y Mis xed . Vector eld M RXM such that V i.e.Vis a fundamental vector eld corresponding to the action y. Let us suppose Gis a matrix Lie group or can be embedded into a matrix Lie group for example the Euclidean group SE is naturally embedded into the special linear group SLR. We have for all S GandtR XStparenleftbig yStparenrightbig S. . IfVfor someMg some Lie group Gand corresponding action y then the ow generated by XonGdrives the ow generated by VonM. In each of the examples below given the manifold M we present a natural Lie group and action associated with the manifold structure and identify vecto r elds which generate ows on the manifold via the Lie group.Stochastic Lie group integrators Stiefel manifold Vnk.Suppose MVnk yRnkyTyI. Take GSOn the special orthogonal group and ySSy the action of left multiplication. The corresponding Lie algebra gson. Then by direct calculation y yty. Hence if the given vector eld Vyt yty then the push forward of the ow generated by XSt onGin . is the ow generated by Von M. Note that the unit sphere SV i.e. Sis just a particular Stiefel manifold. In Section as an application we consider rigid body dynami cs evolving on S. Isospectral manifold Sn.Suppose MSnyRnnyTy the set of nnreal symmetric matrices. Take GOn the orthogonal group and yS SyST which is an isospectral action MuntheKaas . The cor responding Lie algebra is gson. Again by direct calculation y ytyyyt. Hence if the given vector eld Vyt ytyyyt then the push forward of the ow generated by XSt onGin . is the ow generated by VonM. Dual of the Euclidean algebra se.Suppose MseR the dual of the Euclidean algebra se of the Euclidean group SE braceleftbig sSEs SO Rbracerightbig . Take GSE so gse and AdG gg the coadjoint action of Gong. Then by direct calculation y ad y. Since y in linear in andyy it follows that if Vy ad y then the push forward of the ow generated by XSt parenleftbig yStparenrightbig SonGis the ow generated by VonM. For more details see Section where we investigate the dynamics of an autonomous underwater vehicle evolving on se. Grassmannian manifold Grkn.The Grassmannian manifold M Grkn is the space of kdimensional subspaces of Rn. Take G GLn the general linear matrix group where if SGLn we identify Sparenleftbigg parenrightbigg where the block matrices andare sizeskkknk nkkand nknk respectively see Schi and Shnider MuntheKaas . We choose the action of GL n on Grkn to be the generalized M obius transformation yS yy. Hence if t parenleftbiggatbt ctdtparenrightbigg then direct calculation reveals that y atybtyctyydt. Hence if the given vector eld Vy atybtyctyydt then the push forward of the ow generated by XSt tSonGis the ow generated by Von Grkn. . Stochastic Lie group integration. We show that if a Lie group action G MM exists then for y Mxed the Lie algebra action yexpgM carries a ow on gto a ow on M. Theorem .. Suppose there exists a Lie group action G MM . Then if there exist an It o process gand a stopping time Tsuch that on Tsatises the stochastic dierential equation tdsummationdisplay iintegraldisplayt vidWi . Malham and Wiese then the It o process y yexp Msatises the stochastic dierential equation onT ytydsummationdisplay iintegraldisplayt iydWi . . Proof. Using It os lemma if tgsatises . then yexptsatises yexpt yexpodsummationdisplay iintegraldisplayt LviyexpdWi . Now recall that for each i ...d Xiis the push forward of vifromgtoGvia the exponential map and that iis the push forward of XifromGtoMvia y and so the Lie derivative Lviyexptiyt. Then since yt yexpt we conclude that y Mis an It o process satisfying the stochastic dierential equation .. Corollary .. Suppose that for each i ...d there exists iGgsuch that the vector eld ViMXMandiMXMcan be identied i.e. Vii. . Then the push forward by yexp of the ow on the Lie algebra manifold ggenerated by the stochastic dierential equation .is the ow on the smooth manifold M generated by the stochastic dierential equation . whose solution can be expressed in the form yt yexpt. Remark. If the action is free then yexp is a dieomorphism from a neigh bourhood of ogto a neighbourhood of y M. . Stochastic MuntheKaas methods. Assuming that the vector elds in our original stochastic dierential equation . are fundam ental and satisfy . then stochastic MuntheKaas methods are constructed as follows . Subdivide the global interval of integration T into subintervals tntn. . Starting with t repeat the next two steps over successive intervals tntn untiltnT. . Compute an approximate solution tntnto . across tntn using a stochastic Taylor stochastic RungeKutta or CastellGai nes method. . Compute the approximate solution ytnytnexp tntn. Note that by construction tntngbecause the stochastic dierential equa tion . or any stochastic Taylor or other sensible appro ximation evolves the so lution locally on the Lie algebra gvia the vector elds vigg. Suitable methods for approximating the exponential map to ensure it maps gtoGappropriately can be found in Iserles and Zanna . Then by construction ytn M. For example with two Wiener processes and autonomous vecto r eldsvi an order stochastic Taylor MuntheKaas method is based on tntnparenleftbig JvJvJv J v JvvJvv J v parenrightbig o. evaluated at the zero element og. Typically dexp is truncated to only include the necessary low order terms to maintain the order of the num erical scheme.Stochastic Lie group integrators Remark. It is natural to invoke Ados Theorem see for example Olver p. any nite dimensional Lie algebra is isomorphic to a Lie suba lgebra of gln the general linear algebra for some nN. However as MuntheKaas points out directly using a matrix representation for the given Lie gro up might not lead to the optimal computational implementation other data structu res might do so. . Exponential Lie series. The stochastic Taylor series is known in dierent contexts as the Neumann series PeanoBaker series orFeynmanDyson path ordered exponential . If the vector elds in the stochastic dierential equation . are au tonomous which we assume henceforth i.e. for all i ...d ViViy only then the stochastic Taylor series for the ow is tsummationdisplay msummationdisplay PmJmtVmV. Here Pmis the set of all combinations of multiindices ... m of length m withi ...d and Jmtintegraldisplayt integraldisplaym dW mdWm are multiple Stratonovich integrals. The logarithm of tis theexponential Lie series Magnus expansion Magnus orChenStrichartz formula Chen Strichartz . In other words we can express the ow map in the form t expt where tdsummationdisplay iJitVidsummationdisplay ij JjiJijtViVj is the exponential Lie series for our system and is the LieJacobi bracket on XM. See Yamato Kunita Ben Arous and Castell for the derivation and convergence of the exponential Lie series expansion in t he stochastic context Strichartz for the full explicit expansion Sussmann for a related product expansion and Lyons for extensions to rough paths. Let us denote the truncated exponential Lie series by tsummationdisplay QmJc . where Qmdenotes the nite set of multiindices for which badblJbadblLis of order up to and including tm wherem .... The terms care linear combinations of nitely many length products of the smooth vector elds Vii ...d . The following asymptotic convergence result can be establi shed along the lines of the proof for linear stochastic dierential equations in Lord Malham and Wiese we provide a proof in Appendix A. Theorem .. Assume the vector elds Viare Lipschitz continuous and satisfy badblViybadbl cbadblybadbl for ally Mi ...d and somec. Then fort the ow exptyis squareintegrable where tis the truncated Lie series .. Further ifyis the solution of the stochastic dierential equation . there exists a constantCparenleftbig mbadblybadblparenrightbig such that vextenddoublevextenddoubleytexptyvextenddoublevextenddouble LCparenleftbig mbadblybadblparenrightbig tm. . Malham and Wiese . Geometric CastellGaines methods. Consider the truncated exponential Lie series tntnacross the interval tntn. We approximate higher order multiple Stratonovich integrals across each timestep by their expe ctations conditioned on the increments of the Wiener processes on suitable subdivision s Gaines and Lyons . An approximation to the solution of the stochastic dierent ial equation . across the interval tntn is given by the ow generated by the truncated and condition ed exponential Lie series tntnvia ytnexpparenleftbigtntnparenrightbig ytn. Hence the solution to the stochastic dierential equation . can be approximately computed by solving the ordinary dierential system see Ca stell and Gaines Misawa u tntnu . across the interval . Then if u ytnwe will get uytn. We must choose a suciently accurate ordinary dierential int egrator to solve .we implicitly assume this henceforth. The set of governing vector elds Vii ...d prescribes a map from the driving path process wW...Wd to the unique It o solution process y Mto the stochastic dierential equation .. The map wmastoyis called the It o map. Recall that we assume the vector elds are smooth. When there is only one driving Wiener process d the It o map is continuous in the topology of uniform conv ergence Theorem ... in Lyons and Qian . When there are two or more driving pro cesses d the Universal Limit Theorem Theorem ... in Lyons and Q ian tells us that the It o map is continuous in the pvariation topology in particular for p. A Wiener path with d haspvariation with p and thepvariation metric in this case includes information about the L evy cho rdal areas of the path Lyons . Hence we must choose suitable piecewise smoot h approximations to the driving path process w. The following result follows from the corresponding resul t for ordinary dierential equations in Hairer Lubich and Wanne r p. as well as directly from Chapter VIII in Malliavin on the Transfer Principle. Lemma .. A necessary and sucient condition for the solution to the st ochas tic dierential equation .to evolve on a smooth submanifold MofRnup to a stopping time Tis thatViytTyMfor ally Mi ...d . Hence the stochastic Taylor expansion for the ow tis a dieomorphism on M. However a truncated version of the stochastic Taylor expans ion for the ow twill not in general keep you on the manifold i.e. if y M then tyneed not necessarily lie inM. On the other hand the exponential Lie series t or any truncation tof it lies in XM. By Lemma . this is a necessary and sucient condition for the corresponding owmap exp tto be a dieomorphism on M. Hence ifu ytn M thenytnu M. When solving the ordinary dierential equation . classical geometric integration methods for example Lie g roup integrators such as RungeKutta MuntheKaas methods over the interval will numerically ensureytnstays in M. Additionally as the following result reveals numerical methods constructed using the CastellGaines Lie series ap proach can also be more accurate a proof is provided in Appendix B. Theorem .. In the case of two independent Wiener processes and under the assumptions of Theorem . for any initial condition y Mand a suciently smallStochastic Lie group integrators xed stepsize the order Lie series integrator is globally more accurate in Lthan the order stochastic Taylor integrator. In addition in the case of on e Wiener process the order and uniformly accurate exponential Lie series integrators generated by tntnJVJVh parenleftbig VVVparenrightbig and tntnJVJV JJVV h parenleftbig VVVparenrightbig respectively are globally more accurate in Lthan their corresponding stochastic Tay lor integrators. Remarks. . The result for is new. That the order Lie series integrator for two Wiener processes and the order integrator generated by are uniformly more accurate conrms the asymptotically ecient properties of these schemes proved by Castell and Gaines . The proof follows along the lines of a n analogous result for linear stochastic systems considered in Lord Malham and Wi ese . . Consider the order exponential Lie series with no vector eld commu tations. Solving the ordinary dierential equation . u sing an ordinary Euler MuntheKaas method and approximating dexp idis equivalent to the order stochastic Taylor MuntheKaas method for the same Lie grou p and action. . Numerical examples. .. Rigid body. We consider the dynamics of a rigid body such as a satellite see Marsden and Ratiu . We will suppose that the rigid b ody is perturbed by two independent multiplicative stochastic processes WandWwith the corresponding vector elds Viyiyy fori withiso. If we normalize the initial datayso that y then the dynamics evolves on MS. We naturally suppose GSO and ySSyso thatiy iyy and we can pull back the ow generated by VonMto the ow on Ggenerated by XiSt iparenleftbig ySparenrightbig S i . We use the following matrix representation for the iyso iy yiyi yi yi yiyi where the constants ijforj are chosen so that the vector elds Viand matricesido not commute for i . The vector elds Visatisfy the conditions of Theorem . since the manifold is compact i n this case. We will numerically solve . using three dierent order methods stochastic Taylor stochastic Taylor MuntheKaas based on . and Ca stellGaines a stan dard nongeometric RungeKutta method is used to solve the o rdinary dierential equation .. The vector eld compositions ViVjneeded for the stochastic Taylor and CastellGaines methods are readily computed. For the Mu ntheKaas method we note that we have vioiy and vivjoAyyij iyjy. Hereoso is the zero element on the Lie algebra and for all yzRwe dene Ayz parenleftbigyz yz parenrightbig parenleftbigyz yz parenrightbig parenleftbigyz yz parenrightbig Malham and Wiese timelogdistance from manifold Stochastic Taylor CastellGaines MuntheKaas Fig. . . Rigid body We show the logdistance of the approximate solution to the u nit sphere as a function of time for each of the methods. Below we show the approximate solutions as a function of time for the stochastic Taylor blue and MuntheKaas met hods magenta. The trajectory starts at the top right and eventually drifts over the left horizon.Stochastic Lie group integrators and Rso denotes the vector space isomorphism mastowhere . Note that yzyzsee Marsden and Ratiu . Note also since so expSO can be conveniently and cheaply computed using Rodrigue s formula see Marsden and Ratiu or Iserles et al. . In Figure . we show the distance from the manifold Sof each the three approx imations we start with initial data y T. The stochastic Taylor Munthe Kaas method can be seen to preserve the solution in the unit sp here to within machine error. We also see that the stochastic Taylor method clearly drifts o the sphere as the integration time progresses as does the nongeometric CastellGaines method which does however remain markedly closer to the manifold th an the stochastic Taylor scheme. .. Autonomous underwater vehicle. The dynamics of an ellipsoidal au tonomous underwater vehicle is prescribed by the state y psewhere sois its angular momentum and pRits linear momentum see Holmes Jenkins and Leonard Egeland Dalsmo and Srdalen and Marsden and Ratiu . We suppose that the vehicle is perturbed by two i ndependent multi plicative stochastic processes. The governing vector eld s are fori Viy ad iy. Hereiy parenleftbig iyuiyparenrightbig se whereiy I ianduiy M ipare the angular and linear velocity and Ii diagiii andMi diagiii are the constant moment of inertia and mass matrices respec tively. Explicitly for se we have ad ypup. The system of vector elds Vii represents the LiePoisson dynamics on MseMarsden and Ratiu . There are two independent Casimir s functions CkseRk namelyCpandCp these are conserved by the ow on se. IfGSESOR then the coadjoint action of SE on se AdSEseseis dened for all S sSE wheresSO andR andyseby yS Ad Syparenleftbig sspspparenrightbig . The corresponding innitesimal action sesesefor allse andy seis given by see Marsden and Ratiu p. yad y. Since ad y y y the governing set of vector elds on seare Viy iy. We can now pull back this ow on seto a ow on SE via y. The correspond ing ow on SE is generated by the governing set of vector elds for i XiSparenleftbig iysiyuiyparenrightbig Malham and Wiese withy yS. To aid implementation note that SE braceleftbig sSEsSO Rbracerightbig embeds into SLR via the map S smastoparenleftbiggs OTparenrightbigg whereOis the threevector of zeros. Also se is isomorphic to a Lie subalgebra of slR with elements of the form mastoparenleftbigg OTparenrightbigg . Hence the governing vector elds on SE are of the form XiiyS where iy parenleftbigg iuip OTparenrightbigg . The governing vector elds on se arevi dexpiparenleftbig yexpparenrightbig . Again the vector eld compositions ViVjneeded for the stochastic Taylor and CastellGaines methods can be computed straightforwardly. Direct calcula tion also reveals that in block matrix form vivjoparenleftbiggAij AppijApij OTparenrightbigg iyjy HereAyz is dened as for the rigid body example. Note that the expone ntial map expseseSE is dened for all se by expseparenleftbigg expso f OTparenrightbigg where expsois the exponential map from so toSO which can be computed using Rodrigues formula and see Bullo and Murray p. f I cosbadblbadblbadblbadblparenleftbig sinbadblbadblbadblbadblparenrightbigbadblbadbl. In Figure . we show the distance from the manifold seof each the three ap proximations in particular how far the individual traject ories stray from the Casimirs CpandCp. We start with the initial data y T. As before the stochastic Taylor MuntheKaas method can be se en to preserve the Casimirs to within machine error. We also see that the stocha stic Taylor method clearly drifts o the manifold as the integration time progr esses and at a particular time depending on the Wiener path shoots o very rapidly away from the manifold. Note also that for large stepsizes the stochastic Taylor met hod is unstable. However the nongeometric CastellGaines and stochastic MuntheK aas methods still give re liable results in that regime. . Conclusions. We have established and implemented stochastic Lie group integrators based on stochastic MuntheKaas methods and al so derived geometric CastellGaines methods. We have also revealed several aspe cts of these integrators that require further investigation.Stochastic Lie group integrators . . . timelogerror in Casimirs Stochastic Taylor CastellGaines MuntheKaas ................. logstepsizelogglobal errorNumber of sampled paths Stochastic Taylor CastellGaines MuntheKaas Fig. . . Autonomous underwater vehicle We show the logdistance of the approximate solution to the two Casimirs Cpdotted line and C psolid line as a function of time for each of the methods. Below we also show the global error as a funct ion of stepsize. . We could construct a stochastic nonlinear Magnus method b y approximating the solution to the stochastic dierential equation . o n the Lie algebra using Picard iterations see Casas and Iserles . . We would like to develop a practical procedure for impleme nting ordinary MuntheKaas methods for higher order CastellGaines integ rators. We need to de Malham and Wiese termine the element Mgso that in . we have . . We need to determine the properties of the local and global errors for the stochastic MuntheKaas methods. Also a thorough investiga tion of the stability prop erties of the stochastic MuntheKaas and CastellGaines me thods is required. For the autonomous underwater vehicle simulations they were bo th superior to the direct stochastic Taylor method especially for larger stepsizes . We also need to compare the relative eciency of the methods concerned in particular t o compare an optimally ecient geometric CastellGaines method with the stochast ic MuntheKaas method. . Although we have chiey conned ourselves to driving path s that are Wiener processes we can extend MuntheKaas and CastellGaines me thods to rougher driv ing paths Lyons and Qian Friz Friz and Victoir . Further what hap pens when we consider processes involving jumps For exampl e Srivastava Miller and Grenander consider jump diusion processes on matrix L ie groups for Bayesian inference. Or what if we consider fractional Brownian drivi ng paths Baudoin and Coutin investigate fractional Brownian motions on Lie g roups . Schi and Shnider have used Lie group methods to deriv e M obius schemes for numerically integrating deterministic Riccati system s beyond nite time removable singularities and numerical instabilities. They integrat e a linear system of equations on the general linear group GLn which corresponds to a Riccati ow on the Grass mannian manifold Gr kn via the M obius action map. Lord Malham and Wiese implemented stochastic M obius schemes and show that they c an be more accurate and cost eective than directly solving stochastic Riccati sys tems using stochastic Taylor methods. We would like to investigate further their eectiv eness for stochastic Ric cati equations arising in Kalman ltering Kloeden and Plat en and to backward stochastic Riccati equations arising in optimal stochasti c linearquadratic control see for example Kohlmann and Tang . . Other areas of potential application of the methods we hav e presented in this paper are for example termstructure interest rate models evolving on nite dimen sional invariant manifolds see Filipovic and Teichmann stochastic dynamics triggered by DNA damage Chickarmane Ray Sauro and Nadim and stochastic symplectic integrators for which the gradient of the soluti on evolves on the symplectic Lie group see Milstein and Tretyakov . Acknowledgments. We thank Alex Dragt Peter Friz Anders Hansen Terry Lyons PerChristian Moan and Hans MuntheKaas for stimula ting discussions. We would also thank the anonymous referees whose suggestions and encouragement im proved the original manuscript signicantly. Appendix A. Proof of Theorem .. We follow the proof for linear stochastic dierential equations in Lord Malham and Wiese where further technical details on estimates for multiple Stratonovich integrals can be fou nd. Suppose ttm is the truncated Lie series .. First we show that exp tyL. We see that for any number kparenleftbigtparenrightbigkyis a sum of Qmkterms each of which is a kmultiple product of terms Jcy. It follows that vextenddoublevextenddoubleparenleftbigtparenrightbigkyvextenddoublevextenddouble Lparenleftig max Qmbadblcybadblparenrightigk summationdisplay iQm i...kbadblJJJkbadblL. A. Note that the maximum of the norm of the compositions of vecto r eldscyis taken over a nite set. Repeated application of the product rule re veals that for i ...k Stochastic Lie group integrators each term JJJk in A. is the sum of at most mkStratonovich integrals J where fortbadblJbadblLmktk. Since the right hand side of equation A. consists of QmkmkStratonovich integrals J we conclude that vextenddoublevextenddoublevextenddoubleparenleftbigtparenrightbigkyvextenddoublevextenddoublevextenddouble Lparenleftig max Qmbadblcybadbl Qm mtparenrightigk . Hence exp tyis squareintegrable. Second we prove .. Let ytdenote the stochastic Taylor series solution trun cated to included terms of order up to and including tm. We have vextenddoublevextenddoubleytexptyvextenddoublevextenddouble Lvextenddoublevextenddoubleytytvextenddoublevextenddouble Lvextenddoublevextenddoubleytexptyvextenddoublevextenddouble L. We knowytLsee Lemma III.. in Gihman and Skorohod . Note that ytis a strong approximation to ytup to and including terms of order tm with the remainder consisting of Otm terms see Proposition .. in Kloeden and Platen . It follows from the denition of the exponential Lie series a s the logarithm of the stochastic Taylor series that the terms of order up to and in cludingtmin exp ty correspond with yt the error consists of Otm terms. Appendix B. Proof of Theorem .. Our proof follows along the lines of that for uniformly accurate Magnus integrators for linear const ant coecient systems see Lord Malham Wiese and Malham and Wiese . Let tntnand tntn denote the exact and approximate owmaps constructed on th e interval tntn of lengthh. We dene the local ow remainder as Rtntntntntntn and so the local remainder is Rtntnytn. LetRlsandRstdenote the local ow remainders corresponding to the exponential Lie series and stochastic Taylor approx imations respectively. B.. Order integrator two Wiener processes. For the global order integrators we have to leading order Rls JJVV andRstJVV JVV. Note that we have included the terms JV andJV in the integrators. A direct calculation reveals that Eparenleftbig RstyTRstyparenrightbig Eparenleftbig RlsyTRlsyparenrightbig hmUTBUOparenleftbig hm parenrightbig .B. Herem for the order integrators U VVyVVyTRn and BRnnconsists ofnndiagonal blocks of the form bijInnwhere b parenleftbigg parenrightbigg andInnis thennidentity matrix. Since bis positive semidenite the matrix B bInnis positive semidenite. Hence the order exponential Lie series integrator is locally more accurate than the corresponding stochastic Taylor integrator. B.. Order integrator one Wiener process. For the global order in tegrators we have to leading order Rls JJVV hVVV and RstJVVJVVJV hVVVVVV. The terms of order h Malham and Wiese shown are signicant when we consider the global error in Sec tion B. below. The esti mate B. also applies in this case with m andU VVyVVyV yT Rn andBRnnconsists ofnndiagonal blocks of the form bijInnwhere b . Sincebis positive semidenite the matrix BbInnis positive semidenite. Hence the order exponential Lie series integrator is local ly more accurate than the corresponding stochastic Taylor integrator. B.. Order integrator one Wiener process. The local ow remainders areRls parenleftbig JJJ hparenrightbig VVV andRstJVV JVVV JV VJV hVVVVVV. The terms of order hshown are signicant when we consider the global errorbut for a dier ent reason this time see Section B. below. Again the estimate B. applies in t his case with m andU V VyVVVyVV yV yTRn andBRnnconsists ofnndiagonal blocks of the form bijInnwhere b . AgainBis positive semidenite and the order exponential Lie series integrator is locally more accurate than the corresponding stochastic Taylor integrator. B.. Global error. We dene the strong global error at timeTassociated with an approximate solution yTasE badblyTyTbadblL. The exact and approximate solutions can be constructed by successively applying the exact and ap proximate ow maps tntnand tntnon the successive intervals tntn to the initial data y. A straightforward calculation shows that a for small xed ste psizeh EER yTR y B. up to higher order terms where R summationtextN ntntNRtntnttnis the standard accumulated local error contribution to the global error. T he important conclusion is that when we construct the global error B. the terms of le ading order in the local ow remainders RlsorRstwith zero expectation lose only a half order of convergence in this accumulation eect. Hence in the local ow remainder s shown above for the terms of zeroexpectation the local superior accuracy for the Lie series integrators transfers to the corresponding global errors see Lord Mal ham and Wiese for more details. Terms of nonzero expectation however beha ve like deterministic er ror terms losing a whole order in the local to global converg ence they contribute to the global error through their expectations. Hence we inc lude such terms of or derhin the order integrators above and they appear as the terms subtracted from the remainders shown. For the order integrators we do n ot need to include the orderhterms in the integrator to obtain the correct meansquare co nvergence. However to guarantee that the global error for the exponenti al Lie series integrator is always smaller than that for the stochastic Taylor scheme we include this term in the integrator.Stochastic Lie group integrators 
9,0704.0023,"  The very nature of the solar chromosphere, its structuring and dynamics,
remains far from being properly understood, in spite of intensive research.
Here we point out the potential of chromospheric observations at millimeter
wavelengths to resolve this long-standing problem. Computations carried out
with a sophisticated dynamic model of the solar chromosphere due to Carlsson
and Stein demonstrate that millimeter emission is extremely sensitive to
dynamic processes in the chromosphere and the appropriate wavelengths to look
for dynamic signatures are in the range 0.8-5.0 mm. The model also suggests
that high resolution observations at mm wavelengths, as will be provided by
ALMA, will have the unique property of reacting to both the hot and the cool
gas, and thus will have the potential of distinguishing between rival models of
the solar atmosphere. Thus, initial results obtained from the observations of
the quiet Sun at 3.5 mm with the BIMA array (resolution of 12 arcsec) reveal
significant oscillations with amplitudes of 50-150 K and frequencies of 1.5-8
mHz with a tendency toward short-period oscillations in internetwork and longer
periods in network regions. However higher spatial resolution, such as that
provided by ALMA, is required for a clean separation between the features
within the solar atmosphere and for an adequate comparison with the output of
the comprehensive dynamic simulations.
", The chromosphere remains the least understood layer of the solar atmosphere with the very basics of its struc ture being hotly debated is it better described by the classical picture of a steady temperature rise as a func tion of height with superposed weak oscillations e.g. semi empirical models of Vernazza et al. Fontenla et al. or does the temperature keep dropping out wards with very hot shocks producing strong localized heating radiation hydrodynamic simulations of Carls son Stein and Wedemeyer et al. The latter concept is consistent with the IR observations of carbon monoxide which require cool gas to be present at chromospheric heights see e.g. Ayres . Thus existing models cannot provide a complete de scription of the solar chromosphere. Consequently now adays two alternative pictures of the chromosphere co exist and the role played by chromospheric dynamics in the structuring of this atmospheric layer is a subject of intense scientic debate. One reason for conicting models is that they are based either on atomic chromospheric lines and con tinua in the UV or on molecular lines in the IR since UV observations are practically blind to cool gas in a dynamic chromosphere while the IR observations sam ple only the cool part of the chromosphere. Improved and more sensitive diagnostics of the chromospheric structure and dynamics that sample both the hot and MDI TRACE CaII K BIMA . mm Fig. Portrait of the solar chromosphere at the center of the Suns disk at dierent wavelengths on May . From top left t o bottom right MDI longitudinal photospheric magnetogram UV A image from TRACE CaII K line center image from BBSO and BIMA image at . mm. the cool gas and should distinguish between the ri val models are provided by observations at millime ter wavelengths with an acceptable spatial resolution as was proposed by Loukitcheva et al. . In this con tribution we review the unique chromospheric obser vations at . mm with the BerkeleyIllinoisMaryland Array and the analysis of the intensity variations ex pected from the model of Carlsson Stein for mm wavelengths. We postulate the requirements for mm ob servations with the future instruments with emphasis on spatial and temporal resolution. Finally we discuss the prospects for chromospheric studies with ALMA. Results . Analysis of the BIMA observations at . mm The BerkeleyIllinoisMaryland Array BIMA operat ing at a wavelength of . mm frequency of GHzhas been the only interferometer in the mm range fre quently used for solar observations. The BIMA tele scopes are now part of the CARMA array which will also carry out such observations. With the BIMA data obtained in the years and we have constructed twodimensional maps of the solar chromosphere with a resolution of which represents the highest spatial resolution achieved so far at this wavelength for non are solar observations. The BIMA images have led to new insights in to chromospheric structure and to the detection of spatiallyresolved chromospheric oscil lations at mm wavelengths. The details of the restora tion procedure and extensive tests of the sensitivity of the BIMA data to the detection of dynamic signatures can be found in White et al. . With the currently available resolution the contrast of the brightness structures is evaluated to be up to of the quietsun brightness at . mm White et al. . However the similarity of brightness struc tures derived from the mm images and seen in other chromospheric emissions Fig. in spite of the dier ence in resolution of the images resolution of the UV images implies that the BIMA resolution is not enough to resolve the millimeter ne structure and ob servations with spatial resolution much higher than are required. A detailed analysis of the relations be tween the millimeter emission magnetic eld and other chromospheric diagnostics is in preparation. In the millimeter brightness we detected intensity oscillations with typical amplitudes of K in the range of periods from to seconds frequency range . mHz. We found a tendency toward short period oscillations in internetwork and longer periods in network regions in the quiet Sun which is in good agree ment with the results obtained at other wavelengths. At mm the inner parts of the chromospheric cells exhibit a behavior typical of the internetwork with the maxi mum of the Fourier power in the minute range how ever most of the oscillations are quasiperiodic show ing up in wave trains of nite duration lasting for typi cally wave periods see also Loukitcheva et al. . . Analysis of the CS model millimeter spectrum The response of the submillimeter and millimeter ra diation to a timeseries generated by Carlsson Stein CS was computed under the assumption of thermal freefree radiation by Loukitcheva et al. . The results are depicted in Fig. as the excess intensity as a func tion of wavelength and time. ... mm times Fig. Evolution of the Carlsson Stein model millimeter spec trum with time. Negative grey scale representing excess int ensity as a function of time and wavelength. Wave periods of approximately min can be clearly distinguished in the intensity at all considered wave lengths. Though the dominant frequency of the oscilla tions changes slightly with wavelength for all mm wave lengths it lies in the range of minutes. The dierence from one period of time to another can be explained by the presence of merging shocks during certain time intervals. The dierences in the light curves at dierent wavelengths are caused primarily by the dierence in the formation heights of the emitted radiation. In general the amplitudes of the oscillations compared to the radiation temperature are large in this sense mm wavelength radiation combines the advantages of the CO lines which mainly see the cool gas with those of atomic lines and UV continua which mainly sample the hot gas. On the whole the brightness temperatures are ex tremely timedependent at millimeter wavelengths fol lowing changes in the atmospheric parameters. With increasing wavelength the amplitude of the brightness oscillations grows signicantly reaches its maximum value at . mm expected to be of the quietSun brightness temperature and decreases rapidly towards longer wavelengths. Thus we can identify the range . . mm as the appropriate range of mm wavelengths at which one can expect the clearest signatures of dynamic eects. A careful look at the mm brightness spectrum as a function of time see Fig. reveals a time delay between the oscillations at long and short millimeter wavelengths. Hence it is possible to study wave modes traveling in the chromosphere by comparing submm with mm observations. Discussion The CS model predicts that spatially and temporally resolved observations should clearly exhibit the signa tures of the strong shock waves. However a direct com parison of the observational data products RMS val ues histogram skewness Fourier and wavelet spectra etc. referring to regions with weak magnetic eld like the quiet Sun internetwork with the corresponding prod ucts expected from the simulations of Carlsson Stein exhibits large dierences. In particular the RMS of the brightness temperature is nearly an order of magnitude larger in the model K at mm than in the ob servations K. Another dierence is the absence of longer periods in the model power spectrum. But these discrepancies do not rule out the CS models. On the one hand the model is one dimensional and hence does not predict a coherence length of the oscillations while on the other hand we are not able to resolve individual oscillating elements due to the limited spatial resolution of the observations. Consequently we estimated the inuence of the spa tial smearing on the model parameters of chromospheric dynamics and on the observed oscillatory power. Thus we conrmed that the very limited spatial resolution currently available hinders a clean separation between cells and network and typically both network and in ternetwork areas contribute to the recorded BIMA ra diation. From the analysis of the observational data it was found that power in all frequency ranges increases signicantly with improving resolution. Consistency be tween the power predicted by the CS model and the observed power is obtained if the coherence length of oscillating elements is on the order of . Our results are consistent with Wedemeyer et al. who computed the millimeter wave signature re sulting from the D simulations of Wedemeyer et al. . Although the D simulations suer from the fact that the radiative transfer of energy is computed en tirely in LTE which becomes a poor assumption at chromospheric heights the authors believe that the chro mospheric pattern and its temporal evolution is repre sentative of the nonmagnetic internetwork regions of the solar chromosphere. The simulations display a com plex D structure of the chromospheric layers which is highly dynamical on temporal scales of s and on spatial scales comparable to solar granulation which is in good agreement with the size of oscillating ele ments that we deduced. According to Wedemeyer et al. the chromospheric temperature structure is charac terized by a pattern of hot shock waves which originate from convective motions and cool gas lying between the shocks. The intensity distribution at mm wavelengths follows the pattern of the shocks in the chromosphere with a sub arcsecond size of the features associated with the shocks. All this complex and dynamic D structure can be deduced from observations at mm wavelengths with a suciently high spatial resolution of better than . Summary Simultaneous mmsubmm observations at dierent wave lengths can be used for the tomography of the solar atmosphere as radiation at the dierent wavelengths originates from dierent layers with the average for mation height increasing with wavelength. Such obser vations also provide a strong test of present and future models. However observations that might be able to uncover the nature of the chromosphere should meet the following requirements multiband observations in mmsubmm domain . . mm to address shock waves and chromospheric oscillation modes arcsecond spatial resolution to resolve ne structure temporal resolution better than a few seconds to follow its evolution in time FOV size of order of accurate absolute calibration of the observations Bas tian These requirements look very similar to the techni cal specication of the continuum observations with the Atacama Large Millimeter Array ALMA which rep resents an enormous advance over existing instrumenta tion operating at mmsubmm wavelengths. ALMA will produce images of the highest resolution available for the foreseeable future although the technical problem of sampling both large and small spatial scales simulta neously required for highquality imaging of the chro mosphere will remain a challenge and will be the most sensitive instrument operating at submmmm wavelengths. To summarize ALMA will be an extraordinarily pow erful instrument for studying the solar chromosphere. It will nally allow the mapping of the threedimensional thermal structure of the solar chromosphere which will be a real breakthrough in solar studies. Acknowledgements The use of BIMA for scientic research carried out at the University of Maryland is supported by NSF grant AST. Solar research at the University of Mary land is supported by NSF grant ATM and NASA grants NAG NAG NAG and NAG . 
