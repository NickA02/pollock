arXiv:0704.0022v1  [math.NA]  31 Mar 2007STOCHASTIC LIE GROUP INTEGRATORSâˆ—
 SIMON J.A. MALHAM AND ANKE WIESE
 Abstract. We present Lie group integrators for nonlinear stochastic d iï¬€erential equations with
 non-commutative vector ï¬elds whose solution evolves on a sm ooth ï¬nite dimensional manifold. Given
 a Lie group action that generates transport along the manifo ld, we pull back the stochastic ï¬‚ow on
 the manifold to the Lie group via the action, and subsequentl y pull back the ï¬‚ow to the corresponding
 Lie algebra via the exponential map. We construct an approxi mation to the stochastic ï¬‚ow in the
 Lie algebra via closed operations and then push back to the Li e group and then to the manifold,
 thus ensuring our approximation lies in the manifold. We cal l such schemes stochastic Munthe-Kaas
 methods after their deterministic counterparts. We also pr esent stochastic Lie group integration
 schemes based on Castellâ€“Gaines methods. These involve usi ng an underlying ordinary diï¬€erential
 integrator to approximate the ï¬‚ow generated by a truncated s tochastic exponential Lie series. They
 become stochastic Lie group integrator schemes if we use Mun the-Kaas methods as the underlying
 ordinary diï¬€erential integrator. Further, we show that som e Castellâ€“Gaines methods are uniformly
 more accurate than the corresponding stochastic Taylor sch emes. Lastly we demonstrate our methods
 by simulating the dynamics of a free rigid body such as a satel lite and an autonomous underwater
 vehicle both perturbed by two independent multiplicative s tochastic noise processes.
 Key words. stochastic Lie group integrators
 AMS subject classiï¬cations. 60H10, 60H35, 93E20
 1. Introduction. We are interested in designing Lie group numerical schemes
 for the strong approximation of nonlinear Stratonovich sto chastic diï¬€erential equa-
 tions of the form
 yt=y0+d/summationdisplay
 i=0/integraldisplayt
 0Vi(yÏ„,Ï„)dWi
 Ï„. (1.1)
 HereW1,...,Wdaredindependent scalar Wiener processes and W0
 tâ‰¡t. We suppose
 that the solution yevolves on a smooth submanifold MofRnandVi:M Ã— R+â†’
 TM,i= 0,1,...,d , are smooth vector ï¬elds which in local coordinates are Vi=/summationtextn
 j=1Vj
 iâˆ‚yj. The ï¬‚ow-map Ï•t:M â†’ M of the integral equation (1.1) is deï¬ned as
 the map taking the initial data y0to the solution ytat timet, i.e.yt=Ï•tâ—¦y0.
 Our goal in this paper is to show how the Lie group integration methods developed
 by Munthe-Kaas and co-authors can be extended to stochastic diï¬€erential equations
 on smooth manifolds (see Crouch and Grossman [8] and Munthe- Kaas [36]). Suppose
 we know that the exact solution of a given system of stochasti c diï¬€erential equations
 evolves on a smooth submanifold MofRn, but we can only ï¬nd the solution pathwise
 numerically. How can we ensure that our approximate numeric al solution also lies in
 the manifold?
 Suppose we are given a ï¬nite dimensional Lie group Gand Lie group action Î› y0
 that generates transport across the manifold Mfrom the starting point y0âˆˆ M via
 elements of G. Then with any given elements Î¾in the Lie algebra gcorresponding
 to the Lie group G, we can associate the inï¬nitesimal action Î»Î¾using the Lie group
 action Î› y0. The map Î¾/maâˆšstoâ†’Î»Î¾is a Lie algebra homomorphism from gtoX(M),
 the Lie algebra of vector ï¬elds over the manifold M. Further the Lie subalgebra
 {Î»Î¾âˆˆX(M):Î¾âˆˆg}is isomorphic to the ï¬nite dimensional Lie algebra gwith the
 same structure constants (see Olver [38], p. 53 and Marsden a nd Ratiu [33], p. 318).
 âˆ—Maxwell Institute for Mathematical Sciences and School of M athematical and Computer Sciences,
 Heriot-Watt University, Edinburgh EH14 4AS, UK. (30/3/200 7)
 12 Malham and Wiese
 Conversely, suppose we know that the Lie algebra generated b y the set of govern-
 ing vector ï¬elds Vi,i= 0,1,...,d , onMis ï¬nite dimensional, call this XF(M). Then
 we know there exists a ï¬nite dimensional Lie group Gwhose Lie algebra ghas the
 same structure constants as XF(M) relative to some basis, and there is a Lie group
 action Î› y0such thatVi=Î»Î¾i,i= 0,1,...,d , for someÎ¾iâˆˆg(see Olver [38], p. 54 or
 Kunita [26], p. 194). The choice of group and action is not uni que.
 In this paper we assume that there is a ï¬nite dimensional Lie g roupGand action
 Î›y0such that our set of governing vector ï¬elds Vi,i= 0,1,...,d , are each inï¬nitesimal
 Lie group actions generated by some element in gvia Î› y0, i.e.Vi=Î»Î¾ifor someÎ¾iâˆˆg,
 i= 0,1,...,d . They are said to be fundamental vector ï¬elds. This means tha t we can
 write down the set of governing vector ï¬elds XÎ¾ifor a system of stochastic diï¬€erential
 equations on the Lie group Gthat, via the Lie group action Î› y0, generates the ï¬‚ow
 governed by the set of vector ï¬elds Vion the manifold. The vector ï¬elds VionMare
 simply the push forward of the vector ï¬elds XÎ¾ionGvia the Lie group action Î› y0.
 Typically the ï¬‚ow on the Lie group also needs to be computed nu merically. We thus
 want the approximation to remain in the Lie group so that the L ie group action takes
 us back to the manifold.
 To achieve this, we pull back the set of governing vector ï¬eld sXÎ¾ionGto the set
 of governing vector ï¬elds vÎ¾iong, via the exponential map â€˜expâ€™ from gtoG. Thus
 the stochastic ï¬‚ow generated on gby the vector ï¬elds vÎ¾igenerates the stochastic ï¬‚ow
 onGgenerated by the XÎ¾i. The set of governing vector ï¬elds on gare for each Ïƒâˆˆg:
 vÎ¾iâ—¦Ïƒâ‰¡âˆž/summationdisplay
 k=0Bk(adÏƒ)kâ—¦Î¾i, (1.2)
 whereBkis thekth Bernoulli number and the adjoint operator ad Ïƒis a closed operator
 ong, in fact ad Ïƒâ—¦Î¶= [Ïƒ,Î¶], the Lie bracket on g. Now the essential point is that
 Î¾iâˆˆgand so the series on the right or any truncation of it is closed ing. Hence
 if we construct an approximation to our stochastic diï¬€erent ial equation on gusing
 the vector ï¬elds vÎ¾ior an approximation of them achieved by truncating the serie s
 representation, then that approximation must reside in the Lie algebra g. We can then
 push the approximation in the Lie algebra forward onto the Li e group and then onto
 the manifold. Provided we compute the exponential map and ac tion appropriately, our
 approximate solution lies in the manifold (to within machin e accuracy). In summary,
 for a given Î¾âˆˆgand anyy0âˆˆ Mwe have the following commutative diagram:
 gexpâˆ—âˆ’ âˆ’ âˆ’ âˆ’ â†’ X(G)(Î›y0)âˆ—âˆ’ âˆ’ âˆ’ âˆ’ â†’ X(M)
 vÎ¾/arrowtpï£¦ï£¦/arrowtpï£¦ï£¦XÎ¾/arrowtpï£¦ï£¦Î»Î¾
 gexpâˆ’ âˆ’ âˆ’ âˆ’ â†’ GÎ›y0âˆ’ âˆ’ âˆ’ âˆ’ â†’ M
 We have implicitly separated the governing set of vector ï¬el dsVi,i= 0,1,...,d ,
 from the driving path process wâ‰¡(W1,...,Wd). Together they generate the unique
 ItË† o solution process yâˆˆ M to the stochastic diï¬€erential equation (1.1). When there
 is only one driving Wiener process ( d= 1) the ItË† o map w/maâˆšstoâ†’yis continuous in
 the topology of uniform convergence. When there are two or mo re driving processes
 (dâ‰¥2) the Universal Limit Theorem tells us that the ItË† o map w/maâˆšstoâ†’yis continuous
 in thep-variation topology, in particular for 2 â‰¤p <3 (see Lyons [28], Lyons and
 Qian [29] and Malliavin [32]). A Wiener path with dâ‰¥2 has ï¬nite p-variation forStochastic Lie group integrators 3
 p>2. This means that from a pathwise perspective, approximati ons toyconstructed
 using successively reï¬ned approximations to ware only guaranteed to converge to
 the correct solution y, if we include information about the LÂ´ evy chordal areas of
 the driving path process. Note however that the L2-norm of the 2-variation of a
 Wiener process is ï¬nite. In the Lie group integration proced ure prescribed above we
 must solve a stochastic diï¬€erential system on the Lie algebr agdeï¬ned by the set
 of governing vector ï¬elds vÎ¾iand the driving path process wâ‰¡(W1,...,Wd). In
 light of the Universal Limit Theorem and with stepsize adapt ivity in mind in future
 (see Gaines and Lyons [17]), we for instance use in our exampl es order 1 stochastic
 numerical methodsâ€”that include the LÂ´ evy chordal areaâ€”to s olve for the ï¬‚ow on the
 Lie algebra g.
 We have thus explained the idea behind Munthe-Kaas methods a nd how they can
 be generalized to the stochastic setting. The ï¬rst half of th is paper formalizes this
 procedure.
 In the second half of this paper, we consider autonomous vect or ï¬elds and con-
 struct stochastic Lie group integration schemes using Cast ellâ€“Gaines methods. This
 approach proceeds as follows. We truncate the stochastic ex ponential Lie series expan-
 sion corresponding to the ï¬‚ow Ï•tof the solution process yto the stochastic diï¬€erential
 equation (1.1). We then approximate the driving path proces swâ‰¡(W1,...,Wd) by
 replacing it by a suitable nearby piecewise smooth path in th e appropriate variation
 topology. An approximation to the solution ytrequires the exponentiation of the
 approximate truncated exponential Lie series. This can be a chieved by solving the
 system of ordinary diï¬€erential equations driven by the vect or ï¬eld that is the approx-
 imate truncated exponential Lie series. If we use ordinary M unthe-Kaas methods as
 the underlying ordinary diï¬€erential integrator the Castel lâ€“Gaines method becomes a
 stochastic Lie group integrator.
 Further, based on the Castellâ€“Gaines approach we then prese ntuniformly accurate
 exponential Lie series integrators that are globally more accurate than their stochastic
 Taylor counterpart schemes (these are investigated in deta il in Lord, Malham and
 Wiese [27] for linear stochastic diï¬€erential equations). T hey require the assumption
 that a suï¬ƒciently accurate underlying ordinary diï¬€erentia l integrator is used; that
 integrator could for example be an ordinary Lie group Munthe -Kaas method. In
 the case of two driving Wiener processes we derive the order 1 /2, and in the case
 of one driving Wiener process the order 1 uniformly accurate exponential Lie series
 integrators. As a consequence we conï¬rm the asymptotic eï¬ƒci ency properties for
 both these schemes proved by Castell and Gaines [8] (see Newt on [37] for more details
 on the concept of asymptotic eï¬ƒciency). We also present in th e case of one driving
 Wiener process a new order 3 /2 uniformly accurate exponential Lie series integrator
 (also see Lord, Malham and Wiese [27]).
 We present two physical applications that demonstrate the a dvantage of using
 stochastic Munthe-Kaas methods. First we consider a free ri gid body which for ex-
 ample could model the dynamics of a satellite. We suppose tha t it is perturbed by
 two independent multiplicative stochastic noise processe s. The governing vector ï¬elds
 are non-commutative and the corresponding exact stochasti c ï¬‚ow evolves on the unit
 sphere. We show that the stochastic Munthe-Kaas method, wit h an order 1 stochastic
 Taylor integrator used to progress along the corresponding Lie algebra, preserves the
 approximate solution in the unit sphere manifold to within m achine error. However
 when an order 1 stochastic Taylor integrator is used directl y, the solution leaves the
 unit sphere. The contrast between these two methods is more e mphatically demon-4 Malham and Wiese
 strated in our second application. Here we consider an auton omous underwater vehicle
 that is also perturbed by two independent multiplicative st ochastic noise processes.
 The exact stochastic ï¬‚ow evolves on the manifold which is the dual of the Euclidean
 Lie algebra se(3); two independent Casimirs are conserved by the exact ï¬‚ow . Again
 the stochastic Munthe-Kass method preserves the Casimirs t o within machine error.
 However the order 1 stochastic Taylor integrator is not only unstable for large step-
 sizes, but the solution drifts oï¬€ the manifold and makes a dra matic excursion oï¬€ to
 inï¬nity in the embedding space R6.
 Preserving the approximate ï¬‚ow on the manifold of the exact d ynamics may be a
 required property for physical or ï¬nancial systems driven b y smooth or rough pathsâ€”
 for general references see Iserles, Munthe-Kaas, NÃ¸rsett a nd Zanna [21], Hairer, Lubich
 and Wanner [19], Elworthy [12], Lyons and Qian [29] and Milst ein and Tretyakov [34].
 Stochastic Lie group integrators in the form of Magnus integ rators for linear stochastic
 diï¬€erential equations were investigated by Burrage and Bur rage [5]. They were also
 used in the guise of MÂ¨ obius schemes (see Schiï¬€ and Shnider [3 9]) to solve stochastic
 Riccati equations by Lord, Malham and Wiese [27] where they o utperformed direct
 stochastic Taylor methods. Further applications where the y might be applied include:
 backward stochastic Riccati equations arising in optimal s tochastic linear-quadratic
 control (Kohlmann and Tang [24]); jump diï¬€usion processes o n matrix Lie groups
 for Bayesian inference (Srivastava, Miller and Grenander [ 40]); fractional Brownian
 motions on Lie groups (Baudoin and Coutin [3]) and stochasti c dynamics triggered
 by DNA damage (Chickarmane, Ray, Sauro and Nadim [10]).
 Our paper is outlined as follows. In Section 2 we present the b asic geometric setup,
 sansstochasticity. In particular we present a generalized righ t translation vector ï¬eld
 on a Lie group that forms the basis of our subsequent transfor mation from the Lie
 group to the manifold. Using a Lie group action, this vector ï¬ eld pushes forward
 to an inï¬nitesimal Lie group action vector ï¬eld that generat es a ï¬‚ow on the smooth
 manifold. In Section 3 we specialize to the case of a matrix Li e group and using
 the exponential map, derive the pullback of the generalized right translation vector
 ï¬eld on the Lie group to the corresponding vector ï¬eld on the L ie algebra. To help
 give some context to our overall scheme, we provide in Sectio n 4 illustrative examples
 of manifolds and natural choices for associated Lie groups a nd actions that generate
 ï¬‚ows on those manifolds. Then in Section 5 we show how a ï¬‚ow on a smooth manifold
 corresponding to a stochastic diï¬€erential equation, can be generated by a stochastic
 ï¬‚ow on a Lie algebra via a Lie algebra action. We explicitly pr esent stochastic Munthe-
 Kaas Lie group integration methods in Section 6. We start the second half of our
 paper by reviewing the exponential Lie series for stochasti c diï¬€erential equations in
 Section 7. We show in Section 8 how to construct geometric sto chastic Castellâ€“Gaines
 numerical methods. In particular we also present uniformly accurate exponential Lie
 series numerical schemes that not only can be used as geometr ic stochastic integrators,
 but also are always more accurate than stochastic Taylor num erical schemes of the
 corresponding order. In Section 9 we present our concrete nu merical examples. Finally
 in Section 10 we conclude and present some further future app lications and directions.
 2. Lie group actions. Suppose Mis a smooth ï¬nite dimensional submanifold
 ofRn. We use X(M) to denote the Lie algebra of vector ï¬elds on the manifold M,
 equipped with the Lieâ€“Jacobi bracket [ U,V]â‰¡UÂ·âˆ‡Vâˆ’VÂ·âˆ‡U, for allU,VâˆˆX(M).
 LetGdenote a ï¬nite dimensional Lie group.
 Definition 2.1 ( Lie group action ).A left Lie group action of a Lie group Gon a
 manifold Mis a smooth map Î›:G Ã—M â†’ M satisfying for all yâˆˆ MandR,Sâˆˆ G:Stochastic Lie group integrators 5
 (1)Î›(id,y) =y; (2)Î›(R,Î›(S,y)) = Î›(RS,y). We denote Î›yâ—¦Sâ‰¡Î›(S,y).
 Hereafter we suppose y0âˆˆ M is ï¬xed and focus on the action map Î› y0:Gâ†’M .
 We assume that the Lie group action Î› is transitive, i.e. tran sport across the manifold
 from any point y0âˆˆ Mto any other point yâˆˆ Mcan always be achieved via a group
 elementSâˆˆ Gwithy= Î›y0â—¦S(Marsden and Ratiu [33], p. 310).
 We deï¬ne the Lie algebra gassociated with the Lie group Gto be the vector space
 of all right invariant vector ï¬elds on G. By standard construction this is isomorphic
 to the tangent space to Gat the identity idâ‰¡idG(see Olver [38], p. 43 or Marsden
 and Ratiu [33], p. 269).
 Definition 2.2 ( Generalized right translation vector ï¬eld ).Suppose we are
 given a smooth map Î¾:Mâ†’g. With each such map Î¾we associate a vector ï¬eld
 XÎ¾:G â†’X(G)deï¬ned as follows
 XÎ¾â—¦Sâ‰¡âˆ‚Ï„exp/parenleftbig
 Ï„Î¾(Î›y0â—¦S)/parenrightbig
 S/vextendsingle/vextendsingle
 Ï„=0
 forSâˆˆ G, where â€˜ expâ€™ is the usual local diï¬€eomorphism exp:gâ†’ Gfrom a neigh-
 bourhood of the zero element oâˆˆgto a neighbourhood of idâˆˆ G.
 Definition 2.3 ( Inï¬nitesimal Lie group action ).We associate with each vector
 ï¬eldXÎ¾:Gâ†’X(G)a vector ï¬eld Î»Î¾:Mâ†’X(M)as the push forward of XÎ¾fromGto
 MbyÎ›y0, i.e.Î»Î¾â‰¡/parenleftbig
 Î›y0/parenrightbig
 âˆ—XÎ¾, so that if Sâˆˆ Gandy= Î› y0â—¦Sâˆˆ M, then
 Î»Î¾â—¦yâ‰¡âˆ‚Ï„Î›y0â—¦Î³(Ï„)|Ï„=0,
 whereÎ³(t)âˆˆ G,Î³(0) =Sandâˆ‚Ï„Î³(Ï„) =XÎ¾â—¦Î³(Ï„)(the ï¬‚ow generated on Gby the
 vector ï¬eld XÎ¾starting at Sâˆˆ G). Naturally, as a vector ï¬eld Î»Î¾is linear, and also
 Î»Î¾â—¦yâ‰¡ LXÎ¾â—¦Î›y0â—¦S,
 the Lie derivative of Î›y0alongXÎ¾atSâˆˆ G.
 Remarks.
 1. Our deï¬nition for the generalized right translation vect or ï¬eldXÎ¾onGis
 motivated by the standard right translation vector ï¬eld use d to identify g, the vector
 space of right invariant vector ï¬elds on G, withTidG, the tangent space to Gat the
 identity. When Î¾âˆˆgis constant, XÎ¾âˆˆX(G) is right invariant and a Lie bracket
 onTidGcan be deï¬ned via right extension by the corresponding Lieâ€“J acobi bracket
 for the vector ï¬elds XÎ¾onX(G). UnlessÎ¾âˆˆgis constant, XÎ¾is not in general
 right invariant. For further details see Varadarajan [43], Olver [38], or Marsden and
 Ratiu [33].
 2. The inï¬nitesimal generator map Î¾/maâˆšstoâ†’Î»Î¾fromgtoX(M) is a Lie algebra
 homomorphism. If we identify gas the vector space of left invariant vector ï¬elds on G
 this map becomes an anti-homomorphism. The Lieâ€“Jacobi brac ket as deï¬ned above
 gives the right (rather than left) Lie algebra stucture over the group of diï¬€eomorphisms
 onM. If in addition we take the Lieâ€“Jacobi bracket to be minus tha t deï¬ned aboveâ€”
 associated with the left Lie algebra structureâ€”then the inï¬ nitesimal generator map
 becomes a homomorphism again. See for example Marsden and Ra tiu [33], p. 324 or
 Munthe-Kaas [36].
 3. A comprehensive study of the systematic construction of s ymmetry Lie groups
 from given vector ï¬elds can be found in Olver [38].
 4. We assumed above that the vector ï¬elds XÎ¾andÎ»Î¾are autonomous. However
 all results in this and subsequent sections up to Section 7 ca n be straightforwardly
 extended to non-autonomous vector ï¬elds generated by Î¾:M Ã— Râ†’gwith (y,t)/maâˆšstoâ†’
 Î¾(y,t) for allyâˆˆ MandtâˆˆR.6 Malham and Wiese
 5. The map Î›( S):Mâ†’M deï¬ned by y/maâˆšstoâ†’Î›(S)â—¦yâ‰¡Î›yâ—¦Srepresents a
 ï¬‚ow on M. Hence if y= Î›(S)â—¦y0, the push forward of Î»Î¾by Î›(S) is given by/parenleftbig
 Î›(S)/parenrightbig
 âˆ—Î»Î¾â‰¡Î»AdSÎ¾(Marsden and Ratiu [33], p. 317).
 6. If the action is eï¬€ective/faithful then the map S/maâˆšstoâ†’Î›(S) from Gto Diï¬€( M),
 the group of diï¬€eomorphisms on M, is one-to-one. If the action is freeso that Î› y0
 is one-to-one and the only ï¬xed point is the identity element idâˆˆ G, then Î› y0is a
 diï¬€eomorphism (see Marsden and Ratiu [33], p. 310).
 3. Pull back to the Lie algebra. For ease of presentation, we will assume in
 this section that Gis a matrix Lie group. Recall that the exponential map exp: gâ†’ G
 is a local diï¬€eomorphism from a neighbourhood of oâˆˆgto a neighbourhood of idâˆˆ G.
 LetvÎ¾:gâ†’gbe the pull back of the vector ï¬eld XÎ¾:Gâ†’X(G) from Gtogvia the
 exponential mapping exp: gâ†’G, i.e.vÎ¾â—¦Ïƒâ‰¡expâˆ—XÎ¾â—¦Ïƒ. IfÏƒâˆˆgthen
 vÎ¾â—¦Ïƒ= dexpâˆ’1
 Ïƒâ—¦Î¾/parenleftbig
 Î›y0â—¦expÏƒ/parenrightbig
 . (3.1)
 Here dexpâˆ’1
 Ïƒ:gâ†’gis the inverse of the right-trivialized tangent map of the ex ponential
 dexpÏƒ:gâ†’gdeï¬ned as follows. If Î²(Ï„) is a curve in gsuch thatÎ²(0) =Ïƒand
 Î²â€²(0) =Î·âˆˆgthen dexp: gÃ—gâ†’gis the local smooth map (Varadarajan [43], p. 108)
 dexpÏƒâ—¦Î·â‰¡âˆ‚Ï„expÎ²(Ï„)|Ï„=0exp(âˆ’Ïƒ)
 =/parenleftbiggexp(ad Ïƒ)âˆ’id
 adÏƒ/parenrightbigg
 â—¦Î·.
 Note that as a tangent map dexpÏƒ:gâ†’gis linear. The inverse operator dexpâˆ’1
 Ïƒis the
 operator series (1.2) generated by considering the recipro cal of dexpÏƒ.
 To show that (3.1) is true, if exp: gâ†’GwithÏƒ/maâˆšstoâ†’S= expÏƒ, andÎ²(Ï„)âˆˆgwith
 Î²(0) =Ïƒandâˆ‚Ï„Î²(Ï„) =vÎ¾â—¦Î²(Ï„), then:
 expâˆ—vÎ¾â—¦S=âˆ‚Ï„expÎ²(Ï„)|Ï„=0
 =/parenleftbig
 dexpÏƒâ—¦vÎ¾â—¦Ïƒ/parenrightbig
 exp(Ïƒ)
 â‰¡XÎ¾â—¦S.
 Since â€˜expâ€™ is a diï¬€eomorphism in a neighbourhood of oâˆˆg, this push forward calcu-
 lation establishes the pull back (3.1) for all Ïƒâˆˆgin that neighbourhood.
 4. Illustrative examples. Suppose the vector ï¬eld V:M Ã— Râ†’X(M) gener-
 ates a ï¬‚ow solution ytâˆˆ Mstarting from y0âˆˆ M, where Mis a smooth submanifold
 ofRn. Then assume there exists a:
 1. Lie group Gwith corresponding Lie algebra g;
 2. Lie group action Î› y0:Gâ†’M for which a starting point y0âˆˆ Mis ï¬xed;
 3. Vector ï¬eld Î»Î¾:M Ã— Râ†’X(M) such that: Vâ‰¡Î»Î¾, i.e.Vis a fundamental
 vector ï¬eld corresponding to the action Î› y0.
 Let us suppose Gis a matrix Lie group (or can be embedded into a matrix Lie
 group, for example the Euclidean group SE(3) is naturally embedded into the special
 linear group SL(4;R)). We have for all Sâˆˆ GandtâˆˆR,
 XÎ¾(S,t)â‰¡Î¾/parenleftbig
 Î›y0(S),t/parenrightbig
 S. (4.1)
 IfV=Î»Î¾for someÎ¾:Mâ†’g, some Lie group Gand corresponding action Î› y0, then
 the ï¬‚ow generated by XÎ¾onGdrives the ï¬‚ow generated by VonM. In each of the
 examples below, given the manifold M, we present a natural Lie group and action
 associated with the manifold structure, and identify vecto r ï¬elds which generate ï¬‚ows
 on the manifold via the Lie group.Stochastic Lie group integrators 7
 Stiefel manifold Vn,k.Suppose M=Vn,kâ‰¡ {yâˆˆRnÃ—k:yTy=I}. Take
 G=SO(n), the special orthogonal group, and Î› y0(S)â‰¡Sy0, the action of left
 multiplication. The corresponding Lie algebra g=so(n). Then by direct calculation
 Î»Î¾(y) =Î¾(y,t)y. Hence if the given vector ï¬eld V(y,t) =Î¾(y,t)y, then the push
 forward of the ï¬‚ow generated by XÎ¾(S,t) onGin (4.1) is the ï¬‚ow generated by Von
 M. Note that the unit sphere S2âˆ¼=V3,1, i.e. S2is just a particular Stiefel manifold.
 In Section 9 as an application, we consider rigid body dynami cs evolving on S2.
 Isospectral manifold Sn.Suppose M=Sn={yâˆˆRnÃ—n:yT=y}, the set of
 nÃ—nreal symmetric matrices. Take G=O(n), the orthogonal group and Î› y0(S)â‰¡
 Sy0ST, which is an isospectral action (Munthe-Kaas [36]). The cor responding Lie
 algebra is g=so(n). Again, by direct calculation Î»Î¾(y) =Î¾(y,t)yâˆ’yÎ¾(y,t). Hence
 if the given vector ï¬eld V(y,t) =Î¾(y,t)yâˆ’yÎ¾(y,t), then the push forward of the ï¬‚ow
 generated by XÎ¾(S,t) onGin (4.1), is the ï¬‚ow generated by VonM.
 Dual of the Euclidean algebra se(3)âˆ—.Suppose M=se(3)âˆ—âˆ¼=R3, the dual
 of the Euclidean algebra se(3) of the Euclidean group SE(3) =/braceleftbig
 (s,Ï)âˆˆSE(3):sâˆˆ
 SO(3), ÏâˆˆR3/bracerightbig
 . Take G=SE(3) so g=se(3) and Î› â‰¡Adâˆ—:G Ã—gâˆ—â†’gâˆ—, the
 coadjoint action of Gongâˆ—. Then by direct calculation Î»Î¾(y) =âˆ’adâˆ—
 Î¾(y). Since
 Î»Î¾(y) in linear in Î¾andâˆ’Î»Î¾(y)â‰¡Î»âˆ’Î¾(y), it follows that if V(y) = adâˆ—
 Î¾(y), then
 the push forward of the ï¬‚ow generated by Xâˆ’Î¾(S,t) =âˆ’Î¾/parenleftbig
 Î›y0(S),t/parenrightbig
 SonGis the
 ï¬‚ow generated by VonM. For more details see Section 9 where we investigate the
 dynamics of an autonomous underwater vehicle evolving on se(3)âˆ—.
 Grassmannian manifold Gr(k,n).The Grassmannian manifold M= Gr(k,n)
 is the space of k-dimensional subspaces of Rn. Take G= GL(n), the general linear
 matrix group, where if SâˆˆGL(n), we identify
 S=/parenleftbiggÎ± Î²
 Î³ Î´/parenrightbigg
 ,
 where the block matrices Î±,Î²,Î³andÎ´are sizeskÃ—k,kÃ—(nâˆ’k), (nâˆ’k)Ã—kand
 (nâˆ’k)Ã—(nâˆ’k), respectively (see Schiï¬€ and Shnider [39]; Munthe-Kaas [3 6]). We
 choose the action of GL( n) on Gr(k,n) to be the generalized MÂ¨ obius transformation
 Î›y0(S) = (Î±y0+Î²)(Î³y0+Î´)âˆ’1. Hence if
 Î¾(t) =/parenleftbigga(t)b(t)
 c(t)d(t)/parenrightbigg
 ,
 then direct calculation reveals that Î»Î¾(y) =a(t)y+b(t)âˆ’yc(t)yâˆ’yd(t). Hence if the
 given vector ï¬eld V(y) =a(t)y+b(t)âˆ’yc(t)yâˆ’yd(t), then the push forward of the
 ï¬‚ow generated by XÎ¾(S,t) =Î¾(t)SonGis the ï¬‚ow generated by Von Gr(k,n).
 5. Stochastic Lie group integration. We show that if a Lie group action
 Î›:G Ã—Mâ†’M exists, then for y0âˆˆ Mï¬xed, the Lie algebra action Î› y0â—¦exp:gâ†’M
 carries a ï¬‚ow on gto a ï¬‚ow on M.
 Theorem 5.1. Suppose there exists a Lie group action Î›:G Ã— Mâ†’M . Then if
 there exist an ItË† o process Ïƒâˆˆgand a stopping time Tâˆ—such that on [0,Tâˆ—),Ïƒsatisï¬es
 the stochastic diï¬€erential equation
 Ïƒt=d/summationdisplay
 i=0/integraldisplayt
 0vÎ¾iâ—¦ÏƒÏ„dWi
 Ï„, (5.1)8 Malham and Wiese
 then the ItË† o process y= Î› y0â—¦expÏƒâˆˆ Msatisï¬es the stochastic diï¬€erential equation
 on[0,Tâˆ—):
 yt=y0+d/summationdisplay
 i=0/integraldisplayt
 0Î»Î¾iâ—¦yÏ„dWi
 Ï„. (5.2)
 Proof. Using ItË† oâ€™s lemma, if Ïƒtâˆˆgsatisï¬es (5.1) then Î› y0â—¦expÏƒtsatisï¬es
 Î›y0â—¦expÏƒt= Î› y0â—¦expo+d/summationdisplay
 i=0/integraldisplayt
 0LvÎ¾iâ—¦Î›y0â—¦expÏƒÏ„dWi
 Ï„.
 Now recall that for each i= 0,1,...,d ,XÎ¾iis the push forward of vÎ¾ifromgtoGvia
 the exponential map, and that Î»Î¾iis the push forward of XÎ¾ifromGtoMvia Î› y0
 and so the Lie derivative
 LvÎ¾iâ—¦Î›y0â—¦expÏƒtâ‰¡Î»Î¾iâ—¦yt.
 Then since yt= Î›y0â—¦expÏƒt, we conclude that yâˆˆ Mis an ItË† o process satisfying the
 stochastic diï¬€erential equation (5.2).
 Corollary 5.2. Suppose that for each i= 0,1,...,d there exists Î¾i:Gâ†’gsuch
 that the vector ï¬eld Vi:Mâ†’X(M)andÎ»Î¾i:Mâ†’X(M)can be identiï¬ed, i.e.
 Viâ‰¡Î»Î¾i. (5.3)
 Then the push forward by â€˜ Î›y0â—¦expâ€™ of the ï¬‚ow on the Lie algebra manifold ggenerated
 by the stochastic diï¬€erential equation (5.1)is the ï¬‚ow on the smooth manifold M
 generated by the stochastic diï¬€erential equation (5.2), whose solution can be expressed
 in the form yt= Î› y0â—¦expÏƒt.
 Remark. If the action is free then â€˜Î› y0â—¦expâ€™ is a diï¬€eomorphism from a neigh-
 bourhood of oâˆˆgto a neighbourhood of y0âˆˆ M.
 6. Stochastic Munthe-Kaas methods. Assuming that the vector ï¬elds in our
 original stochastic diï¬€erential equation (1.1) are fundam ental and satisfy (5.3), then
 stochastic Munthe-Kaas methods are constructed as follows :
 1. Subdivide the global interval of integration [0 ,T] into subintervals [ tn,tn+1].
 2. Starting with t0= 0, repeat the next two steps over successive intervals
 [tn,tn+1] untiltn+1=T.
 3. Compute an approximate solution Ë† Ïƒtn,tn+1to (5.1) across [ tn,tn+1] using a
 stochastic Taylor, stochastic Rungeâ€“Kutta or Castellâ€“Gai nes method.
 4. Compute the approximate solution ytn+1â‰ˆÎ›ytnâ—¦exp Ë†Ïƒtn,tn+1.
 Note that by construction Ë† Ïƒtn,tn+1âˆˆgbecause the stochastic diï¬€erential equa-
 tion (5.1) (or any stochastic Taylor or other sensible appro ximation) evolves the so-
 lution locally on the Lie algebra gvia the vector ï¬elds vÎ¾i:gâ†’g. Suitable methods
 for approximating the exponential map to ensure it maps gtoGappropriately can be
 found in Iserles and Zanna [22]. Then by construction ytn+1âˆˆ M.
 For example, with two Wiener processes and autonomous vecto r ï¬eldsvÎ¾iâ—¦Ïƒ, an
 order 1 stochastic Taylor Munthe-Kaas method is based on
 Ë†Ïƒtn,tn+1=/parenleftbig
 J0v0+J1v1+J2v2+1
 2J2
 1v2
 1+J12v2v1+J21v1v2+1
 2J2
 2v2
 2/parenrightbig
 â—¦o,(6.1)
 evaluated at the zero element oâˆˆg. Typically â€˜dexpâˆ’1
 Ïƒâ€™ is truncated to only include
 the necessary low order terms to maintain the order of the num erical scheme.Stochastic Lie group integrators 9
 Remark. It is natural to invoke Adoâ€™s Theorem (see for example Olver [ 38] p. 48):
 any ï¬nite dimensional Lie algebra is isomorphic to a Lie suba lgebra of gl(n) (the
 general linear algebra) for some nâˆˆN. However as Munthe-Kaas [36] points out,
 directly using a matrix representation for the given Lie gro up might not lead to the
 optimal computational implementation (other data structu res might do so).
 7. Exponential Lie series. The stochastic Taylor series is known in diï¬€erent
 contexts as the Neumann series ,Peanoâ€“Baker series orFeynmanâ€“Dyson path ordered
 exponential . If the vector ï¬elds in the stochastic diï¬€erential equation (1.1) are au-
 tonomous (which we assume henceforth), i.e. for all i= 0,1,...,d ,Vi=Vi(y) only,
 then the stochastic Taylor series for the ï¬‚ow is
 Ï•t=âˆž/summationdisplay
 m=0/summationdisplay
 Î±âˆˆPmJÎ±1Â·Â·Â·Î±m(t)VÎ±mÂ·Â·Â·VÎ±1.
 Here Pmis the set of all combinations of multi-indices Î±= (Î±1,...,Î± m) of length m
 withÎ±iâˆˆ {0,1,...,d }and
 JÎ±1Â·Â·Â·Î±m(t)â‰¡/integraldisplayt
 0Â·Â·Â·/integraldisplayÏ„mâˆ’1
 0dWÎ±1
 Ï„mÂ·Â·Â·dWÎ±m
 Ï„1
 are multiple Stratonovich integrals.
 The logarithm of Ï•tis theexponential Lie series ,Magnus expansion (Magnus [30])
 orChenâ€“Strichartz formula (Chen [9], Strichartz [41]). In other words we can express
 the ï¬‚ow map in the form Ï•t= expÏˆt, where
 Ïˆt=d/summationdisplay
 i=0Ji(t)Vi+d/summationdisplay
 i,j=01
 2(Jjiâˆ’Jij)(t)[Vi,Vj] +Â·Â·Â·
 is the exponential Lie series for our system, and [ Â·,Â·] is the Lieâ€“Jacobi bracket on
 X(M). See Yamato [44], Kunita [25], Ben Arous [1] and Castell [7] for the derivation
 and convergence of the exponential Lie series expansion in t he stochastic context;
 Strichartz [41] for the full explicit expansion; Sussmann [ 42] for a related product
 expansion and Lyons [28] for extensions to rough paths.
 Let us denote the truncated exponential Lie series by
 Ë†Ïˆt=/summationdisplay
 Î±âˆˆQmJÎ±cÎ±, (7.1)
 where Qmdenotes the ï¬nite set of multi-indices Î±for which /baâˆ‡dblJÎ±/baâˆ‡dblL2is of order up to
 and including tm, wherem= 1/2,1,3/2,.... The terms cÎ±are linear combinations
 of ï¬nitely many (length Î±) products of the smooth vector ï¬elds Vi,i= 0,1,...,d .
 The following asymptotic convergence result can be establi shed along the lines of the
 proof for linear stochastic diï¬€erential equations in Lord, Malham and Wiese [27]; we
 provide a proof in Appendix A.
 Theorem 7.1. Assume the vector ï¬elds Viare Lipschitz continuous and satisfy
 /baâˆ‡dblVi(y)/baâˆ‡dbl2
 2â‰¤c(1+/baâˆ‡dbly/baâˆ‡dbl2
 2)for allyâˆˆ M,i= 0,1,...,d and somec>0. Then fortâ‰¤1,
 the ï¬‚ow expË†Ïˆtâ—¦y0is square-integrable, where Ë†Ïˆtis the truncated Lie series (7.1).
 Further, ifyis the solution of the stochastic diï¬€erential equation (1.1), there exists a
 constantC/parenleftbig
 m,/baâˆ‡dbly0/baâˆ‡dbl2/parenrightbig
 such that
 /vextenddouble/vextenddoubleytâˆ’expË†Ïˆtâ—¦y0/vextenddouble/vextenddouble
 L2â‰¤C/parenleftbig
 m,/baâˆ‡dbly0/baâˆ‡dbl2/parenrightbig
 tm+1/2. (7.2)10 Malham and Wiese
 8. Geometric Castellâ€“Gaines methods. Consider the truncated exponential
 Lie series Ë†Ïˆtn,tn+1across the interval [ tn,tn+1]. We approximate higher order multiple
 Stratonovich integrals across each time-step by their expe ctations conditioned on the
 increments of the Wiener processes on suitable subdivision s (Gaines and Lyons [17]).
 An approximation to the solution of the stochastic diï¬€erent ial equation (1.1) across
 the interval [ tn,tn+1] is given by the ï¬‚ow generated by the truncated and condition ed
 exponential Lie series Ë†Ïˆtn,tn+1via
 ytn+1â‰ˆexp/parenleftbigË†Ïˆtn,tn+1/parenrightbig
 â—¦ytn.
 Hence the solution to the stochastic diï¬€erential equation ( 1.1) can be approximately
 computed by solving the ordinary diï¬€erential system (see Ca stell and Gaines [8];
 Misawa [35])
 uâ€²(Ï„) =Ë†Ïˆtn,tn+1â—¦u(Ï„) (8.1)
 across the interval Ï„âˆˆ[0,1]. Then if u(0) =ytnwe will get u(1)â‰ˆytn+1. We
 must choose a suï¬ƒciently accurate ordinary diï¬€erential int egrator to solve (8.1)â€”we
 implicitly assume this henceforth.
 The set of governing vector ï¬elds Vi,i= 0,1,...,d , prescribes a map from the
 driving path process wâ‰¡(W1,...,Wd) to the unique ItË† o solution process yâˆˆ Mto
 the stochastic diï¬€erential equation (1.1). The map w/maâˆšstoâ†’yis called the ItË† o map. Recall
 that we assume the vector ï¬elds are smooth. When there is only one driving Wiener
 process (d= 1) the ItË† o map is continuous in the topology of uniform conv ergence
 (Theorem 1.1.1. in Lyons and Qian [29]). When there are two or more driving pro-
 cesses (dâ‰¥2) the Universal Limit Theorem (Theorem 6.2.2. in Lyons and Q ian [29])
 tells us that the ItË† o map is continuous in the p-variation topology, in particular for
 2â‰¤p<3. A Wiener path with dâ‰¥2 hasp-variation with p>2, and thep-variation
 metric in this case includes information about the LÂ´ evy cho rdal areas of the path
 (Lyons [28]). Hence we must choose suitable piecewise smoot h approximations to the
 driving path process w. The following result follows from the corresponding resul t for
 ordinary diï¬€erential equations in Hairer, Lubich and Wanne r [19] (p. 112) as well as
 directly from Chapter VIII in Malliavin [32] on the Transfer Principle.
 Lemma 8.1. A necessary and suï¬ƒcient condition for the solution to the st ochas-
 tic diï¬€erential equation (1.1)to evolve on a smooth submanifold MofRnup to a
 stopping time Tâˆ—is thatVi(y,t)âˆˆTyMfor allyâˆˆ M,i= 0,1,...,d .
 Hence the stochastic Taylor expansion for the ï¬‚ow Ï•tis a diï¬€eomorphism on M.
 However a truncated version of the stochastic Taylor expans ion for the ï¬‚ow Ë† Ï•twill not
 in general keep you on the manifold, i.e. if y0âˆˆ M then Ë†Ï•tâ—¦y0need not necessarily
 lie inM. On the other hand, the exponential Lie series Ïˆt, or any truncation Ë†Ïˆtof
 it, lies in X(M). By Lemma 8.1 this is a necessary and suï¬ƒcient condition for the
 corresponding ï¬‚ow-map exp Ë†Ïˆtto be a diï¬€eomorphism on M. Hence ifu(0) =ytnâˆˆ
 M, thenytn+1â‰ˆu(1)âˆˆ M. When solving the ordinary diï¬€erential equation (8.1),
 classical geometric integration methods, for example Lie g roup integrators such as
 Rungeâ€“Kutta Munthe-Kaas methods, over the interval Ï„âˆˆ[0,1] will numerically
 ensureytn+1stays in M. Additionally, as the following result reveals, numerical
 methods constructed using the Castellâ€“Gaines Lie series ap proach can also be more
 accurate (a proof is provided in Appendix B).
 Theorem 8.2. In the case of two independent Wiener processes and under the
 assumptions of Theorem 7.1, for any initial condition y0âˆˆ Mand a suï¬ƒciently smallStochastic Lie group integrators 11
 ï¬xed stepsize, the order 1/2Lie series integrator is globally more accurate in L2than
 the order 1/2stochastic Taylor integrator. In addition, in the case of on e Wiener
 process, the order 1and3/2 uniformly accurate exponential Lie series integrators
 generated by Ë†Ïˆ(1)
 tn,tn+1=J0V0+J1V1+h2
 12/parenleftbig
 [V1,[V1,V0]]/parenrightbig
 and
 Ë†Ïˆ(3/2)
 tn,tn+1=J0V0+J1V1+1
 2(J10âˆ’J01)[V0,V1] +h2
 12/parenleftbig
 [V1,[V1,V0]]/parenrightbig
 ,
 respectively, are globally more accurate in L2than their corresponding stochastic Tay-
 lor integrators.
 Remarks.
 1. The result for Ë†Ïˆ(3/2)is new. That the order-1 /2 Lie series integrator (for two
 Wiener processes) and the order 1 integrator generated by Ë†Ïˆ(1)are uniformly more
 accurate conï¬rms the asymptotically eï¬ƒcient properties of these schemes proved by
 Castell and Gaines [8]. The proof follows along the lines of a n analogous result for
 linear stochastic systems considered in Lord, Malham and Wi ese [27].
 2. Consider the order 1 /2 exponential Lie series with no vector ï¬eld commu-
 tations. Solving the ordinary diï¬€erential equation (8.1) u sing an (ordinary) Euler
 Munthe-Kaas method and approximating dexpâˆ’1
 Ïƒâ‰ˆidis equivalent to the order 1 /2
 stochastic Taylor Munthe-Kaas method (for the same Lie grou p and action).
 9. Numerical examples.
 9.1. Rigid body. We consider the dynamics of a rigid body such as a satellite
 (see Marsden and Ratiu [33]). We will suppose that the rigid b ody is perturbed by two
 independent multiplicative stochastic processes W1andW2with the corresponding
 vector ï¬elds Vi(y)â‰¡Î¾i(y)y, fori= 0,1,2, withÎ¾iâˆˆso(3). If we normalize the initial
 datay0so that |y0|= 1 then the dynamics evolves on M=S2. We naturally suppose
 G=SO(3), and Î› y0(S)â‰¡Sy0so thatÎ»Î¾i(y) =Î¾i(y)y, and we can pull back the
 ï¬‚ow generated by VonMto the ï¬‚ow on Ggenerated by XÎ¾i(S,t) =Î¾i/parenleftbig
 Î›y0(S)/parenrightbig
 S,
 i= 0,1,2. We use the following matrix representation for the Î¾i(y)âˆˆso(3):
 Î¾i(y) =ï£«
 ï£­0 âˆ’y3/Î±i,3y2/Î±i,2
 y3/Î±i,3 0 âˆ’y1/Î±i,1
 âˆ’y2/Î±i,2y1/Î±i,1 0ï£¶
 ï£¸,
 where the constants Î±i,jforj= 1,2,3 are chosen so that the vector ï¬elds Viand
 matricesÎ¾ido not commute for i= 0,1,2:Î±0,1= 3,Î±0,2= 1,Î±0,3= 2,Î±1,1= 1,
 Î±1,2= 1/2,Î±1,3= 3/2,Î±2,1= 1/4,Î±2,2= 1,Î±2,3= 1/2. The vector ï¬elds Visatisfy
 the conditions of Theorem 7.1 since the manifold is compact i n this case.
 We will numerically solve (1.1) using three diï¬€erent order 1 methods: stochastic
 Taylor, stochastic Taylor Munthe-Kaas based on (6.1) and Ca stellâ€“Gaines (a stan-
 dard non-geometric Rungeâ€“Kutta method is used to solve the o rdinary diï¬€erential
 equation (8.1)). The vector ï¬eld compositions ViVjneeded for the stochastic Taylor
 and Castellâ€“Gaines methods are readily computed. For the Mu nthe-Kaas method we
 note that we have vÎ¾iâ—¦o=Î¾i(y0) and
 vÎ¾ivÎ¾jâ—¦o=Ë†A(y0,y0;Î±i,Î±j)âˆ’1
 2[Î¾i(y0),Î¾j(y0)].
 Hereoâˆˆso(3) is the zero element on the Lie algebra, and for all y,zâˆˆR3we deï¬ne
 A(y,z;Î±,Î²)â‰¡ï£«
 ï£­/parenleftbigy2z3
 Î±2âˆ’y3z2
 Î±3/parenrightbig1
 Î²1 /parenleftbigy3z1
 Î±3âˆ’y1z3
 Î±1/parenrightbig1
 Î²2 /parenleftbigy1z2
 Î±1âˆ’y2z1
 Î±2/parenrightbig1
 Î²3ï£¶
 ï£¸,12 Malham and Wiese
 012345678910âˆ’16âˆ’14âˆ’12âˆ’10âˆ’8âˆ’6âˆ’4âˆ’20
 timelog(distance from manifold)
   
 Stochastic Taylor
 Castellâˆ’Gaines
 Muntheâˆ’Kaas
 Fig. 9.1 . Rigid body: We show the log-distance of the approximate solution to the u nit sphere
 as a function of time for each of the methods. Below we show the approximate solutions as a function
 of time for the stochastic Taylor (blue) and Munthe-Kaas met hods (magenta). The trajectory starts
 at the top right and eventually drifts over the left horizon.Stochastic Lie group integrators 13
 and Ë†: R3â†’so(3) denotes the vector space isomorphism Ïƒ/maâˆšstoâ†’Ë†Ïƒwhere
 Ë†Ïƒâ‰¡ï£«
 ï£­0âˆ’Ïƒ3Ïƒ2
 Ïƒ30âˆ’Ïƒ1
 âˆ’Ïƒ2Ïƒ10ï£¶
 ï£¸.
 Note that Ë†yzâ‰¡yâˆ§z(see Marsden and Ratiu [33]). Note also since Ïƒâˆˆso(3),
 expÏƒâˆˆSO(3) can be conveniently and cheaply computed using Rodrigue sâ€™ formula
 (see Marsden and Ratiu [33] or Iserles et al. [21]).
 In Figure 9.1 we show the distance from the manifold S2of each the three approx-
 imations; we start with initial data y0= (âˆš
 2,âˆš
 2,0)T. The stochastic Taylor Munthe-
 Kaas method can be seen to preserve the solution in the unit sp here to within machine
 error. We also see that the stochastic Taylor method clearly drifts oï¬€ the sphere as
 the integration time progresses, as does the non-geometric Castell-Gaines methodâ€”
 which does however remain markedly closer to the manifold th an the stochastic Taylor
 scheme.
 9.2. Autonomous underwater vehicle. The dynamics of an ellipsoidal au-
 tonomous underwater vehicle is prescribed by the state y= (Ï€,p)âˆˆse(3)âˆ—where
 Ï€âˆˆso(3)âˆ—is its angular momentum and pâˆˆ(R3)âˆ—its linear momentum (see Holmes,
 Jenkins and Leonard [20], Egeland, Dalsmo and SÃ¸rdalen [13] and Marsden and
 Ratiu [33]). We suppose that the vehicle is perturbed by two i ndependent multi-
 plicative stochastic processes. The governing vector ï¬eld s are fori= 0,1,2:
 Vi(y) = adâˆ—
 Î¾iâ—¦y.
 HereÎ¾i(y) =/parenleftbig
 Ï‰i(y),ui(y)/parenrightbig
 âˆˆse(3) whereÏ‰i(y) =Iâˆ’1
 iÏ€andui(y) =Mâˆ’1
 ipare the
 angular and linear velocity, and Ii= diag(Î±i,1,Î±i,2,Î±i,3) andMi= diag(Î²i,1,Î²i,2,Î²i,3)
 are the constant moment of inertia and mass matrices, respec tively. Explicitly for
 Î¾âˆˆse(3) we have
 adâˆ—
 Î¾â—¦yâ‰¡(Ï€âˆ§Ï‰+pâˆ§u,pâˆ§Ï‰).
 The system of vector ï¬elds Vi,i= 0,1,2 represents the Lieâ€“Poisson dynamics on
 M=se(3)âˆ—(Marsden and Ratiu [33]). There are two independent Casimir s functions
 Ck:se(3)âˆ—â†’R,k= 1,2, namelyC1=Ï€Â·pandC2=|p|2; these are conserved by the
 ï¬‚ow on se(3)âˆ—.
 IfG=SE(3)âˆ¼=SO(3)Ã—R3, then the coadjoint action of SE(3) on se(3)âˆ—,
 Adâˆ—:SE(3)Ã—se(3)âˆ—â†’se(3)âˆ—is deï¬ned for all S= (s,Ï)âˆˆSE(3), wheresâˆˆSO(3)
 andÏâˆˆR3, andyâˆˆse(3)âˆ—by: Î› yâ—¦S= Adâˆ—
 Sâˆ’1â—¦yâ‰¡/parenleftbig
 sÏ€+Ïâˆ§(sp),sp/parenrightbig
 . The
 corresponding inï¬nitesimal action Î»:se(3)Ã—se(3)âˆ—â†’se(3)âˆ—for allÎ¾âˆˆse(3) andyâˆˆ
 se(3)âˆ—is given by (see Marsden and Ratiu [33], p. 477)
 Î»Î¾â—¦y=âˆ’adâˆ—
 Î¾â—¦y.
 Since adâˆ—
 Î¾(y) =âˆ’Î»Î¾(y) =Î»âˆ’Î¾(y) the governing set of vector ï¬elds on se(3)âˆ—are
 Vi(y) =Î»âˆ’Î¾iâ—¦y.
 We can now pull back this ï¬‚ow on se(3)âˆ—to a ï¬‚ow on SE(3) via Î› y0. The correspond-
 ing ï¬‚ow on SE(3) is generated by the governing set of vector ï¬elds for i= 0,1,2:
 Xâˆ’Î¾iâ—¦S=âˆ’/parenleftbig
 Ï‰i(y)âˆ§s,Ï‰i(y)âˆ§Ï+ui(y)/parenrightbig
 ,14 Malham and Wiese
 withy= Î›y0(S).
 To aid implementation note that SE(3) =/braceleftbig
 (s,Ï)âˆˆSE(3):sâˆˆSO(3), ÏâˆˆR3/bracerightbig
 embeds into SL(4;R) via the map
 S= (s,Ï)/maâˆšstoâ†’/parenleftbiggs Ï
 OT1/parenrightbigg
 ,
 whereOis the three-vector of zeros. Also se(3) is isomorphic to a Lie subalgebra of
 sl(4;R) with elements of the form
 Ïƒ= (Î¸,Î¶)/maâˆšstoâ†’/parenleftbiggË†Î¸ Î¶
 OT0/parenrightbigg
 .
 Hence the governing vector ï¬elds on SE(3) are of the form XÎ¾i=âˆ’Î¾i(y)S, where
 Î¾i(y) =/parenleftbigg
 Ë†Ï‰i(Ï€)ui(p)
 OT0/parenrightbigg
 .
 The governing vector ï¬elds on se(3) arevÎ¾i(Ïƒ) =âˆ’dexpÏƒâ—¦Î¾i/parenleftbig
 Î›y0(expÏƒ)/parenrightbig
 . Again the
 vector ï¬eld compositions ViVjneeded for the stochastic Taylor and Castellâ€“Gaines
 methods can be computed straightforwardly. Direct calcula tion also reveals that in
 block matrix form
 vÎ¾ivÎ¾jâ—¦o=/parenleftbiggË†A(Ï€0,Ï€0;Î±i,Î±j) +Ë†A(p0,p0;Î²i,Î±j)A(Ï€0,p0;Î±i,Î²j)
 OT0/parenrightbigg
 âˆ’1
 2[Î¾i(y0),Î¾j(y0)],
 HereA(y,z;Î±,Î²) is deï¬ned as for the rigid body example. Note that the expone ntial
 map expse(3):se(3)â†’SE(3) is deï¬ned for all Ïƒ= (Î¸,Î¶)âˆˆse(3) by
 expse(3)Ïƒ=/parenleftbigg
 expso(3)Ë†Î¸ f(Î¸)Î¶
 OT1/parenrightbigg
 ,
 where expso(3)is the exponential map from so(3) toSO(3) which can be computed
 using Rodriguesâ€™ formula and (see Bullo and Murray [4], p. 5)
 f(Î¸) =I3Ã—3+ (1âˆ’cos/baâˆ‡dblÎ¸/baâˆ‡dbl)Ë†Î¸//baâˆ‡dblÎ¸/baâˆ‡dbl2+/parenleftbig
 1âˆ’(sin/baâˆ‡dblÎ¸/baâˆ‡dbl)//baâˆ‡dblÎ¸/baâˆ‡dbl/parenrightbigË†Î¸2//baâˆ‡dblÎ¸/baâˆ‡dbl2.
 In Figure 9.2 we show the distance from the manifold se(3)âˆ—of each the three ap-
 proximations; in particular how far the individual traject ories stray from the Casimirs
 C1=Ï€Â·pandC2=|p|2. We start with the initial data y0= (âˆš
 2,âˆš
 2,0,0,âˆš
 2,âˆš
 2)T.
 As before the stochastic Taylor Munthe-Kaas method can be se en to preserve the
 Casimirs to within machine error. We also see that the stocha stic Taylor method
 clearly drifts oï¬€ the manifold as the integration time progr esses, and at a particular
 time depending on the Wiener path shoots oï¬€ very rapidly away from the manifold.
 Note also that for large stepsizes the stochastic Taylor met hod is unstable. However
 the non-geometric Castellâ€“Gaines and stochastic Munthe-K aas methods still give re-
 liable results in that regime.
 10. Conclusions. We have established and implemented stochastic Lie group
 integrators based on stochastic Munthe-Kaas methods and al so derived geometric
 Castellâ€“Gaines methods. We have also revealed several aspe cts of these integrators
 that require further investigation.Stochastic Lie group integrators 15
 0 0.5 1 1.5 2 2.5âˆ’20âˆ’15âˆ’10âˆ’50510
 timelog(error in Casimirs)
   
 Stochastic Taylor
 Castellâˆ’Gaines
 Muntheâˆ’Kaas
 âˆ’3.2âˆ’3.1âˆ’3âˆ’2.9âˆ’2.8âˆ’2.7âˆ’2.6âˆ’2.5âˆ’2.4âˆ’2.3âˆ’2.2âˆ’1.3âˆ’1.2âˆ’1.1âˆ’1âˆ’0.9âˆ’0.8âˆ’0.7âˆ’0.6
 log10(stepsize)log10(global error)Number of sampled paths=100
   
 Stochastic Taylor
 Castellâˆ’Gaines
 Muntheâˆ’Kaas
 Fig. 9.2 . Autonomous underwater vehicle: We show the log-distance of the approximate solution
 to the two Casimirs C1=Ï€Â·p(dotted line) and C2= |p|2(solid line) as a function of time for each
 of the methods. Below, we also show the global error as a funct ion of stepsize.
 1. We could construct a stochastic nonlinear Magnus method b y approximating
 the solution to the stochastic diï¬€erential equation (5.1) o n the Lie algebra using Picard
 iterations (see Casas and Iserles [6]).
 2. We would like to develop a practical procedure for impleme nting ordinary
 Munthe-Kaas methods for higher order Castellâ€“Gaines integ rators. We need to de-16 Malham and Wiese
 termine the element Î¾:Mâ†’gso that in (8.1) we have Ë†Ïˆ=Î»Î¾.
 3. We need to determine the properties of the local and global errors for the
 stochastic Munthe-Kaas methods. Also a thorough investiga tion of the stability prop-
 erties of the stochastic Munthe-Kaas and Castellâ€“Gaines me thods is required. For
 the autonomous underwater vehicle simulations they were bo th superior to the direct
 stochastic Taylor method, especially for larger stepsizes . We also need to compare the
 relative eï¬ƒciency of the methods concerned, in particular t o compare an optimally
 eï¬ƒcient geometric Castellâ€“Gaines method with the stochast ic Munthe-Kaas method.
 4. Although we have chieï¬‚y conï¬ned ourselves to driving path s that are Wiener
 processes, we can extend Munthe-Kaas and Castellâ€“Gaines me thods to rougher driv-
 ing paths (Lyons and Qian [29], Friz [15], Friz and Victoir [1 6]). Further, what hap-
 pens when we consider processes involving jumps? For exampl e Srivastava, Miller and
 Grenander [40] consider jump diï¬€usion processes on matrix L ie groups for Bayesian
 inference. Or what if we consider fractional Brownian drivi ng paths; Baudoin and
 Coutin [3] investigate fractional Brownian motions on Lie g roups?
 5. Schiï¬€ and Shnider [39] have used Lie group methods to deriv e MÂ¨ obius schemes
 for numerically integrating deterministic Riccati system s beyond ï¬nite time removable
 singularities and numerical instabilities. They integrat e a linear system of equations
 on the general linear group GL(n) which corresponds to a Riccati ï¬‚ow on the Grass-
 mannian manifold Gr( k,n) via the MÂ¨ obius action map. Lord, Malham and Wiese [27]
 implemented stochastic MÂ¨ obius schemes and show that they c an be more accurate and
 cost eï¬€ective than directly solving stochastic Riccati sys tems using stochastic Taylor
 methods. We would like to investigate further their eï¬€ectiv eness for stochastic Ric-
 cati equations arising in Kalman ï¬ltering (Kloeden and Plat en [23]) and to backward
 stochastic Riccati equations arising in optimal stochasti c linear-quadratic control (see
 for example Kohlmann and Tang [24]).
 6. Other areas of potential application of the methods we hav e presented in this
 paper are for example: term-structure interest rate models evolving on ï¬nite dimen-
 sional invariant manifolds (see Filipovic and Teichmann [1 4]); stochastic dynamics
 triggered by DNA damage (Chickarmane, Ray, Sauro and Nadim [ 10]) and stochastic
 symplectic integrators for which the gradient of the soluti on evolves on the symplectic
 Lie group (see Milstein and Tretyakov [34]).
 Acknowledgments. We thank Alex Dragt, Peter Friz, Anders Hansen, Terry
 Lyons, Per-Christian Moan and Hans Muntheâ€“Kaas for stimula ting discussions. We
 would also thank the anonymous referees, whose suggestions and encouragement im-
 proved the original manuscript signiï¬cantly.
 Appendix A. Proof of Theorem 7.1. We follow the proof for linear stochastic
 diï¬€erential equations in Lord, Malham and Wiese [27] (where further technical details
 on estimates for multiple Stratonovich integrals can be fou nd). Suppose Ë†Ïˆtâ‰¡Ë†Ïˆt(m)
 is the truncated Lie series (7.1). First we show that exp Ë†Ïˆtâ—¦y0âˆˆL2. We see that
 for any number k,/parenleftbigË†Ïˆt/parenrightbigkâ—¦y0is a sum of |Qm|kterms, each of which is a k-multiple
 product of terms JÎ±cÎ±â—¦y0. It follows that
 /vextenddouble/vextenddouble/parenleftbigË†Ïˆt/parenrightbigkâ—¦y0/vextenddouble/vextenddouble
 L2â‰¤/parenleftï£¬ig
 max
 Î±âˆˆQm/baâˆ‡dblcÎ±â—¦y0/baâˆ‡dbl/parenrightï£¬igk
 Â·/summationdisplay
 Î±iâˆˆQm
 i=1,...,k/baâˆ‡dblJÎ±1JÎ±2Â·Â·Â·JÎ±k/baâˆ‡dblL2. (A.1)
 Note that the maximum of the norm of the compositions of vecto r ï¬eldscÎ±â—¦y0is taken
 over a ï¬nite set. Repeated application of the product rule re veals that for i= 1,...,k ,Stochastic Lie group integrators 17
 each term â€˜JÎ±1JÎ±2Â·Â·Â·JÎ±kâ€™ in (A.1) is the sum of at most 22mkâˆ’1Stratonovich integrals
 JÎ², where fortâ‰¤1,/baâˆ‡dblJÎ²/baâˆ‡dblL2â‰¤24mkâˆ’1tk/2. Since the right hand side of equation (A.1)
 consists of |Qm|k22mkâˆ’1Stratonovich integrals JÎ², we conclude that,
 /vextenddouble/vextenddouble/vextenddouble/parenleftbigË†Ïˆt/parenrightbigkâ—¦y0/vextenddouble/vextenddouble/vextenddouble
 L2â‰¤/parenleftï£¬ig
 max
 Î±âˆˆQm/baâˆ‡dblcÎ±â—¦y0/baâˆ‡dbl Â· |Qm| Â·26mÂ·t1/2/parenrightï£¬igk
 .
 Hence exp Ë†Ïˆtâ—¦y0is square-integrable.
 Second we prove (7.2). Let Ë† ytdenote the stochastic Taylor series solution, trun-
 cated to included terms of order up to and including tm. We have
 /vextenddouble/vextenddoubleytâˆ’expË†Ïˆtâ—¦y0/vextenddouble/vextenddouble
 L2â‰¤/vextenddouble/vextenddoubleytâˆ’Ë†yt/vextenddouble/vextenddouble
 L2+/vextenddouble/vextenddoubleË†ytâˆ’expË†Ïˆtâ—¦y0/vextenddouble/vextenddouble
 L2.
 We knowytâˆˆL2(see Lemma III.2.1 in Gihman and Skorohod [18]). Note that Ë† ytis a
 strong approximation to ytup to and including terms of order tm, with the remainder
 consisting of O(tm+1/2) terms (see Proposition 5.9.1 in Kloeden and Platen [23]).
 It follows from the deï¬nition of the exponential Lie series a s the logarithm of the
 stochastic Taylor series, that the terms of order up to and in cludingtmin exp Ë†Ïˆtâ—¦y0
 correspond with Ë† yt; the error consists of O(tm+1/2) terms.
 Appendix B. Proof of Theorem 8.2. Our proof follows along the lines of that
 for uniformly accurate Magnus integrators for linear const ant coeï¬ƒcient systems (see
 Lord, Malham & Wiese [27] and Malham and Wiese [31]). Let Ï•tn,tn+1and Ë†Ï•tn,tn+1
 denote the exact and approximate ï¬‚ow-maps constructed on th e interval [tn,tn+1] of
 lengthh. We deï¬ne the local ï¬‚ow remainder as
 Rtn,tn+1â‰¡Ï•tn,tn+1âˆ’Ë†Ï•tn,tn+1,
 and so the local remainder is Rtn,tn+1â—¦ytn. LetRlsandRstdenote the local ï¬‚ow
 remainders corresponding to the exponential Lie series and stochastic Taylor approx-
 imations, respectively.
 B.1. Order 1/2integrator: two Wiener processes. For the global order 1 /2
 integrators we have to leading order Rls=1
 2(J12âˆ’J21)[V2,V1] andRst=J12V2V1+
 J21V1V2. Note that we have included the terms J11V2
 1andJ22V2
 2in the integrators.
 A direct calculation reveals that
 E/parenleftbig
 (Rstâ—¦y0)TRstâ—¦y0/parenrightbig
 =E/parenleftbig
 (Rlsâ—¦y0)TRlsâ—¦y0/parenrightbig
 +h2mUTBU+O/parenleftbig
 h2m+1
 2/parenrightbig
 .(B.1)
 Herem= 1/2 (for the order 1 /2 integrators), U= (V2V1â—¦y0,V1V2â—¦y0)TâˆˆR2n, and
 BâˆˆR2nÃ—2nconsists ofnÃ—ndiagonal blocks of the form bijInÃ—nwhere
 b=1
 4/parenleftbigg
 1 1
 1 1/parenrightbigg
 ,
 andInÃ—nis thenÃ—nidentity matrix. Since bis positive semi-deï¬nite, the matrix B=
 bâŠ—InÃ—nis positive semi-deï¬nite. Hence the order 1 /2 exponential Lie series integrator
 is locally more accurate than the corresponding stochastic Taylor integrator.
 B.2. Order 1integrator: one Wiener process. For the global order 1 in-
 tegrators we have to leading order Rls=1
 2(J10âˆ’J01)[V0,V1]âˆ’1
 12h2[V1,[V1,V0]] and
 Rst=J10V0V1+J01V1V0+J111V3
 1âˆ’1
 4h2(V1V1V0+V0V1V1). The terms of order h218 Malham and Wiese
 shown are signiï¬cant when we consider the global error in Sec tion B.4 below. The esti-
 mate (B.1) also applies in this case with m= 1 andU= (V0V1â—¦y0,V1V0â—¦y0,V3
 1â—¦y0)Tâˆˆ
 R3n; andBâˆˆR3nÃ—3nconsists ofnÃ—ndiagonal blocks of the form bijInÃ—nwhere
 b=1
 12ï£«
 ï£­3 3 3
 3 3 3
 3 3 5ï£¶
 ï£¸.
 Sincebis positive semi-deï¬nite, the matrix B=bâŠ—InÃ—nis positive semi-deï¬nite.
 Hence the order 1 exponential Lie series integrator is local ly more accurate than the
 corresponding stochastic Taylor integrator.
 B.3. Order 3/2integrator: one Wiener process. The local ï¬‚ow remainders
 areRls=1
 6/parenleftbig
 J110âˆ’2J101+J011âˆ’1
 2h2/parenrightbig
 [V1,[V1,V0]] andRst=J110V0V2
 1+J101V1V0V1+
 J011V2
 1V0+J1111V4
 1âˆ’1
 4h2(V1V1V0+V0V1V1). The terms of order h2shown are
 signiï¬cant when we consider the global errorâ€”but for a diï¬€er ent reason this timeâ€”
 see Section B.4 below. Again, the estimate (B.1) applies in t his case with m= 3/2
 andU= (V2
 1V0â—¦y0,V1V0V1â—¦y0,V0V2
 1â—¦y0,V4
 1â—¦y0)TâˆˆR4n; andBâˆˆR4nÃ—4nconsists
 ofnÃ—ndiagonal blocks of the form bijInÃ—nwhere
 b=1
 144ï£«
 ï£¬ï£¬ï£­11 8 10 12
 8 8 8 12
 10 8 11 12
 12 12 12 24ï£¶
 ï£·ï£·ï£¸.
 Again,Bis positive semi-deï¬nite and the order 3 /2 exponential Lie series integrator
 is locally more accurate than the corresponding stochastic Taylor integrator.
 B.4. Global error. We deï¬ne the strong global error at timeTassociated with
 an approximate solution Ë† yTasE â‰¡ /baâˆ‡dblyTâˆ’Ë†yT/baâˆ‡dblL2. The exact and approximate solutions
 can be constructed by successively applying the exact and ap proximate ï¬‚ow maps
 Ï•tn,tn+1and Ë†Ï•tn,tn+1on the successive intervals [ tn,tn+1] to the initial data y0. A
 straightforward calculation shows that a for small ï¬xed ste psizeh,
 E2=E(R â—¦y0)TR â—¦y0, (B.2)
 up to higher order terms, where R â‰¡/summationtextNâˆ’1
 n=0Ï•tn+1,tNâ—¦Rtn,tn+1â—¦Ï•t0,tnis the standard
 accumulated local error contribution to the global error. T he important conclusion is
 that when we construct the global error (B.2), the terms of le ading order in the local
 ï¬‚ow remainders RlsorRstwith zero expectation lose only a half order of convergence
 in this accumulation eï¬€ect. Hence in the local ï¬‚ow remainder s shown above, for the
 terms of zero-expectation, the local superior accuracy for the Lie series integrators
 transfers to the corresponding global errors (see Lord, Mal ham and Wiese [27] for
 more details). Terms of non-zero expectation however, beha ve like deterministic er-
 ror terms losing a whole order (in the local to global converg ence); they contribute
 to the global error through their expectations. Hence we inc lude such terms of or-
 derh2in the order 3 /2 integrators above and they appear as the terms subtracted
 from the remainders shown. For the order 1 integrators we do n ot need to include
 the orderh2terms in the integrator to obtain the correct mean-square co nvergence.
 However to guarantee that the global error for the exponenti al Lie series integrator
 is always smaller than that for the stochastic Taylor scheme , we include this term in
 the integrator.Stochastic Lie group integrators 19
 REFERENCES
 [1]G. Ben Arous ,Flots et series de Taylor stochastiques , Probab. Theory Related Fields, 81
 (1989), pp. 29â€“77.
 [2]F. Baudoin ,An introduction to the geometry of stochastic ï¬‚ows , Imperial College Press, 2004.
 [3]F.Baudoin and L. Coutin ,Self-similarity and fractional Brownian motions on Lie gro ups,
 arXiv:math.PR/0603199 v1, 2006.
 [4]F. Bullo and R. M. Murray ,Proportional derivative (PD) control on the Euclidean grou p,
 CDS Technical Report 95-010, 1995.
 [5]K. Burrage and P. M. Burrage ,High strong order methods for non-commutative stochas-
 tic ordinary diï¬€erential equation systems and the Magnus fo rmula , Phys. D, 133 (1999),
 pp. 34â€“48.
 [6]F. Casas and A. Iserles ,Explicit Magnus expansions for nonlinear equations , Cambridge NA
 reports, 2005.
 [7]F. Castell ,Asymptotic expansion of stochastic ï¬‚ows , Probab. Theory Related Fields, 96
 (1993), pp. 225â€“239.
 [8]F. Castell and J. Gaines ,An eï¬ƒcient approximation method for stochastic diï¬€erentia l equa-
 tions by means of the exponential Lie series , Math. Comp. Simulation, 38 (1995), pp. 13â€“19.
 [9]K. T. Chen ,Integration of paths, geometric invariants and a generaliz ed Bakerâ€“Hausdorï¬€
 formula , Annals of Mathematics 65(1) (1957), pp. 163â€“178.
 [10]V. Chickarmane, A. Ray, H. M. Sauro and A. Nadim ,A model for p53 dynamics triggered
 by DNA damage , SIAM J. Applied Dynamical Systems 6(1) (2007), pp.61â€“78.
 [11]P. E. Crouch and R. Grossman ,Numerical integration of ordinary diï¬€erential equations o n
 manifolds , J. Nonlinear Sci. 3 (1993), pp. 1â€“33.
 [12]K. D. Elworthy ,Stochastic diï¬€erential equations on manifolds , London Mathematical Society
 Lecture Note Series 70, Cambridge University Press, 1982.
 [13]O. Egeland, M. Dalsmo and O. J. SÃ¸rdalen ,Feedback control of a nonholonomic under-
 water vehicle with a constant desired conï¬guration , The International Journal of Robotics
 Research 15(1) (1996), pp. 24â€“35.
 [14]D. Filipovi Â´c and J. Teichmann ,On the geometry of the term structure of interest rates , Proc.
 R. Soc. Lond. A 460 (2004), pp. 129â€“167.
 [15]P. Friz ,Continuity of the ItË† o-map for HÂ¨ older rough paths with appl ications to the support
 theorem in HÂ¨ older norm , arXiv:math.PR/0304501 v2, 2003.
 [16]P. Friz and N. Victoir ,Euler estimates for rough diï¬€erential equations , Preprint, 2006.
 [17]J. G. Gaines and T. J. Lyons ,Variable step size control in the numerical solution of stoc hastic
 diï¬€erential equations , SIAM J. Appl. Math., 57(5) (1997), pp. 1455â€“1484.
 [18]I. I. Gihman, and A. V. Skorohod ,The theory of stochastic processes III , Springer, 1979.
 [19]E. Hairer, C. Lubich and G. Wanner ,Geometric Numerical Integration , Springer Series
 in Computational Mathematics, 2002
 [20]P. Holmes, J. Jenkins and N. E. Leonard ,Dynamics of the Kirchoï¬€ Equations I: coincident
 centers of gravity and bouyancy , Preprint, 1997.
 [21]A. Iserles, H. Z. Munthe-Kaas, S. P. NÃ¸rsett, and A. Zanna ,Lie-group methods , Acta
 Numer., (2000), pp. 215â€“365.
 [22]A. Iserles and A. Zanna ,Eï¬ƒcient computation of the matrix exponential by generaliz ed polar
 decompositions , SIAM J. Numer. Anal., 42(5) (2005), pp. 2218â€“2256.
 [23]P. E. Kloeden and E. Platen ,Numerical solution of stochastic diï¬€erential equations ,
 Springer, 1999.
 [24]M. Kohlmann and S. Tang ,Multidimensional backward stochastic Riccati equations a nd ap-
 plications , SIAM J. Control Optim., 41(6) (2003), pp. 1696â€“1721.
 [25]H. Kunita ,On the representation of solutions of stochastic diï¬€erenti al equations , LNM 784,
 Springerâ€“Verlag, 1980, pp. 282â€“304.
 [26] ,Stochastic ï¬‚ows and stochastic diï¬€erential equations , Cambridge University Press, 1990.
 [27]G. Lord, S. J.A. Malham and A. Wiese ,Eï¬ƒcient strong integrators for linear stochastic
 systems , 2006, Submitted to SINUM.
 [28]T. Lyons ,Diï¬€erential equations driven by rough signals , Rev. Mat. Iberoamericana, 14(2)
 (1998), pp. 215â€“310.
 [29]T. Lyons and Z. Qian ,System control and rough paths , Oxford University Press, 2002.
 [30]W. Magnus ,On the exponential solution of diï¬€erential equations for a l inear operator , Comm.
 Pure Appl. Math., 7 (1954), pp. 649â€“673.
 [31]S. J.A. Malham and A. Wiese ,Universal optimal stochastic expansions , 2007, Preprint.
 [32]P. Malliavin ,Stochastic analysis , Grundlehren der mathematischen Wissenschaften 313,
 Springer, 1997.20 Malham and Wiese
 [33]J. E. Marsden and T. S. Ratiu ,Introduction to mechanics and symmetry , Second edition,
 Springer, 1999.
 [34]G. N. Milstein and M. V. Tretyakov ,Stochastic numerics for mathematical physics ,
 Springer, 2004.
 [35]T. Misawa ,A Lie algebraic approach to numerical integration of stocha stic diï¬€erential equa-
 tions, SIAM J. Sci. Comput., 23(3) (2001), pp. 866â€“890.
 [36]H. Munthe-Kaas ,High order Rungeâ€“Kutta methods on manifolds , Appl. Numer. Math., 29
 (1999), pp. 115â€“127.
 [37]N. J. Newton ,Asymptotically eï¬ƒcient Rungeâ€“Kutta methods for a class of I tË† o and
 Stratonovich equations , SIAM J. Appl. Math., 51 (1991), pp. 542â€“567.
 [38]P. J. Olver ,Applications of Lie groups to diï¬€erential equations , Graduate texts in mathe-
 matics 107, Springerâ€“Verlag, 1986.
 [39]J. Schiff and S. Shnider ,A natural approach to the numerical integration of Riccati d iï¬€er-
 ential equations , SIAM J. Numer. Anal., 36(5) (1999), pp. 1392â€“1413.
 [40]A. Srivastava, M. I. Miller and U. Grenander ,Jump-diï¬€usion processes on matrix Lie
 groups for Bayesian inference , preprint, 2000.
 [41]R. S. Strichartz ,The Campbellâ€“Bakerâ€“Hausdorï¬€â€“Dynkin formula and solution s of diï¬€eren-
 tial equations , J. Funct. Anal., 72 (1987), pp. 320â€“345.
 [42]H. J. Sussmann ,Product expansions of exponential Lie series and the discre tization of stochas-
 tic diï¬€erential equations, in Stochastic Diï¬€erential Syst ems, Stochastic Control Theory,
 and Applications, W. Fleming and J. Lions, eds., Springer IM A Series, Vol. 10 (1988),
 pp. 563â€“582.
 [43]V. S. Varadarajan ,Lie groups, Lie algebras, and their representations , Springer, 1984.
 [44]Y. Yamato ,Stochastic diï¬€erential equations and nilpotent Lie algebr as, Z. Wahrsch. Verw.
 Gebiete, 47(2) (1979), pp 213â€“229.