. We are interested in designing Lie group numerical schemes for the strong approximation of nonlinear Stratonovich sto chastic dierential equa tions of the form ytydsummationdisplay iintegraldisplayt ViydWi . . HereW...Wdaredindependent scalar Wiener processes and W tt. We suppose that the solution yevolves on a smooth submanifold MofRnandViM R TMi ...d are smooth vector elds which in local coordinates are Visummationtextn jVj iyj. The owmap tM M of the integral equation . is dened as the map taking the initial data yto the solution ytat timet i.e.ytty. Our goal in this paper is to show how the Lie group integration methods developed by MuntheKaas and coauthors can be extended to stochastic dierential equations on smooth manifolds see Crouch and Grossman and Munthe Kaas . Suppose we know that the exact solution of a given system of stochasti c dierential equations evolves on a smooth submanifold MofRn but we can only nd the solution pathwise numerically. How can we ensure that our approximate numeric al solution also lies in the manifold Suppose we are given a nite dimensional Lie group Gand Lie group action y that generates transport across the manifold Mfrom the starting point y M via elements of G. Then with any given elements in the Lie algebra gcorresponding to the Lie group G we can associate the innitesimal action using the Lie group action y. The map mastois a Lie algebra homomorphism from gtoXM the Lie algebra of vector elds over the manifold M. Further the Lie subalgebra XMgis isomorphic to the nite dimensional Lie algebra gwith the same structure constants see Olver p. and Marsden a nd Ratiu p. . Maxwell Institute for Mathematical Sciences and School of M athematical and Computer Sciences HeriotWatt University Edinburgh EH AS UK. Malham and Wiese Conversely suppose we know that the Lie algebra generated b y the set of govern ing vector elds Vii ...d onMis nite dimensional call this XFM. Then we know there exists a nite dimensional Lie group Gwhose Lie algebra ghas the same structure constants as XFM relative to some basis and there is a Lie group action ysuch thatViii ...d for someigsee Olver p. or Kunita p. . The choice of group and action is not uni que. In this paper we assume that there is a nite dimensional Lie g roupGand action ysuch that our set of governing vector elds Vii ...d are each innitesimal Lie group actions generated by some element in gvia y i.e.Viifor someig i ...d . They are said to be fundamental vector elds. This means tha t we can write down the set of governing vector elds Xifor a system of stochastic dierential equations on the Lie group Gthat via the Lie group action y generates the ow governed by the set of vector elds Vion the manifold. The vector elds VionMare simply the push forward of the vector elds XionGvia the Lie group action y. Typically the ow on the Lie group also needs to be computed nu merically. We thus want the approximation to remain in the Lie group so that the L ie group action takes us back to the manifold. To achieve this we pull back the set of governing vector eld sXionGto the set of governing vector elds viong via the exponential map exp from gtoG. Thus the stochastic ow generated on gby the vector elds vigenerates the stochastic ow onGgenerated by the Xi. The set of governing vector elds on gare for each g visummationdisplay kBkadki . whereBkis thekth Bernoulli number and the adjoint operator ad is a closed operator ong in fact ad the Lie bracket on g. Now the essential point is that igand so the series on the right or any truncation of it is closed ing. Hence if we construct an approximation to our stochastic dierent ial equation on gusing the vector elds vior an approximation of them achieved by truncating the serie s representation then that approximation must reside in the Lie algebra g. We can then push the approximation in the Lie algebra forward onto the Li e group and then onto the manifold. Provided we compute the exponential map and ac tion appropriately our approximate solution lies in the manifold to within machin e accuracy. In summary for a given gand anyy Mwe have the following commutative diagram gexp XGy XM varrowtparrowtpXarrowtp gexp Gy M We have implicitly separated the governing set of vector el dsVii ...d from the driving path process wW...Wd. Together they generate the unique It o solution process y M to the stochastic dierential equation .. When there is only one driving Wiener process d the It o map wmastoyis continuous in the topology of uniform convergence. When there are two or mo re driving processes d the Universal Limit Theorem tells us that the It o map wmastoyis continuous in thepvariation topology in particular for p see Lyons Lyons and Qian and Malliavin . A Wiener path with d has nite pvariation forStochastic Lie group integrators p. This means that from a pathwise perspective approximati ons toyconstructed using successively rened approximations to ware only guaranteed to converge to the correct solution y if we include information about the L evy chordal areas of the driving path process. Note however that the Lnorm of the variation of a Wiener process is nite. In the Lie group integration proced ure prescribed above we must solve a stochastic dierential system on the Lie algebr agdened by the set of governing vector elds viand the driving path process wW...Wd. In light of the Universal Limit Theorem and with stepsize adapt ivity in mind in future see Gaines and Lyons we for instance use in our exampl es order stochastic numerical methodsthat include the L evy chordal areato s olve for the ow on the Lie algebra g. We have thus explained the idea behind MuntheKaas methods a nd how they can be generalized to the stochastic setting. The rst half of th is paper formalizes this procedure. In the second half of this paper we consider autonomous vect or elds and con struct stochastic Lie group integration schemes using Cast ellGaines methods. This approach proceeds as follows. We truncate the stochastic ex ponential Lie series expan sion corresponding to the ow tof the solution process yto the stochastic dierential equation .. We then approximate the driving path proces swW...Wd by replacing it by a suitable nearby piecewise smooth path in th e appropriate variation topology. An approximation to the solution ytrequires the exponentiation of the approximate truncated exponential Lie series. This can be a chieved by solving the system of ordinary dierential equations driven by the vect or eld that is the approx imate truncated exponential Lie series. If we use ordinary M untheKaas methods as the underlying ordinary dierential integrator the Castel lGaines method becomes a stochastic Lie group integrator. Further based on the CastellGaines approach we then prese ntuniformly accurate exponential Lie series integrators that are globally more accurate than their stochastic Taylor counterpart schemes these are investigated in deta il in Lord Malham and Wiese for linear stochastic dierential equations. T hey require the assumption that a suciently accurate underlying ordinary dierentia l integrator is used that integrator could for example be an ordinary Lie group Munthe Kaas method. In the case of two driving Wiener processes we derive the order and in the case of one driving Wiener process the order uniformly accurate exponential Lie series integrators. As a consequence we conrm the asymptotic eci ency properties for both these schemes proved by Castell and Gaines see Newt on for more details on the concept of asymptotic eciency. We also present in th e case of one driving Wiener process a new order uniformly accurate exponential Lie series integrator also see Lord Malham and Wiese . We present two physical applications that demonstrate the a dvantage of using stochastic MuntheKaas methods. First we consider a free ri gid body which for ex ample could model the dynamics of a satellite. We suppose tha t it is perturbed by two independent multiplicative stochastic noise processe s. The governing vector elds are noncommutative and the corresponding exact stochasti c ow evolves on the unit sphere. We show that the stochastic MuntheKaas method wit h an order stochastic Taylor integrator used to progress along the corresponding Lie algebra preserves the approximate solution in the unit sphere manifold to within m achine error. However when an order stochastic Taylor integrator is used directl y the solution leaves the unit sphere. The contrast between these two methods is more e mphatically demon Malham and Wiese strated in our second application. Here we consider an auton omous underwater vehicle that is also perturbed by two independent multiplicative st ochastic noise processes. The exact stochastic ow evolves on the manifold which is the dual of the Euclidean Lie algebra se two independent Casimirs are conserved by the exact ow . Again the stochastic MuntheKass method preserves the Casimirs t o within machine error. However the order stochastic Taylor integrator is not only unstable for large step sizes but the solution drifts o the manifold and makes a dra matic excursion o to innity in the embedding space R. Preserving the approximate ow on the manifold of the exact d ynamics may be a required property for physical or nancial systems driven b y smooth or rough paths for general references see Iserles MuntheKaas Nrsett a nd Zanna Hairer Lubich and Wanner Elworthy Lyons and Qian and Milst ein and Tretyakov . Stochastic Lie group integrators in the form of Magnus integ rators for linear stochastic dierential equations were investigated by Burrage and Bur rage . They were also used in the guise of M obius schemes see Schi and Shnider to solve stochastic Riccati equations by Lord Malham and Wiese where they o utperformed direct stochastic Taylor methods. Further applications where the y might be applied include backward stochastic Riccati equations arising in optimal s tochastic linearquadratic control Kohlmann and Tang jump diusion processes o n matrix Lie groups for Bayesian inference Srivastava Miller and Grenander fractional Brownian motions on Lie groups Baudoin and Coutin and stochasti c dynamics triggered by DNA damage Chickarmane Ray Sauro and Nadim . Our paper is outlined as follows. In Section we present the b asic geometric setup sansstochasticity. In particular we present a generalized righ t translation vector eld on a Lie group that forms the basis of our subsequent transfor mation from the Lie group to the manifold. Using a Lie group action this vector eld pushes forward to an innitesimal Lie group action vector eld that generat es a ow on the smooth manifold. In Section we specialize to the case of a matrix Li e group and using the exponential map derive the pullback of the generalized right translation vector eld on the Lie group to the corresponding vector eld on the L ie algebra. To help give some context to our overall scheme we provide in Sectio n illustrative examples of manifolds and natural choices for associated Lie groups a nd actions that generate ows on those manifolds. Then in Section we show how a ow on a smooth manifold corresponding to a stochastic dierential equation can be generated by a stochastic ow on a Lie algebra via a Lie algebra action. We explicitly pr esent stochastic Munthe Kaas Lie group integration methods in Section . We start the second half of our paper by reviewing the exponential Lie series for stochasti c dierential equations in Section . We show in Section how to construct geometric sto chastic CastellGaines numerical methods. In particular we also present uniformly accurate exponential Lie series numerical schemes that not only can be used as geometr ic stochastic integrators but also are always more accurate than stochastic Taylor num erical schemes of the corresponding order. In Section we present our concrete nu merical examples. Finally in Section we conclude and present some further future app lications and directions. . Lie group actions. Suppose Mis a smooth nite dimensional submanifold ofRn. We use XM to denote the Lie algebra of vector elds on the manifold M equipped with the LieJacobi bracket UVUVVU for allUVXM. LetGdenote a nite dimensional Lie group. Definition . Lie group action .A left Lie group action of a Lie group Gon a manifold Mis a smooth map G M M satisfying for all y MandRS GStochastic Lie group integrators idy y RSy RSy. We denote ySSy. Hereafter we suppose y M is xed and focus on the action map yGM . We assume that the Lie group action is transitive i.e. tran sport across the manifold from any point y Mto any other point y Mcan always be achieved via a group elementS Gwithy ySMarsden and Ratiu p. . We dene the Lie algebra gassociated with the Lie group Gto be the vector space of all right invariant vector elds on G. By standard construction this is isomorphic to the tangent space to Gat the identity ididGsee Olver p. or Marsden and Ratiu p. . Definition . Generalized right translation vector eld .Suppose we are given a smooth map Mg. With each such map we associate a vector eld XG XGdened as follows XSexpparenleftbig ySparenrightbig Svextendsinglevextendsingle forS G where exp is the usual local dieomorphism expg Gfrom a neigh bourhood of the zero element ogto a neighbourhood of id G. Definition . Innitesimal Lie group action .We associate with each vector eldXGXGa vector eld MXMas the push forward of XfromGto Mbyy i.e.parenleftbig yparenrightbig X so that if S Gandy yS M then yy wheret G Sand Xthe ow generated on Gby the vector eld Xstarting at S G. Naturally as a vector eld is linear and also y LXyS the Lie derivative of yalongXatS G. Remarks. . Our denition for the generalized right translation vect or eldXonGis motivated by the standard right translation vector eld use d to identify g the vector space of right invariant vector elds on G withTidG the tangent space to Gat the identity. When gis constant XXG is right invariant and a Lie bracket onTidGcan be dened via right extension by the corresponding LieJ acobi bracket for the vector elds XonXG. Unlessgis constant Xis not in general right invariant. For further details see Varadarajan Olver or Marsden and Ratiu . . The innitesimal generator map mastofromgtoXM is a Lie algebra homomorphism. If we identify gas the vector space of left invariant vector elds on G this map becomes an antihomomorphism. The LieJacobi brac ket as dened above gives the right rather than left Lie algebra stucture over the group of dieomorphisms onM. If in addition we take the LieJacobi bracket to be minus tha t dened above associated with the left Lie algebra structurethen the in nitesimal generator map becomes a homomorphism again. See for example Marsden and Ra tiu p. or MuntheKaas . . A comprehensive study of the systematic construction of s ymmetry Lie groups from given vector elds can be found in Olver . . We assumed above that the vector elds Xandare autonomous. However all results in this and subsequent sections up to Section ca n be straightforwardly extended to nonautonomous vector elds generated by M Rgwith ytmasto yt for ally MandtR. Malham and Wiese . The map SMM dened by ymastoSyySrepresents a ow on M. Hence if y Sy the push forward of by S is given byparenleftbig Sparenrightbig AdSMarsden and Ratiu p. . . If the action is eectivefaithful then the map SmastoS from Gto Di M the group of dieomorphisms on M is onetoone. If the action is freeso that y is onetoone and the only xed point is the identity element id G then yis a dieomorphism see Marsden and Ratiu p. . . Pull back to the Lie algebra. For ease of presentation we will assume in this section that Gis a matrix Lie group. Recall that the exponential map exp g G is a local dieomorphism from a neighbourhood of ogto a neighbourhood of id G. Letvggbe the pull back of the vector eld XGXG from Gtogvia the exponential mapping exp gG i.e.vexpX. Ifgthen v dexp parenleftbig yexpparenrightbig . . Here dexp ggis the inverse of the righttrivialized tangent map of the ex ponential dexpggdened as follows. If is a curve in gsuch that and gthen dexp gggis the local smooth map Varadarajan p. dexpexpexp parenleftbiggexpad id adparenrightbigg . Note that as a tangent map dexpggis linear. The inverse operator dexp is the operator series . generated by considering the recipro cal of dexp. To show that . is true if exp gGwithmastoS exp andgwith and v then expvSexp parenleftbig dexpvparenrightbig exp XS. Since exp is a dieomorphism in a neighbourhood of og this push forward calcu lation establishes the pull back . for all gin that neighbourhood. . Illustrative examples. Suppose the vector eld VM RXM gener ates a ow solution yt Mstarting from y M where Mis a smooth submanifold ofRn. Then assume there exists a . Lie group Gwith corresponding Lie algebra g . Lie group action yGM for which a starting point y Mis xed . Vector eld M RXM such that V i.e.Vis a fundamental vector eld corresponding to the action y. Let us suppose Gis a matrix Lie group or can be embedded into a matrix Lie group for example the Euclidean group SE is naturally embedded into the special linear group SLR. We have for all S GandtR XStparenleftbig yStparenrightbig S. . IfVfor someMg some Lie group Gand corresponding action y then the ow generated by XonGdrives the ow generated by VonM. In each of the examples below given the manifold M we present a natural Lie group and action associated with the manifold structure and identify vecto r elds which generate ows on the manifold via the Lie group.Stochastic Lie group integrators Stiefel manifold Vnk.Suppose MVnk yRnkyTyI. Take GSOn the special orthogonal group and ySSy the action of left multiplication. The corresponding Lie algebra gson. Then by direct calculation y yty. Hence if the given vector eld Vyt yty then the push forward of the ow generated by XSt onGin . is the ow generated by Von M. Note that the unit sphere SV i.e. Sis just a particular Stiefel manifold. In Section as an application we consider rigid body dynami cs evolving on S. Isospectral manifold Sn.Suppose MSnyRnnyTy the set of nnreal symmetric matrices. Take GOn the orthogonal group and yS SyST which is an isospectral action MuntheKaas . The cor responding Lie algebra is gson. Again by direct calculation y ytyyyt. Hence if the given vector eld Vyt ytyyyt then the push forward of the ow generated by XSt onGin . is the ow generated by VonM. Dual of the Euclidean algebra se.Suppose MseR the dual of the Euclidean algebra se of the Euclidean group SE braceleftbig sSEs SO Rbracerightbig . Take GSE so gse and AdG gg the coadjoint action of Gong. Then by direct calculation y ad y. Since y in linear in andyy it follows that if Vy ad y then the push forward of the ow generated by XSt parenleftbig yStparenrightbig SonGis the ow generated by VonM. For more details see Section where we investigate the dynamics of an autonomous underwater vehicle evolving on se. Grassmannian manifold Grkn.The Grassmannian manifold M Grkn is the space of kdimensional subspaces of Rn. Take G GLn the general linear matrix group where if SGLn we identify Sparenleftbigg parenrightbigg where the block matrices andare sizeskkknk nkkand nknk respectively see Schi and Shnider MuntheKaas . We choose the action of GL n on Grkn to be the generalized M obius transformation yS yy. Hence if t parenleftbiggatbt ctdtparenrightbigg then direct calculation reveals that y atybtyctyydt. Hence if the given vector eld Vy atybtyctyydt then the push forward of the ow generated by XSt tSonGis the ow generated by Von Grkn. . Stochastic Lie group integration. We show that if a Lie group action G MM exists then for y Mxed the Lie algebra action yexpgM carries a ow on gto a ow on M. Theorem .. Suppose there exists a Lie group action G MM . Then if there exist an It o process gand a stopping time Tsuch that on Tsatises the stochastic dierential equation tdsummationdisplay iintegraldisplayt vidWi . Malham and Wiese then the It o process y yexp Msatises the stochastic dierential equation onT ytydsummationdisplay iintegraldisplayt iydWi . . Proof. Using It os lemma if tgsatises . then yexptsatises yexpt yexpodsummationdisplay iintegraldisplayt LviyexpdWi . Now recall that for each i ...d Xiis the push forward of vifromgtoGvia the exponential map and that iis the push forward of XifromGtoMvia y and so the Lie derivative Lviyexptiyt. Then since yt yexpt we conclude that y Mis an It o process satisfying the stochastic dierential equation .. Corollary .. Suppose that for each i ...d there exists iGgsuch that the vector eld ViMXMandiMXMcan be identied i.e. Vii. . Then the push forward by yexp of the ow on the Lie algebra manifold ggenerated by the stochastic dierential equation .is the ow on the smooth manifold M generated by the stochastic dierential equation . whose solution can be expressed in the form yt yexpt. Remark. If the action is free then yexp is a dieomorphism from a neigh bourhood of ogto a neighbourhood of y M. . Stochastic MuntheKaas methods. Assuming that the vector elds in our original stochastic dierential equation . are fundam ental and satisfy . then stochastic MuntheKaas methods are constructed as follows . Subdivide the global interval of integration T into subintervals tntn. . Starting with t repeat the next two steps over successive intervals tntn untiltnT. . Compute an approximate solution tntnto . across tntn using a stochastic Taylor stochastic RungeKutta or CastellGai nes method. . Compute the approximate solution ytnytnexp tntn. Note that by construction tntngbecause the stochastic dierential equa tion . or any stochastic Taylor or other sensible appro ximation evolves the so lution locally on the Lie algebra gvia the vector elds vigg. Suitable methods for approximating the exponential map to ensure it maps gtoGappropriately can be found in Iserles and Zanna . Then by construction ytn M. For example with two Wiener processes and autonomous vecto r eldsvi an order stochastic Taylor MuntheKaas method is based on tntnparenleftbig JvJvJv J v JvvJvv J v parenrightbig o. evaluated at the zero element og. Typically dexp is truncated to only include the necessary low order terms to maintain the order of the num erical scheme.Stochastic Lie group integrators Remark. It is natural to invoke Ados Theorem see for example Olver p. any nite dimensional Lie algebra is isomorphic to a Lie suba lgebra of gln the general linear algebra for some nN. However as MuntheKaas points out directly using a matrix representation for the given Lie gro up might not lead to the optimal computational implementation other data structu res might do so. . Exponential Lie series. The stochastic Taylor series is known in dierent contexts as the Neumann series PeanoBaker series orFeynmanDyson path ordered exponential . If the vector elds in the stochastic dierential equation . are au tonomous which we assume henceforth i.e. for all i ...d ViViy only then the stochastic Taylor series for the ow is tsummationdisplay msummationdisplay PmJmtVmV. Here Pmis the set of all combinations of multiindices ... m of length m withi ...d and Jmtintegraldisplayt integraldisplaym dW mdWm are multiple Stratonovich integrals. The logarithm of tis theexponential Lie series Magnus expansion Magnus orChenStrichartz formula Chen Strichartz . In other words we can express the ow map in the form t expt where tdsummationdisplay iJitVidsummationdisplay ij JjiJijtViVj is the exponential Lie series for our system and is the LieJacobi bracket on XM. See Yamato Kunita Ben Arous and Castell for the derivation and convergence of the exponential Lie series expansion in t he stochastic context Strichartz for the full explicit expansion Sussmann for a related product expansion and Lyons for extensions to rough paths. Let us denote the truncated exponential Lie series by tsummationdisplay QmJc . where Qmdenotes the nite set of multiindices for which badblJbadblLis of order up to and including tm wherem .... The terms care linear combinations of nitely many length products of the smooth vector elds Vii ...d . The following asymptotic convergence result can be establi shed along the lines of the proof for linear stochastic dierential equations in Lord Malham and Wiese we provide a proof in Appendix A. Theorem .. Assume the vector elds Viare Lipschitz continuous and satisfy badblViybadbl cbadblybadbl for ally Mi ...d and somec. Then fort the ow exptyis squareintegrable where tis the truncated Lie series .. Further ifyis the solution of the stochastic dierential equation . there exists a constantCparenleftbig mbadblybadblparenrightbig such that vextenddoublevextenddoubleytexptyvextenddoublevextenddouble LCparenleftbig mbadblybadblparenrightbig tm. . Malham and Wiese . Geometric CastellGaines methods. Consider the truncated exponential Lie series tntnacross the interval tntn. We approximate higher order multiple Stratonovich integrals across each timestep by their expe ctations conditioned on the increments of the Wiener processes on suitable subdivision s Gaines and Lyons . An approximation to the solution of the stochastic dierent ial equation . across the interval tntn is given by the ow generated by the truncated and condition ed exponential Lie series tntnvia ytnexpparenleftbigtntnparenrightbig ytn. Hence the solution to the stochastic dierential equation . can be approximately computed by solving the ordinary dierential system see Ca stell and Gaines Misawa u tntnu . across the interval . Then if u ytnwe will get uytn. We must choose a suciently accurate ordinary dierential int egrator to solve .we implicitly assume this henceforth. The set of governing vector elds Vii ...d prescribes a map from the driving path process wW...Wd to the unique It o solution process y Mto the stochastic dierential equation .. The map wmastoyis called the It o map. Recall that we assume the vector elds are smooth. When there is only one driving Wiener process d the It o map is continuous in the topology of uniform conv ergence Theorem ... in Lyons and Qian . When there are two or more driving pro cesses d the Universal Limit Theorem Theorem ... in Lyons and Q ian tells us that the It o map is continuous in the pvariation topology in particular for p. A Wiener path with d haspvariation with p and thepvariation metric in this case includes information about the L evy cho rdal areas of the path Lyons . Hence we must choose suitable piecewise smoot h approximations to the driving path process w. The following result follows from the corresponding resul t for ordinary dierential equations in Hairer Lubich and Wanne r p. as well as directly from Chapter VIII in Malliavin on the Transfer Principle. Lemma .. A necessary and sucient condition for the solution to the st ochas tic dierential equation .to evolve on a smooth submanifold MofRnup to a stopping time Tis thatViytTyMfor ally Mi ...d . Hence the stochastic Taylor expansion for the ow tis a dieomorphism on M. However a truncated version of the stochastic Taylor expans ion for the ow twill not in general keep you on the manifold i.e. if y M then tyneed not necessarily lie inM. On the other hand the exponential Lie series t or any truncation tof it lies in XM. By Lemma . this is a necessary and sucient condition for the corresponding owmap exp tto be a dieomorphism on M. Hence ifu ytn M thenytnu M. When solving the ordinary dierential equation . classical geometric integration methods for example Lie g roup integrators such as RungeKutta MuntheKaas methods over the interval will numerically ensureytnstays in M. Additionally as the following result reveals numerical methods constructed using the CastellGaines Lie series ap proach can also be more accurate a proof is provided in Appendix B. Theorem .. In the case of two independent Wiener processes and under the assumptions of Theorem . for any initial condition y Mand a suciently smallStochastic Lie group integrators xed stepsize the order Lie series integrator is globally more accurate in Lthan the order stochastic Taylor integrator. In addition in the case of on e Wiener process the order and uniformly accurate exponential Lie series integrators generated by tntnJVJVh parenleftbig VVVparenrightbig and tntnJVJV JJVV h parenleftbig VVVparenrightbig respectively are globally more accurate in Lthan their corresponding stochastic Tay lor integrators. Remarks. . The result for is new. That the order Lie series integrator for two Wiener processes and the order integrator generated by are uniformly more accurate conrms the asymptotically ecient properties of these schemes proved by Castell and Gaines . The proof follows along the lines of a n analogous result for linear stochastic systems considered in Lord Malham and Wi ese . . Consider the order exponential Lie series with no vector eld commu tations. Solving the ordinary dierential equation . u sing an ordinary Euler MuntheKaas method and approximating dexp idis equivalent to the order stochastic Taylor MuntheKaas method for the same Lie grou p and action. . Numerical examples. .. Rigid body. We consider the dynamics of a rigid body such as a satellite see Marsden and Ratiu . We will suppose that the rigid b ody is perturbed by two independent multiplicative stochastic processes WandWwith the corresponding vector elds Viyiyy fori withiso. If we normalize the initial datayso that y then the dynamics evolves on MS. We naturally suppose GSO and ySSyso thatiy iyy and we can pull back the ow generated by VonMto the ow on Ggenerated by XiSt iparenleftbig ySparenrightbig S i . We use the following matrix representation for the iyso iy yiyi yi yi yiyi where the constants ijforj are chosen so that the vector elds Viand matricesido not commute for i . The vector elds Visatisfy the conditions of Theorem . since the manifold is compact i n this case. We will numerically solve . using three dierent order methods stochastic Taylor stochastic Taylor MuntheKaas based on . and Ca stellGaines a stan dard nongeometric RungeKutta method is used to solve the o rdinary dierential equation .. The vector eld compositions ViVjneeded for the stochastic Taylor and CastellGaines methods are readily computed. For the Mu ntheKaas method we note that we have vioiy and vivjoAyyij iyjy. Hereoso is the zero element on the Lie algebra and for all yzRwe dene Ayz parenleftbigyz yz parenrightbig parenleftbigyz yz parenrightbig parenleftbigyz yz parenrightbig Malham and Wiese timelogdistance from manifold Stochastic Taylor CastellGaines MuntheKaas Fig. . . Rigid body We show the logdistance of the approximate solution to the u nit sphere as a function of time for each of the methods. Below we show the approximate solutions as a function of time for the stochastic Taylor blue and MuntheKaas met hods magenta. The trajectory starts at the top right and eventually drifts over the left horizon.Stochastic Lie group integrators and Rso denotes the vector space isomorphism mastowhere . Note that yzyzsee Marsden and Ratiu . Note also since so expSO can be conveniently and cheaply computed using Rodrigue s formula see Marsden and Ratiu or Iserles et al. . In Figure . we show the distance from the manifold Sof each the three approx imations we start with initial data y T. The stochastic Taylor Munthe Kaas method can be seen to preserve the solution in the unit sp here to within machine error. We also see that the stochastic Taylor method clearly drifts o the sphere as the integration time progresses as does the nongeometric CastellGaines method which does however remain markedly closer to the manifold th an the stochastic Taylor scheme. .. Autonomous underwater vehicle. The dynamics of an ellipsoidal au tonomous underwater vehicle is prescribed by the state y psewhere sois its angular momentum and pRits linear momentum see Holmes Jenkins and Leonard Egeland Dalsmo and Srdalen and Marsden and Ratiu . We suppose that the vehicle is perturbed by two i ndependent multi plicative stochastic processes. The governing vector eld s are fori Viy ad iy. Hereiy parenleftbig iyuiyparenrightbig se whereiy I ianduiy M ipare the angular and linear velocity and Ii diagiii andMi diagiii are the constant moment of inertia and mass matrices respec tively. Explicitly for se we have ad ypup. The system of vector elds Vii represents the LiePoisson dynamics on MseMarsden and Ratiu . There are two independent Casimir s functions CkseRk namelyCpandCp these are conserved by the ow on se. IfGSESOR then the coadjoint action of SE on se AdSEseseis dened for all S sSE wheresSO andR andyseby yS Ad Syparenleftbig sspspparenrightbig . The corresponding innitesimal action sesesefor allse andy seis given by see Marsden and Ratiu p. yad y. Since ad y y y the governing set of vector elds on seare Viy iy. We can now pull back this ow on seto a ow on SE via y. The correspond ing ow on SE is generated by the governing set of vector elds for i XiSparenleftbig iysiyuiyparenrightbig Malham and Wiese withy yS. To aid implementation note that SE braceleftbig sSEsSO Rbracerightbig embeds into SLR via the map S smastoparenleftbiggs OTparenrightbigg whereOis the threevector of zeros. Also se is isomorphic to a Lie subalgebra of slR with elements of the form mastoparenleftbigg OTparenrightbigg . Hence the governing vector elds on SE are of the form XiiyS where iy parenleftbigg iuip OTparenrightbigg . The governing vector elds on se arevi dexpiparenleftbig yexpparenrightbig . Again the vector eld compositions ViVjneeded for the stochastic Taylor and CastellGaines methods can be computed straightforwardly. Direct calcula tion also reveals that in block matrix form vivjoparenleftbiggAij AppijApij OTparenrightbigg iyjy HereAyz is dened as for the rigid body example. Note that the expone ntial map expseseSE is dened for all se by expseparenleftbigg expso f OTparenrightbigg where expsois the exponential map from so toSO which can be computed using Rodrigues formula and see Bullo and Murray p. f I cosbadblbadblbadblbadblparenleftbig sinbadblbadblbadblbadblparenrightbigbadblbadbl. In Figure . we show the distance from the manifold seof each the three ap proximations in particular how far the individual traject ories stray from the Casimirs CpandCp. We start with the initial data y T. As before the stochastic Taylor MuntheKaas method can be se en to preserve the Casimirs to within machine error. We also see that the stocha stic Taylor method clearly drifts o the manifold as the integration time progr esses and at a particular time depending on the Wiener path shoots o very rapidly away from the manifold. Note also that for large stepsizes the stochastic Taylor met hod is unstable. However the nongeometric CastellGaines and stochastic MuntheK aas methods still give re liable results in that regime. . Conclusions. We have established and implemented stochastic Lie group integrators based on stochastic MuntheKaas methods and al so derived geometric CastellGaines methods. We have also revealed several aspe cts of these integrators that require further investigation.Stochastic Lie group integrators . . . timelogerror in Casimirs Stochastic Taylor CastellGaines MuntheKaas ................. logstepsizelogglobal errorNumber of sampled paths Stochastic Taylor CastellGaines MuntheKaas Fig. . . Autonomous underwater vehicle We show the logdistance of the approximate solution to the two Casimirs Cpdotted line and C psolid line as a function of time for each of the methods. Below we also show the global error as a funct ion of stepsize. . We could construct a stochastic nonlinear Magnus method b y approximating the solution to the stochastic dierential equation . o n the Lie algebra using Picard iterations see Casas and Iserles . . We would like to develop a practical procedure for impleme nting ordinary MuntheKaas methods for higher order CastellGaines integ rators. We need to de Malham and Wiese termine the element Mgso that in . we have . . We need to determine the properties of the local and global errors for the stochastic MuntheKaas methods. Also a thorough investiga tion of the stability prop erties of the stochastic MuntheKaas and CastellGaines me thods is required. For the autonomous underwater vehicle simulations they were bo th superior to the direct stochastic Taylor method especially for larger stepsizes . We also need to compare the relative eciency of the methods concerned in particular t o compare an optimally ecient geometric CastellGaines method with the stochast ic MuntheKaas method. . Although we have chiey conned ourselves to driving path s that are Wiener processes we can extend MuntheKaas and CastellGaines me thods to rougher driv ing paths Lyons and Qian Friz Friz and Victoir . Further what hap pens when we consider processes involving jumps For exampl e Srivastava Miller and Grenander consider jump diusion processes on matrix L ie groups for Bayesian inference. Or what if we consider fractional Brownian drivi ng paths Baudoin and Coutin investigate fractional Brownian motions on Lie g roups . Schi and Shnider have used Lie group methods to deriv e M obius schemes for numerically integrating deterministic Riccati system s beyond nite time removable singularities and numerical instabilities. They integrat e a linear system of equations on the general linear group GLn which corresponds to a Riccati ow on the Grass mannian manifold Gr kn via the M obius action map. Lord Malham and Wiese implemented stochastic M obius schemes and show that they c an be more accurate and cost eective than directly solving stochastic Riccati sys tems using stochastic Taylor methods. We would like to investigate further their eectiv eness for stochastic Ric cati equations arising in Kalman ltering Kloeden and Plat en and to backward stochastic Riccati equations arising in optimal stochasti c linearquadratic control see for example Kohlmann and Tang . . Other areas of potential application of the methods we hav e presented in this paper are for example termstructure interest rate models evolving on nite dimen sional invariant manifolds see Filipovic and Teichmann stochastic dynamics triggered by DNA damage Chickarmane Ray Sauro and Nadim and stochastic symplectic integrators for which the gradient of the soluti on evolves on the symplectic Lie group see Milstein and Tretyakov . Acknowledgments. We thank Alex Dragt Peter Friz Anders Hansen Terry Lyons PerChristian Moan and Hans MuntheKaas for stimula ting discussions. We would also thank the anonymous referees whose suggestions and encouragement im proved the original manuscript signicantly. Appendix A. Proof of Theorem .. We follow the proof for linear stochastic dierential equations in Lord Malham and Wiese where further technical details on estimates for multiple Stratonovich integrals can be fou nd. Suppose ttm is the truncated Lie series .. First we show that exp tyL. We see that for any number kparenleftbigtparenrightbigkyis a sum of Qmkterms each of which is a kmultiple product of terms Jcy. It follows that vextenddoublevextenddoubleparenleftbigtparenrightbigkyvextenddoublevextenddouble Lparenleftig max Qmbadblcybadblparenrightigk summationdisplay iQm i...kbadblJJJkbadblL. A. Note that the maximum of the norm of the compositions of vecto r eldscyis taken over a nite set. Repeated application of the product rule re veals that for i ...k Stochastic Lie group integrators each term JJJk in A. is the sum of at most mkStratonovich integrals J where fortbadblJbadblLmktk. Since the right hand side of equation A. consists of QmkmkStratonovich integrals J we conclude that vextenddoublevextenddoublevextenddoubleparenleftbigtparenrightbigkyvextenddoublevextenddoublevextenddouble Lparenleftig max Qmbadblcybadbl Qm mtparenrightigk . Hence exp tyis squareintegrable. Second we prove .. Let ytdenote the stochastic Taylor series solution trun cated to included terms of order up to and including tm. We have vextenddoublevextenddoubleytexptyvextenddoublevextenddouble Lvextenddoublevextenddoubleytytvextenddoublevextenddouble Lvextenddoublevextenddoubleytexptyvextenddoublevextenddouble L. We knowytLsee Lemma III.. in Gihman and Skorohod . Note that ytis a strong approximation to ytup to and including terms of order tm with the remainder consisting of Otm terms see Proposition .. in Kloeden and Platen . It follows from the denition of the exponential Lie series a s the logarithm of the stochastic Taylor series that the terms of order up to and in cludingtmin exp ty correspond with yt the error consists of Otm terms. Appendix B. Proof of Theorem .. Our proof follows along the lines of that for uniformly accurate Magnus integrators for linear const ant coecient systems see Lord Malham Wiese and Malham and Wiese . Let tntnand tntn denote the exact and approximate owmaps constructed on th e interval tntn of lengthh. We dene the local ow remainder as Rtntntntntntn and so the local remainder is Rtntnytn. LetRlsandRstdenote the local ow remainders corresponding to the exponential Lie series and stochastic Taylor approx imations respectively. B.. Order integrator two Wiener processes. For the global order integrators we have to leading order Rls JJVV andRstJVV JVV. Note that we have included the terms JV andJV in the integrators. A direct calculation reveals that Eparenleftbig RstyTRstyparenrightbig Eparenleftbig RlsyTRlsyparenrightbig hmUTBUOparenleftbig hm parenrightbig .B. Herem for the order integrators U VVyVVyTRn and BRnnconsists ofnndiagonal blocks of the form bijInnwhere b parenleftbigg parenrightbigg andInnis thennidentity matrix. Since bis positive semidenite the matrix B bInnis positive semidenite. Hence the order exponential Lie series integrator is locally more accurate than the corresponding stochastic Taylor integrator. B.. Order integrator one Wiener process. For the global order in tegrators we have to leading order Rls JJVV hVVV and RstJVVJVVJV hVVVVVV. The terms of order h Malham and Wiese shown are signicant when we consider the global error in Sec tion B. below. The esti mate B. also applies in this case with m andU VVyVVyV yT Rn andBRnnconsists ofnndiagonal blocks of the form bijInnwhere b . Sincebis positive semidenite the matrix BbInnis positive semidenite. Hence the order exponential Lie series integrator is local ly more accurate than the corresponding stochastic Taylor integrator. B.. Order integrator one Wiener process. The local ow remainders areRls parenleftbig JJJ hparenrightbig VVV andRstJVV JVVV JV VJV hVVVVVV. The terms of order hshown are signicant when we consider the global errorbut for a dier ent reason this time see Section B. below. Again the estimate B. applies in t his case with m andU V VyVVVyVV yV yTRn andBRnnconsists ofnndiagonal blocks of the form bijInnwhere b . AgainBis positive semidenite and the order exponential Lie series integrator is locally more accurate than the corresponding stochastic Taylor integrator. B.. Global error. We dene the strong global error at timeTassociated with an approximate solution yTasE badblyTyTbadblL. The exact and approximate solutions can be constructed by successively applying the exact and ap proximate ow maps tntnand tntnon the successive intervals tntn to the initial data y. A straightforward calculation shows that a for small xed ste psizeh EER yTR y B. up to higher order terms where R summationtextN ntntNRtntnttnis the standard accumulated local error contribution to the global error. T he important conclusion is that when we construct the global error B. the terms of le ading order in the local ow remainders RlsorRstwith zero expectation lose only a half order of convergence in this accumulation eect. Hence in the local ow remainder s shown above for the terms of zeroexpectation the local superior accuracy for the Lie series integrators transfers to the corresponding global errors see Lord Mal ham and Wiese for more details. Terms of nonzero expectation however beha ve like deterministic er ror terms losing a whole order in the local to global converg ence they contribute to the global error through their expectations. Hence we inc lude such terms of or derhin the order integrators above and they appear as the terms subtracted from the remainders shown. For the order integrators we do n ot need to include the orderhterms in the integrator to obtain the correct meansquare co nvergence. However to guarantee that the global error for the exponenti al Lie series integrator is always smaller than that for the stochastic Taylor scheme we include this term in the integrator.Stochastic Lie group integrators 